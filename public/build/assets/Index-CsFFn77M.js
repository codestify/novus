import{j as e}from"./ui-D7JatNZG.js";import{k as le,G as q,a as p,aI as P,aJ as re,S as ne,P as H,n as ie,j as ce,aK as de,o as D,aL as oe,X as me}from"./vendor-D6XoaljX.js";import{D as xe,h as he,i as ue,j as E,k as pe,u as je,A as ge,C as fe,a as Ne,b as ve,c as Se,d as be}from"./card-BH9fkisz.js";import{B as x,c as F}from"./Logo-DrkNmNrq.js";import{T as ye,a as we,b as U,c as h,d as Ce,e as u}from"./table-CK_z5qMo.js";import{C as L}from"./checkbox-DNYzX2Ta.js";import{u as I}from"./app-uV5e9IYI.js";import{E as De}from"./EmptyState-Cse_cO0N.js";import{P as ke}from"./PaginationWrapper-Bx8fqAgF.js";import{I as _}from"./input-DYlAjlcc.js";import{S as G,a as J,b as Q,c as K,d as f}from"./select-B5U9ZZT0.js";import{L as v}from"./label--u-XTEpa.js";import{D as Ae,a as Me,q as Te,b as Ee,r as Fe,c as Pe,f as O}from"./format-B4g6xzwj.js";import{S as R}from"./switch-B9Nw-DgY.js";import{A as _e,a as Ie,b as ze,c as Be,d as Ve,e as He,f as Ue,g as Le}from"./alert-dialog-CjR_UoLi.js";import{B as Oe}from"./badge-xb3xq9o4.js";const Re=({searchQuery:t,setSearchQuery:r,statusFilter:a,handleStatusFilterChange:d,handleSearch:m,selectedSubscribers:n,handleBulkAction:i})=>e.jsx("div",{className:"px-6 pb-6 border-b",children:e.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-center",children:[e.jsxs("form",{onSubmit:m,className:"flex flex-grow gap-2 items-center max-w-md",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(le,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(_,{placeholder:"Search subscribers...",className:"pl-8 h-9",value:t,onChange:l=>r(l.target.value)})]}),e.jsx(x,{type:"submit",size:"sm",variant:"default",className:"h-9",children:"Search"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(G,{value:a,onValueChange:d,children:[e.jsx(J,{className:"w-[160px] h-9",children:e.jsx(Q,{placeholder:"Status"})}),e.jsxs(K,{children:[e.jsx(f,{value:"all",children:"All Statuses"}),e.jsx(f,{value:"active",children:"Active"}),e.jsx(f,{value:"inactive",children:"Inactive"}),e.jsx(f,{value:"unsubscribed",children:"Unsubscribed"})]})]}),n.length>0&&e.jsxs(xe,{children:[e.jsx(he,{asChild:!0,children:e.jsxs(x,{variant:"outline",size:"sm",className:"gap-1 h-9",children:[e.jsx("span",{children:"Bulk Actions"}),e.jsx("span",{className:"ml-1 rounded-full bg-primary w-5 h-5 text-[11px] text-primary-foreground flex items-center justify-center",children:n.length})]})}),e.jsxs(ue,{align:"end",className:"w-[200px]",children:[e.jsx(E,{onClick:()=>i("activate"),children:"Set Active"}),e.jsx(E,{onClick:()=>i("deactivate"),children:"Set Inactive"}),e.jsx(pe,{}),e.jsx(E,{onClick:()=>i("delete"),className:"text-destructive",children:"Delete Selected"})]})]})]})]})}),qe=({isOpen:t,onOpenChange:r,subscriber:a,onSuccess:d})=>{var C,b;const m=I(),n=!!a,{data:i,setData:l,post:j,patch:k,processing:g,errors:o,reset:w}=q({email:"",name:"",status:"active",preferences:{marketing:!0,newsletter:!0,productUpdates:!1}});p.useEffect(()=>{t&&a?l({email:a.email,name:a.name||"",status:a.status,preferences:a.preferences||{marketing:!1,newsletter:!1,productUpdates:!1}}):t&&w()},[t,a]);const A=c=>{c.preventDefault();const N=()=>{r(!1),d&&d()};n&&a?k(m("novus.subscribers.update",a.id),{onSuccess:N}):j(m("novus.subscribers.store"),{onSuccess:N})},S=(c,N)=>{l("preferences",{...i.preferences,[c]:N})};return e.jsx(Ae,{open:t,onOpenChange:r,children:e.jsxs(Me,{className:"sm:max-w-md",children:[e.jsxs(Te,{children:[e.jsx(Ee,{children:n?"Edit Subscriber":"Add New Subscriber"}),e.jsx(Fe,{children:n?"Update subscriber details and preferences":"Add a new subscriber to your mailing list"})]}),e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"grid gap-4 py-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{htmlFor:"email",children:["Email"," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(_,{id:"email",type:"email",placeholder:"subscriber@example.com",value:i.email,onChange:c=>l("email",c.target.value),className:F("pl-9",o.email&&"border-destructive")})]}),o.email&&e.jsx("p",{className:"text-xs text-destructive",children:o.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"name",children:"Name"}),e.jsx(_,{id:"name",placeholder:"John Doe",value:i.name,onChange:c=>l("name",c.target.value),className:F(o.name&&"border-destructive")}),o.name&&e.jsx("p",{className:"text-xs text-destructive",children:o.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"status",children:"Status"}),e.jsxs(G,{value:i.status,onValueChange:c=>l("status",c),children:[e.jsx(J,{id:"status",className:F(o.status&&"border-destructive"),children:e.jsx(Q,{placeholder:"Select status"})}),e.jsxs(K,{children:[e.jsx(f,{value:"active",children:"Active"}),e.jsx(f,{value:"inactive",children:"Inactive"}),e.jsx(f,{value:"unsubscribed",children:"Unsubscribed"})]})]}),o.status&&e.jsx("p",{className:"text-xs text-destructive",children:o.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Email Preferences"}),e.jsxs("div",{className:"rounded-md border divide-y",children:[e.jsxs("div",{className:"flex justify-between items-center px-3 py-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex justify-center items-center w-7 h-7 rounded-full bg-primary/10",children:e.jsx(re,{className:"h-3.5 w-3.5 text-primary"})}),e.jsx(v,{htmlFor:"marketing",className:"text-sm font-normal cursor-pointer",children:"Marketing emails"})]}),e.jsx(R,{id:"marketing",checked:((C=i.preferences)==null?void 0:C.marketing)||!1,onCheckedChange:c=>S("marketing",c)})]}),e.jsxs("div",{className:"flex justify-between items-center px-3 py-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex justify-center items-center w-7 h-7 rounded-full bg-primary/10",children:e.jsx(P,{className:"h-3.5 w-3.5 text-primary"})}),e.jsx(v,{htmlFor:"newsletter",className:"text-sm font-normal cursor-pointer",children:"Newsletter"})]}),e.jsx(R,{id:"newsletter",checked:((b=i.preferences)==null?void 0:b.newsletter)||!1,onCheckedChange:c=>S("newsletter",c)})]})]})]})]}),e.jsxs(Pe,{className:"mt-4",children:[e.jsx(x,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(x,{type:"submit",disabled:g,children:g?n?"Saving...":"Adding...":n?"Save Changes":"Add Subscriber"})]})]})]})})},Ge=({isOpen:t,onOpenChange:r,subscriber:a,onSuccess:d})=>{const m=I(),{delete:n,processing:i}=q(),l=()=>{a&&n(m("novus.subscribers.destroy",a.id),{onSuccess:()=>{r(!1),d&&d()}})};return e.jsx(_e,{open:t,onOpenChange:r,children:e.jsxs(Ie,{children:[e.jsxs(ze,{children:[e.jsx(Be,{children:"Delete Subscriber"}),e.jsxs(Ve,{children:["Are you sure you want to delete the subscriber"," ",e.jsx("span",{className:"font-medium",children:a==null?void 0:a.email}),"? This action cannot be undone."]})]}),e.jsxs(He,{children:[e.jsx(Ue,{children:"Cancel"}),e.jsx(Le,{onClick:l,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:i,children:i?"Deleting...":"Delete"})]})]})})},Je=({status:t})=>{const r=()=>{switch(t){case"active":return"default";case"inactive":return"secondary";case"unsubscribed":return"destructive";default:return"default"}};return e.jsx(Oe,{variant:r(),className:"capitalize",children:t})},ds=({subscribers:t,filters:r,flash:a})=>{var z,B;const d=I(),{toast:m}=je(),[n,i]=p.useState(r.search||""),[l,j]=p.useState([]),[k,g]=p.useState(!1),[o,w]=p.useState(!1),[A,S]=p.useState(null),[C,b]=p.useState(null);p.useEffect(()=>{a!=null&&a.success&&m({title:"Success",description:a.success,variant:"default"}),a!=null&&a.error&&m({title:"Error",description:a.error,variant:"destructive"})},[a]);const c=s=>{s.preventDefault(),M({search:n})},N=s=>{M({status:s})},M=s=>{D.get(d("novus.subscribers.index"),{...r,...s},{preserveState:!0})},W=()=>{l.length===t.data.length?j([]):j(t.data.map(s=>s.id))},X=s=>{l.includes(s)?j(l.filter(T=>T!==s)):j([...l,s])},$=s=>{l.length!==0&&D.post(d("novus.subscribers.bulk.action"),{action:s,subscriber_ids:l},{onSuccess:()=>{j([]),D.reload({only:["subscribers"]})},preserveScroll:!0})},Y=s=>{D.get(d("novus.subscribers.index",{page:s}),{search:n||void 0,status:r.status!=="all"?r.status:void 0},{preserveState:!0})},Z=s=>{S(s),g(!0)},ee=s=>{b(s),w(!0)},se=s=>s.email_verified_at?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(oe,{className:"mr-1 w-4 h-4"}),e.jsx("span",{className:"text-xs",children:O(new Date(s.email_verified_at),"MMM d, yyyy")})]}):e.jsxs("div",{className:"flex items-center text-amber-600",children:[e.jsx(me,{className:"mr-1 w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Not verified"})]}),ae=s=>{if(!s.preferences)return e.jsx("span",{className:"text-sm text-muted-foreground",children:"None"});const T=s.preferences,V=Object.entries(T).filter(([y,te])=>te).map(([y])=>y);return V.length===0?e.jsx("span",{className:"text-sm text-muted-foreground",children:"None"}):e.jsx("div",{className:"flex flex-wrap gap-1",children:V.map(y=>e.jsx("span",{className:"px-1.5 py-0.5 bg-secondary text-secondary-foreground text-xs rounded-md capitalize",children:y},y))})};return e.jsxs(e.Fragment,{children:[e.jsx(ne,{title:"Subscribers"}),e.jsx(ge,{title:"Manage subscribers",children:e.jsxs("div",{className:"container py-20 max-w-7xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Subscribers"}),e.jsx("p",{className:"mt-1 text-muted-foreground",children:"Manage your email subscribers and their preferences"})]}),e.jsxs(x,{onClick:()=>g(!0),children:[e.jsx(H,{className:"mr-2 w-4 h-4"}),"New Subscriber"]})]}),e.jsxs(fe,{className:"rounded-md shadow-xs",children:[e.jsxs(Ne,{className:"pb-3",children:[e.jsx(ve,{children:"All Subscribers"}),e.jsxs(Se,{children:[((z=t.meta)==null?void 0:z.total)||0," total subscribers"]})]}),e.jsx(Re,{searchQuery:n,setSearchQuery:i,statusFilter:r.status,handleStatusFilterChange:N,handleSearch:c,selectedSubscribers:l,handleBulkAction:$,total:((B=t.meta)==null?void 0:B.total)||0}),e.jsx(be,{className:"p-0",children:t.data.length>0?e.jsxs("div",{children:[e.jsxs(ye,{children:[e.jsx(we,{children:e.jsxs(U,{className:"hover:bg-muted/50",children:[e.jsx(h,{className:"px-4 w-12",children:e.jsx(L,{checked:l.length>0&&l.length===t.data.length,onCheckedChange:W,"aria-label":"Select all"})}),e.jsx(h,{className:"px-4",children:"Email"}),e.jsx(h,{className:"px-4",children:"Name"}),e.jsx(h,{className:"hidden px-4 md:table-cell",children:"Verified"}),e.jsx(h,{className:"px-4",children:"Status"}),e.jsx(h,{className:"hidden px-4 lg:table-cell",children:"Preferences"}),e.jsx(h,{className:"hidden px-4 md:table-cell",children:"Subscribed"}),e.jsx(h,{className:"px-4 text-right",children:"Actions"})]})}),e.jsx(Ce,{children:t.data.map(s=>e.jsxs(U,{className:"hover:bg-muted/50",children:[e.jsx(u,{className:"px-4 py-3",children:e.jsx(L,{checked:l.includes(s.id),onCheckedChange:()=>X(s.id),"aria-label":`Select ${s.email}`})}),e.jsx(u,{className:"px-4 py-3 font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"mr-2 w-4 h-4 text-muted-foreground"}),s.email]})}),e.jsx(u,{className:"px-4 py-3",children:s.name||e.jsx("span",{className:"italic text-muted-foreground",children:"Not provided"})}),e.jsx(u,{className:"hidden px-4 py-3 md:table-cell",children:se(s)}),e.jsx(u,{className:"px-4 py-3",children:e.jsx(Je,{status:s.status})}),e.jsx(u,{className:"hidden px-4 py-3 lg:table-cell",children:ae(s)}),e.jsx(u,{className:"hidden px-4 py-3 text-sm md:table-cell text-muted-foreground",children:O(new Date(s.subscribed_at),"MMM d, yyyy")}),e.jsx(u,{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(x,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>Z(s),children:[e.jsx(ie,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]}),e.jsxs(x,{variant:"ghost",size:"icon",className:"w-8 h-8 text-destructive",onClick:()=>ee(s),children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only",children:"Delete"})]})]})})]},s.id))})]}),t.meta.last_page>1&&e.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-t",children:[e.jsxs("div",{className:"mr-auto text-sm whitespace-nowrap text-muted-foreground",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:t.meta.from})," ","to"," ",e.jsx("span",{className:"font-medium",children:t.meta.to})," ","of"," ",e.jsx("span",{className:"font-medium",children:t.meta.total})," ","subscribers"]}),e.jsx(ke,{currentPage:t.meta.current_page,lastPage:t.meta.last_page,links:t.meta.links,onPageChange:Y})]})]}):e.jsx(De,{icon:e.jsx(de,{className:"w-10 h-10"}),title:"No subscribers found",description:n||r.status!=="all"?"No subscribers match your search criteria. Try different keywords or filters.":"Get started by adding your first subscriber to your mailing list.",action:n||r.status!=="all"?e.jsx(x,{variant:"outline",onClick:()=>{i(""),M({search:"",status:"all"})},children:"Clear Filters"}):e.jsxs(x,{onClick:()=>g(!0),children:[e.jsx(H,{className:"mr-2 w-4 h-4"}),"Add Subscriber"]}),className:"py-16"})})]})]})}),e.jsx(qe,{isOpen:k,onOpenChange:g,subscriber:A,onSuccess:()=>{S(null)}}),e.jsx(Ge,{isOpen:o,onOpenChange:w,subscriber:C,onSuccess:()=>{b(null)}})]})};export{ds as default};
