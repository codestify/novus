import{j as e}from"./ui-vqqFfSzO.js";import{a as f,G as F,S as M}from"./vendor-BFGeaHkk.js";import{u as _,A as k}from"./card-BRGifJVv.js";import{u as B,a as T,g as I,b as L,P as O,c as V,d as H,E as R,e as G,F as $,f as q,p as z}from"./EnhancedPostSeo-DsIw5IW6.js";import{u as J}from"./app-DdvSH9Ox.js";import{A as K,a as Q,b as U,c as W,d as X,g as Y}from"./alert-dialog-BYAAv6KF.js";import{B as Z}from"./badge-DRtbR8hh.js";import{S as ee}from"./switch-KbbSyYSO.js";import{f as b}from"./format-SmSpYad1.js";import"./button-BjyeRwdB.js";import"./input-BktS8ObH.js";import"./tabs-CjQQHpEZ.js";import"./dialog-DzDZ6qM5.js";import"./label-yJjOls6w.js";import"./alert-DAMaBpQx.js";import"./select-ChQGh1Eh.js";import"./scroll-area-B4hJvv3Q.js";const se=({post:d,publishStatus:a,onPublishStatusChange:m})=>{const c=s=>{switch(s){case"published":return{variant:"default",label:"Published"};case"draft":return{variant:"secondary",label:"Draft"};default:return{variant:"outline",label:"Scheduled"}}},{variant:h,label:l}=c(d.status);return e.jsxs("div",{className:"overflow-hidden rounded-lg border border-muted shadow-xs bg-card",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-4 border-b",children:[e.jsx("h3",{className:"font-medium",children:"Post Visibility"}),e.jsx(Z,{variant:h,className:"text-sm",children:l})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Publish Post"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a==="published"?"Visible to readers":"Saved but not published"})]}),e.jsx(ee,{checked:a==="published",onCheckedChange:s=>{m(s?"published":"draft")}})]}),e.jsxs("div",{className:"pt-3 mt-2 space-y-1 text-sm border-t text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:" Created:"}),e.jsx("span",{children:b(new Date(d.created_at),"MMM d, yyyy")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Last modified:"}),e.jsx("span",{children:b(new Date(d.updated_at),"MMM d, yyyy")})]})]})]})]})};function fe(){const d=_(),{blog_post:a}=d.props,m=J();if(!a)throw new Error("Post not found");const{distractionFree:c,animating:h,toggleDistraction:l}=B(),{saveStatus:s,errorMessage:S,showErrorDialog:P,setShowErrorDialog:y,startSaving:x,handleSuccess:D,handleError:N}=T(),[p,E]=f.useState(a.content),{data:r,setData:i,patch:C,processing:j,errors:n,setError:g}=F("editPostForm",I(a)),w=f.useCallback(o=>{E(o),i("content",o),s==="saved"&&x(),n.content&&g("content","")},[s,x,n.content,i,g]),v=o=>{o.preventDefault(),x();const u={...r};u.featured_image=z(u.featured_image),u.content=p,C(m("novus.posts.update",{post:a.id}),{data:u,preserveScroll:!0,onSuccess:D,onError:A=>{N(`Failed to save changes: ${Object.values(A).join(", ")}`)},preserveState:!0})},t=L(c,h);return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Edit Post"}),e.jsx(k,{title:"Edit your Post",children:e.jsxs("div",{className:t.container,children:[e.jsx(O,{title:r.title,onToggleDistraction:l,onSave:v,saveStatus:s,processing:j,post_action:"update",className:t.header}),e.jsx("div",{className:t.editorContainer,children:e.jsxs("div",{className:t.contentLayout,children:[e.jsxs("div",{className:t.editor,children:[e.jsx("div",{className:t.editorInner,children:e.jsx(V,{data:r,setData:i,errors:n,content:p,onContentChange:w})}),e.jsx("div",{className:t.extraSections,children:e.jsx(H,{excerpt:r.excerpt,onChange:o=>i("excerpt",o),error:n.excerpt})}),e.jsx("div",{className:t.extraSections,children:e.jsx(R,{data:r,setData:i,errors:n,showPreview:!0})})]}),e.jsxs("div",{className:t.sidebar,children:[e.jsx(se,{post:a,publishStatus:r.status,onPublishStatusChange:o=>i("status",o)}),e.jsx(G,{data:r,setData:i,errors:n,postStatus:r.status})]})]})}),e.jsx($,{visible:c,onToggleDistraction:l,onSave:v,saveStatus:s,processing:j}),e.jsx(q,{saveStatus:s})]})}),e.jsx(K,{open:P,onOpenChange:y,children:e.jsxs(Q,{children:[e.jsxs(U,{children:[e.jsx(W,{children:"Error"}),e.jsx(X,{children:S})]}),e.jsx(Y,{children:"Ok"})]})})]})}export{fe as default};
