import{j as e}from"./ui-D7JatNZG.js";import{a as v,G as F,S as M}from"./vendor-D6XoaljX.js";import{A as _}from"./card-BH9fkisz.js";import{u as k,a as B,g as T,b as I,P as L,c as O,d as V,E as H,e as R,F as G,f as $,p as q}from"./EnhancedPostSeo-pY6smE9H.js";import{u as z}from"./app-uV5e9IYI.js";import{u as J}from"./Logo-DrkNmNrq.js";import{A as K,a as Q,b as U,c as W,d as X,g as Y}from"./alert-dialog-CjR_UoLi.js";import{B as Z}from"./badge-xb3xq9o4.js";import{S as ee}from"./switch-B9Nw-DgY.js";import{f as b}from"./format-B4g6xzwj.js";import"./input-DYlAjlcc.js";import"./tabs-BO7px9zp.js";import"./label--u-XTEpa.js";import"./alert-Chfxu1gK.js";import"./select-B5U9ZZT0.js";import"./scroll-area-CQL414rk.js";const se=({post:d,publishStatus:a,onPublishStatusChange:m})=>{const c=s=>{switch(s){case"published":return{variant:"default",label:"Published"};case"draft":return{variant:"secondary",label:"Draft"};default:return{variant:"outline",label:"Scheduled"}}},{variant:h,label:l}=c(d.status);return e.jsxs("div",{className:"overflow-hidden rounded-lg border border-muted shadow-xs bg-card",children:[e.jsxs("div",{className:"flex justify-between items-center px-5 py-4 border-b",children:[e.jsx("h3",{className:"font-medium",children:"Post Visibility"}),e.jsx(Z,{variant:h,className:"text-sm",children:l})]}),e.jsxs("div",{className:"p-5 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:"Publish Post"}),e.jsx("div",{className:"text-sm text-muted-foreground",children:a==="published"?"Visible to readers":"Saved but not published"})]}),e.jsx(ee,{checked:a==="published",onCheckedChange:s=>{m(s?"published":"draft")}})]}),e.jsxs("div",{className:"pt-3 mt-2 space-y-1 text-sm border-t text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:" Created:"}),e.jsx("span",{children:b(new Date(d.created_at),"MMM d, yyyy")})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"Last modified:"}),e.jsx("span",{children:b(new Date(d.updated_at),"MMM d, yyyy")})]})]})]})]})};function fe(){const d=J(),{blog_post:a}=d.props,m=z();if(!a)throw new Error("Post not found");const{distractionFree:c,animating:h,toggleDistraction:l}=k(),{saveStatus:s,errorMessage:S,showErrorDialog:P,setShowErrorDialog:y,startSaving:x,handleSuccess:D,handleError:N}=B(),[p,E]=v.useState(a.content),{data:r,setData:i,patch:C,processing:j,errors:n,setError:g}=F("editPostForm",T(a)),w=v.useCallback(o=>{E(o),i("content",o),s==="saved"&&x(),n.content&&g("content","")},[s,x,n.content,i,g]),f=o=>{o.preventDefault(),x();const u={...r};u.featured_image=q(u.featured_image),u.content=p,C(m("novus.posts.update",{post:a.id}),{data:u,preserveScroll:!0,onSuccess:D,onError:A=>{N(`Failed to save changes: ${Object.values(A).join(", ")}`)},preserveState:!0})},t=I(c,h);return e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Edit Post"}),e.jsx(_,{title:"Edit your Post",children:e.jsxs("div",{className:t.container,children:[e.jsx(L,{title:r.title,onToggleDistraction:l,onSave:f,saveStatus:s,processing:j,post_action:"update",className:t.header}),e.jsx("div",{className:t.editorContainer,children:e.jsxs("div",{className:t.contentLayout,children:[e.jsxs("div",{className:t.editor,children:[e.jsx("div",{className:t.editorInner,children:e.jsx(O,{data:r,setData:i,errors:n,content:p,onContentChange:w})}),e.jsx("div",{className:t.extraSections,children:e.jsx(V,{excerpt:r.excerpt,onChange:o=>i("excerpt",o),error:n.excerpt})}),e.jsx("div",{className:t.extraSections,children:e.jsx(H,{data:r,setData:i,errors:n,showPreview:!0})})]}),e.jsxs("div",{className:t.sidebar,children:[e.jsx(se,{post:a,publishStatus:r.status,onPublishStatusChange:o=>i("status",o)}),e.jsx(R,{data:r,setData:i,errors:n,postStatus:r.status})]})]})}),e.jsx(G,{visible:c,onToggleDistraction:l,onSave:f,saveStatus:s,processing:j}),e.jsx($,{saveStatus:s})]})}),e.jsx(K,{open:P,onOpenChange:y,children:e.jsxs(Q,{children:[e.jsxs(U,{children:[e.jsx(W,{children:"Error"}),e.jsx(X,{children:S})]}),e.jsx(Y,{children:"Ok"})]})})]})}export{fe as default};
