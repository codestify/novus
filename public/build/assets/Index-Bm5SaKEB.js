import{j as d,a as Ji,b as ea,D as ta,c as na,P as ra,d as sa,O as ia,e as aa,f as hs}from"./ui-CVt06LZZ.js";import{j as zt,D as gs,v as Fn,a as z,w as _n,y as oa,X as Kt,t as Is,V as la,M as ca,z as lr,H as da,q as ua,J as fa,k as pa,K as ma,N as Ea,O as ha,P as ga,Q as Ia,o as st,c as L,I as _a,h as Ta,Y as Ra,Z as cr,G as wa,S as ya,_ as dr}from"./vendor-CtvTbFOk.js";import{u as Un}from"./app-D1ztBGq2.js";import{D as Sa,h as va,i as Aa,j as ur,k as Da,C as _s,d as Ts,l as Oa,a as xa,b as ba,c as Ma,T as Ca,e as Na,f as Pa,g as La,S as Ga,u as Fa,A as Ua,m as Et}from"./card-DIGxw4ou.js";import{B as Q,c as ue,b as Ba}from"./Logo-tjbegkVE.js";import{B as Bn}from"./badge-Bj-uW_E8.js";import{A as ja,b as Va,a as Ha,T as ka}from"./alert-9jXMcJRQ.js";import{I as Tn}from"./input-B88NHI_x.js";import{S as Rn,a as wn,b as yn,c as Sn,d as Ht}from"./select--CHltVj9.js";import{E as $a}from"./EmptyState-C4V2uPQ1.js";import{S as Wa}from"./scroll-area-HtjJ69Lr.js";import{L as ht}from"./label-Q5Ni6e3y.js";import{S as za}from"./switch-BcGHy-3m.js";import{A as Ya,a as qa,b as Xa,c as Qa,d as Za,e as Ka,f as Ja,g as eo}from"./alert-dialog-DPaA5RDK.js";function to({selectedItems:e,isUploading:t,setSelectedItems:n,handleBulkDelete:r,onUploadClick:s,isBulkDeleting:i=!1}){return d.jsxs("div",{className:"flex justify-between items-center mb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Images library"}),d.jsx("p",{className:"mt-1 text-muted-foreground",children:"Manage your images for use across your site"})]}),d.jsx("div",{className:"flex gap-2 items-center",children:e.length>0?d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsxs(Bn,{variant:"secondary",className:"px-2 py-1",children:[e.length," selected"]}),d.jsxs(Sa,{children:[d.jsx(va,{asChild:!0,children:d.jsx(Q,{variant:"outline",disabled:i,children:"Bulk Actions"})}),d.jsxs(Aa,{align:"end",className:"w-56",children:[d.jsxs(ur,{className:"text-destructive focus:text-destructive",onClick:r,disabled:i,children:[d.jsx(zt,{className:"mr-2 w-4 h-4"}),i?"Deleting...":"Delete Selected"]}),d.jsx(Da,{}),d.jsxs(ur,{children:[d.jsx(gs,{className:"mr-2 w-4 h-4"}),"Download Selected"]})]})]}),d.jsx(Q,{variant:"ghost",size:"sm",onClick:()=>n([]),disabled:i,children:"Clear Selection"})]}):d.jsxs(Q,{onClick:s,disabled:t,children:[d.jsx(Fn,{className:"mr-2 w-4 h-4"}),"Upload Images"]})})]})}function no({success:e,error:t,autoClose:n=!0,duration:r=5e3}){const[s,i]=z.useState([]),[a,o]=z.useState([]);z.useEffect(()=>{const c=[];e&&c.push({type:"success",text:e}),t&&c.push({type:"error",text:t}),c.length>0&&(i(c),o(new Array(c.length).fill(!0)),n&&c.forEach((f,E)=>{setTimeout(()=>{o(h=>{const p=[...h];return p[E]=!1,p})},r)}))},[e,t,n,r]);const l=c=>{a[c]||(i(f=>f.filter((E,h)=>h!==c)),o(f=>f.filter((E,h)=>h!==c)))},u=c=>{o(f=>{const E=[...f];return E[c]=!1,E})};return s.length===0?null:d.jsx("div",{className:"flex flex-col gap-3 mb-6",children:s.map((c,f)=>d.jsx("div",{className:ue("transition-all duration-300 ease-in-out transform",a[f]?"opacity-100 translate-y-0":"opacity-0 -translate-y-4"),onAnimationEnd:()=>l(f),children:d.jsxs(ja,{variant:c.type==="success"?"default":"destructive",className:"relative",children:[c.type==="success"?d.jsx(_n,{className:"w-4 h-4 shrink-0"}):d.jsx(oa,{className:"w-4 h-4 shrink-0"}),d.jsx(Va,{children:c.type==="success"?"Success":"Error"}),d.jsx(Ha,{children:c.text}),d.jsxs("button",{className:"absolute top-3 right-3 text-muted-foreground hover:text-foreground",onClick:()=>u(f),children:[d.jsx(Kt,{className:"w-4 h-4"}),d.jsx("span",{className:"sr-only",children:"Close"})]})]})},`${c.type}-${f}`))})}function St(e){return e.startsWith("image/")}function Rs(e){return e.startsWith("image/")?d.jsx(Is,{className:"w-10 h-10 text-muted-foreground"}):e.startsWith("video/")?d.jsx(la,{className:"w-10 h-10 text-muted-foreground"}):e.startsWith("audio/")?d.jsx(ca,{className:"w-10 h-10 text-muted-foreground"}):e==="application/pdf"?d.jsx(lr,{className:"w-10 h-10 text-muted-foreground"}):e.includes("spreadsheet")||e.includes("excel")?d.jsx(da,{className:"w-10 h-10 text-muted-foreground"}):e.includes("word")||e.startsWith("text/")?d.jsx(ua,{className:"w-10 h-10 text-muted-foreground"}):e.includes("zip")||e.includes("compressed")?d.jsx(fa,{className:"w-10 h-10 text-muted-foreground"}):d.jsx(lr,{className:"w-10 h-10 text-muted-foreground"})}function jn(e){if(e===0)return"0 Bytes";const t=1024,n=["Bytes","KB","MB","GB","TB"],r=Math.floor(Math.log(e)/Math.log(t));return parseFloat((e/Math.pow(t,r)).toFixed(2))+" "+n[r]}const ro=[{value:"all",label:"All Files"},{value:"image",label:"Images"},{value:"video",label:"Videos"},{value:"audio",label:"Audio"},{value:"document",label:"Documents"}];function so({searchQuery:e,setSearchQuery:t,selectedCollection:n,handleCollectionChange:r,selectedMimeType:s,handleMimeTypeChange:i,handleSearch:a,collections:o}){return d.jsxs("div",{className:"flex flex-col gap-4 mb-6 sm:flex-row",children:[d.jsxs("form",{onSubmit:a,className:"flex flex-1 gap-2",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(pa,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),d.jsx(Tn,{placeholder:"Search media...",className:"pl-8",value:e,onChange:l=>t(l.target.value)})]}),d.jsx(Q,{type:"submit",variant:"secondary",children:"Search"})]}),d.jsxs("div",{className:"flex gap-2 justify-between sm:gap-4 sm:justify-end",children:[d.jsx("div",{className:"flex-shrink-0",children:d.jsxs(Rn,{value:n,onValueChange:r,children:[d.jsx(wn,{className:"w-[160px]",children:d.jsx(yn,{placeholder:"Collection"})}),d.jsxs(Sn,{children:[d.jsx(Ht,{value:"all",children:"All Collections"}),o.map(l=>d.jsxs(Ht,{value:l.name,children:[l.name," (",l.count,")"]},l.name))]})]})}),d.jsx("div",{className:"flex-shrink-0",children:d.jsxs(Rn,{value:s,onValueChange:i,children:[d.jsx(wn,{className:"w-[140px]",children:d.jsx(yn,{placeholder:"File Type"})}),d.jsx(Sn,{children:ro.map(l=>d.jsx(Ht,{value:l.value,children:l.label},l.value))})]})})]})]})}function io({viewMode:e,setViewMode:t,gridSize:n,setGridSize:r,totalItems:s}){return d.jsxs("div",{className:"flex justify-between items-center p-2 rounded-t-md border bg-background",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsxs("div",{className:"flex mr-4 space-x-1",children:[d.jsxs(Q,{variant:e==="grid"?"default":"outline",size:"sm",className:"p-0 w-8 h-8",onClick:()=>t("grid"),children:[d.jsx(ma,{className:"w-4 h-4"}),d.jsx("span",{className:"sr-only",children:"Grid view"})]}),d.jsxs(Q,{variant:e==="list"?"default":"outline",size:"sm",className:"p-0 w-8 h-8",onClick:()=>t("list"),children:[d.jsx(Ea,{className:"w-4 h-4"}),d.jsx("span",{className:"sr-only",children:"List view"})]})]}),e==="grid"&&d.jsxs("div",{className:"hidden space-x-1 sm:flex",children:[d.jsx(Q,{variant:n==="sm"?"default":"outline",size:"sm",className:"px-2 h-7 text-xs",onClick:()=>r("sm"),children:"Small"}),d.jsx(Q,{variant:n==="md"?"default":"outline",size:"sm",className:"px-2 h-7 text-xs",onClick:()=>r("md"),children:"Medium"}),d.jsx(Q,{variant:n==="lg"?"default":"outline",size:"sm",className:"px-2 h-7 text-xs",onClick:()=>r("lg"),children:"Large"})]})]}),d.jsxs("div",{className:"text-sm text-muted-foreground",children:[s," ",s===1?"item":"items"]})]})}function ao({item:e,isSelected:t,onSelect:n,onClick:r,isNewlyUploaded:s=!1}){return d.jsxs("div",{className:ue("group relative overflow-hidden rounded-md border bg-background transition-all hover:shadow-sm cursor-pointer",t&&"ring-2 ring-primary",s&&"ring-2 ring-green-500 animate-pulse"),children:[d.jsx("div",{className:"absolute top-2 left-2 z-10",children:d.jsx(Q,{variant:"outline",size:"icon",className:ue("w-7 h-7 backdrop-blur-sm bg-background/80",t?"border-primary text-primary":"border-transparent opacity-0 group-hover:opacity-100"),onClick:i=>{i.stopPropagation(),n(e.id)},children:t?d.jsx(ha,{className:"w-4 h-4"}):d.jsx(ga,{className:"w-4 h-4"})})}),d.jsxs("div",{className:"overflow-hidden relative cursor-pointer aspect-square",onClick:()=>r(e),children:[St(e.mime_type)?d.jsx("img",{src:e.thumbnail_url,alt:e.alt_text||e.name,className:"object-cover w-full h-full transition-transform group-hover:scale-105",loading:"lazy"}):d.jsx("div",{className:"flex justify-center items-center w-full h-full bg-muted/30",children:d.jsx("div",{className:"text-muted-foreground",children:"Image"})}),s&&d.jsx("div",{className:"absolute top-0 right-0 px-2 py-1 text-xs text-white bg-green-500 rounded-bl-md",children:"New"})]}),d.jsxs("div",{className:"px-2 py-3",children:[d.jsx("div",{className:"text-sm font-medium truncate",children:e.name}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("div",{className:"text-xs text-muted-foreground",children:jn(e.size)}),d.jsx("button",{onClick:i=>{i.stopPropagation(),r(e)},className:"text-xs opacity-0 transition-opacity text-primary group-hover:opacity-100",children:"Details"})]})]})]})}function oo({items:e,selectedItems:t,gridSize:n,onSelect:r,onItemClick:s,recentlyUploadedIds:i=[]}){const a={sm:"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 xl:grid-cols-8",md:"grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-5",lg:"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4"}[n];return d.jsx("div",{className:ue("grid gap-4 p-4",a),children:e.map(o=>d.jsx(ao,{item:o,isSelected:t.includes(o.id),onSelect:r,onClick:s,isNewlyUploaded:i.includes(o.id)},o.id))})}function lo({item:e,isSelected:t,onSelect:n,onClick:r}){return d.jsxs("div",{className:ue("group flex items-center gap-4 px-4 py-3 transition-colors hover:bg-muted/30",t&&"bg-primary/5"),children:[d.jsx("div",{children:d.jsx(Q,{variant:"outline",size:"icon",className:ue("w-6 h-6",t?"border-primary text-primary":"border-muted"),onClick:s=>{s.stopPropagation(),n(e.id)},children:t&&d.jsx(Ia,{className:"w-3 h-3"})})}),d.jsx("div",{className:"overflow-hidden flex-shrink-0 w-14 h-14 rounded",children:St(e.mime_type)?d.jsx("img",{src:e.thumbnail_url,alt:e.alt_text||e.name,className:"object-cover w-full h-full",loading:"lazy"}):d.jsx("div",{className:"flex justify-center items-center w-full h-full bg-muted/30",children:Rs(e.mime_type)})}),d.jsxs("div",{className:"flex-1 min-w-0",children:[d.jsx("div",{className:"text-sm font-medium truncate",children:e.name}),d.jsxs("div",{className:"flex gap-3 items-center text-xs text-muted-foreground",children:[d.jsx("span",{children:jn(e.size)}),e.width&&e.height&&d.jsxs("span",{children:[e.width," × ",e.height]}),d.jsx("span",{children:new Date(e.created_at).toLocaleDateString()})]})]}),d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsx(Bn,{variant:"outline",className:"font-normal",children:e.collection_name}),d.jsx(Q,{variant:"ghost",size:"sm",className:"ml-auto h-8",onClick:()=>r(e),children:"Edit"})]})]})}function co({items:e,selectedItems:t,onSelect:n,onItemClick:r}){return d.jsx("div",{className:"divide-y",children:e.map(s=>d.jsx(lo,{item:s,isSelected:t.includes(s.id),onSelect:n,onClick:r},s.id))})}function uo({media:e,viewMode:t,gridSize:n,selectedItems:r,toggleItemSelection:s,handleMediaClick:i,searchQuery:a,setSearchQuery:o,selectedCollection:l,setSelectedCollection:u,selectedMimeType:c,setSelectedMimeType:f,onUploadClick:E,recentlyUploadedIds:h=[]}){const p=Un(),g=R=>{st.get(p("novus.media.index",{page:R}),{search:a||void 0,collection:l!=="all"?l:void 0,mime_type:c!=="all"?c:void 0},{preserveState:!0})};return d.jsxs(_s,{className:"overflow-hidden rounded-t-none border-t-0 min-h-[500px] shadow-xs border-muted",children:[d.jsx(Ts,{className:"p-0",children:e.data.length>0?t==="grid"?d.jsx(oo,{items:e.data,selectedItems:r,gridSize:n,onSelect:s,onItemClick:i,recentlyUploadedIds:h}):d.jsx(co,{items:e.data,selectedItems:r,onSelect:s,onItemClick:i}):d.jsx($a,{icon:d.jsx(Is,{className:"w-10 h-10"}),title:"No images found",description:a?"No images match your search criteria. Try different keywords or filters.":"Upload your first image to get started.",action:a?d.jsx(Q,{variant:"outline",onClick:()=>{o(""),u("all"),f("all"),st.get(p("novus.media.index"))},children:"Clear Filters"}):d.jsxs(Q,{onClick:E,children:[d.jsx(Fn,{className:"mr-2 w-4 h-4"}),"Upload Images"]}),className:"py-20"})}),e.data.length>0&&e.last_page>1&&d.jsxs(Oa,{className:"flex justify-between items-center p-4 border-t",children:[d.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing"," ",d.jsx("span",{className:"font-medium",children:e.from})," to"," ",d.jsx("span",{className:"font-medium",children:e.to})," of"," ",d.jsx("span",{className:"font-medium",children:e.total})," items"]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx(Q,{variant:"outline",size:"sm",disabled:e.current_page===1,onClick:()=>g(e.current_page-1),children:"Previous"}),d.jsx(Q,{variant:"outline",size:"sm",disabled:e.current_page===e.last_page,onClick:()=>g(e.current_page+1),children:"Next"})]})]})]})}function fo(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const ws=L.createContext({drawerRef:{current:null},overlayRef:{current:null},onPress:()=>{},onRelease:()=>{},onDrag:()=>{},onNestedDrag:()=>{},onNestedOpenChange:()=>{},onNestedRelease:()=>{},openProp:void 0,dismissible:!1,isOpen:!1,isDragging:!1,keyboardIsOpen:{current:!1},snapPointsOffset:null,snapPoints:null,handleOnly:!1,modal:!1,shouldFade:!1,activeSnapPoint:null,onOpenChange:()=>{},setActiveSnapPoint:()=>{},closeDrawer:()=>{},direction:"bottom",shouldAnimate:{current:!0},shouldScaleBackground:!1,setBackgroundColorOnScale:!0,noBodyStyles:!1,container:null,autoFocus:!1}),At=()=>{const e=L.useContext(ws);if(!e)throw new Error("useDrawerContext must be used within a Drawer.Root");return e};fo(`[data-vaul-drawer]{touch-action:none;will-change:transform;transition:transform .5s cubic-bezier(.32, .72, 0, 1);animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=open]{animation-name:slideFromBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=bottom][data-state=closed]{animation-name:slideToBottom}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=open]{animation-name:slideFromTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=top][data-state=closed]{animation-name:slideToTop}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=open]{animation-name:slideFromLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=left][data-state=closed]{animation-name:slideToLeft}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=open]{animation-name:slideFromRight}[data-vaul-drawer][data-vaul-snap-points=false][data-vaul-drawer-direction=right][data-state=closed]{animation-name:slideToRight}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--initial-transform,100%),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}[data-vaul-drawer][data-vaul-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--initial-transform,100%),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=top]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=bottom]{transform:translate3d(0,var(--snap-point-height,0),0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=left]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-drawer][data-vaul-delayed-snap-points=true][data-vaul-drawer-direction=right]{transform:translate3d(var(--snap-point-height,0),0,0)}[data-vaul-overlay][data-vaul-snap-points=false]{animation-duration:.5s;animation-timing-function:cubic-bezier(0.32,0.72,0,1)}[data-vaul-overlay][data-vaul-snap-points=false][data-state=open]{animation-name:fadeIn}[data-vaul-overlay][data-state=closed]{animation-name:fadeOut}[data-vaul-animate=false]{animation:none!important}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:0;transition:opacity .5s cubic-bezier(.32, .72, 0, 1)}[data-vaul-overlay][data-vaul-snap-points=true]{opacity:1}[data-vaul-drawer]:not([data-vaul-custom-container=true])::after{content:'';position:absolute;background:inherit;background-color:inherit}[data-vaul-drawer][data-vaul-drawer-direction=top]::after{top:initial;bottom:100%;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=bottom]::after{top:100%;bottom:initial;left:0;right:0;height:200%}[data-vaul-drawer][data-vaul-drawer-direction=left]::after{left:initial;right:100%;top:0;bottom:0;width:200%}[data-vaul-drawer][data-vaul-drawer-direction=right]::after{left:100%;right:initial;top:0;bottom:0;width:200%}[data-vaul-overlay][data-vaul-snap-points=true]:not([data-vaul-snap-points-overlay=true]):not(
[data-state=closed]
){opacity:0}[data-vaul-overlay][data-vaul-snap-points-overlay=true]{opacity:1}[data-vaul-handle]{display:block;position:relative;opacity:.7;background:#e2e2e4;margin-left:auto;margin-right:auto;height:5px;width:32px;border-radius:1rem;touch-action:pan-y}[data-vaul-handle]:active,[data-vaul-handle]:hover{opacity:1}[data-vaul-handle-hitarea]{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:max(100%,2.75rem);height:max(100%,2.75rem);touch-action:inherit}@media (hover:hover) and (pointer:fine){[data-vaul-drawer]{user-select:none}}@media (pointer:fine){[data-vaul-handle-hitarea]:{width:100%;height:100%}}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{to{opacity:0}}@keyframes slideFromBottom{from{transform:translate3d(0,var(--initial-transform,100%),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToBottom{to{transform:translate3d(0,var(--initial-transform,100%),0)}}@keyframes slideFromTop{from{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}to{transform:translate3d(0,0,0)}}@keyframes slideToTop{to{transform:translate3d(0,calc(var(--initial-transform,100%) * -1),0)}}@keyframes slideFromLeft{from{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToLeft{to{transform:translate3d(calc(var(--initial-transform,100%) * -1),0,0)}}@keyframes slideFromRight{from{transform:translate3d(var(--initial-transform,100%),0,0)}to{transform:translate3d(0,0,0)}}@keyframes slideToRight{to{transform:translate3d(var(--initial-transform,100%),0,0)}}`);function po(){const e=navigator.userAgent;return typeof window<"u"&&(/Firefox/.test(e)&&/Mobile/.test(e)||/FxiOS/.test(e))}function mo(){return Vn(/^Mac/)}function Eo(){return Vn(/^iPhone/)}function fr(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function ho(){return Vn(/^iPad/)||mo()&&navigator.maxTouchPoints>1}function ys(){return Eo()||ho()}function Vn(e){return typeof window<"u"&&window.navigator!=null?e.test(window.navigator.platform):void 0}const go=24,Io=typeof window<"u"?z.useLayoutEffect:z.useEffect;function pr(...e){return(...t)=>{for(let n of e)typeof n=="function"&&n(...t)}}const on=typeof document<"u"&&window.visualViewport;function mr(e){let t=window.getComputedStyle(e);return/(auto|scroll)/.test(t.overflow+t.overflowX+t.overflowY)}function Ss(e){for(mr(e)&&(e=e.parentElement);e&&!mr(e);)e=e.parentElement;return e||document.scrollingElement||document.documentElement}const _o=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let Mt=0,ln;function To(e={}){let{isDisabled:t}=e;Io(()=>{if(!t)return Mt++,Mt===1&&ys()&&(ln=Ro()),()=>{Mt--,Mt===0&&(ln==null||ln())}},[t])}function Ro(){let e,t=0,n=f=>{e=Ss(f.target),!(e===document.documentElement&&e===document.body)&&(t=f.changedTouches[0].pageY)},r=f=>{if(!e||e===document.documentElement||e===document.body){f.preventDefault();return}let E=f.changedTouches[0].pageY,h=e.scrollTop,p=e.scrollHeight-e.clientHeight;p!==0&&((h<=0&&E>t||h>=p&&E<t)&&f.preventDefault(),t=E)},s=f=>{let E=f.target;vn(E)&&E!==document.activeElement&&(f.preventDefault(),E.style.transform="translateY(-2000px)",E.focus(),requestAnimationFrame(()=>{E.style.transform=""}))},i=f=>{let E=f.target;vn(E)&&(E.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{E.style.transform="",on&&(on.height<window.innerHeight?requestAnimationFrame(()=>{Er(E)}):on.addEventListener("resize",()=>Er(E),{once:!0}))}))},a=()=>{window.scrollTo(0,0)},o=window.pageXOffset,l=window.pageYOffset,u=pr(wo(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`));window.scrollTo(0,0);let c=pr(gt(document,"touchstart",n,{passive:!1,capture:!0}),gt(document,"touchmove",r,{passive:!1,capture:!0}),gt(document,"touchend",s,{passive:!1,capture:!0}),gt(document,"focus",i,!0),gt(window,"scroll",a));return()=>{u(),c(),window.scrollTo(o,l)}}function wo(e,t,n){let r=e.style[t];return e.style[t]=n,()=>{e.style[t]=r}}function gt(e,t,n,r){return e.addEventListener(t,n,r),()=>{e.removeEventListener(t,n,r)}}function Er(e){let t=document.scrollingElement||document.documentElement;for(;e&&e!==t;){let n=Ss(e);if(n!==document.documentElement&&n!==document.body&&n!==e){let r=n.getBoundingClientRect().top,s=e.getBoundingClientRect().top,i=e.getBoundingClientRect().bottom;const a=n.getBoundingClientRect().bottom+go;i>a&&(n.scrollTop+=s-r)}e=n.parentElement}}function vn(e){return e instanceof HTMLInputElement&&!_o.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}function yo(e,t){typeof e=="function"?e(t):e!=null&&(e.current=t)}function So(...e){return t=>e.forEach(n=>yo(n,t))}function vs(...e){return z.useCallback(So(...e),e)}const As=new WeakMap;function ae(e,t,n=!1){if(!e||!(e instanceof HTMLElement))return;let r={};Object.entries(t).forEach(([s,i])=>{if(s.startsWith("--")){e.style.setProperty(s,i);return}r[s]=e.style[s],e.style[s]=i}),!n&&As.set(e,r)}function vo(e,t){if(!e||!(e instanceof HTMLElement))return;let n=As.get(e);n&&(e.style[t]=n[t])}const se=e=>{switch(e){case"top":case"bottom":return!0;case"left":case"right":return!1;default:return e}};function Ct(e,t){if(!e)return null;const n=window.getComputedStyle(e),r=n.transform||n.webkitTransform||n.mozTransform;let s=r.match(/^matrix3d\((.+)\)$/);return s?parseFloat(s[1].split(", ")[se(t)?13:12]):(s=r.match(/^matrix\((.+)\)$/),s?parseFloat(s[1].split(", ")[se(t)?5:4]):null)}function Ao(e){return 8*(Math.log(e+1)-2)}function cn(e,t){if(!e)return()=>{};const n=e.style.cssText;return Object.assign(e.style,t),()=>{e.style.cssText=n}}function Do(...e){return(...t)=>{for(const n of e)typeof n=="function"&&n(...t)}}const K={DURATION:.5,EASE:[.32,.72,0,1]},Ds=.4,Oo=.25,xo=100,Os=8,Nt=16,An=26,dn="vaul-dragging";function xs(e){const t=L.useRef(e);return L.useEffect(()=>{t.current=e}),L.useMemo(()=>(...n)=>t.current==null?void 0:t.current.call(t,...n),[])}function bo({defaultProp:e,onChange:t}){const n=L.useState(e),[r]=n,s=L.useRef(r),i=xs(t);return L.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function bs({prop:e,defaultProp:t,onChange:n=()=>{}}){const[r,s]=bo({defaultProp:t,onChange:n}),i=e!==void 0,a=i?e:r,o=xs(n),l=L.useCallback(u=>{if(i){const f=typeof u=="function"?u(e):u;f!==e&&o(f)}else s(u)},[i,e,s,o]);return[a,l]}function Mo({activeSnapPointProp:e,setActiveSnapPointProp:t,snapPoints:n,drawerRef:r,overlayRef:s,fadeFromIndex:i,onSnapPointChange:a,direction:o="bottom",container:l,snapToSequentialPoint:u}){const[c,f]=bs({prop:e,defaultProp:n==null?void 0:n[0],onChange:t}),[E,h]=L.useState(typeof window<"u"?{innerWidth:window.innerWidth,innerHeight:window.innerHeight}:void 0);L.useEffect(()=>{function O(){h({innerWidth:window.innerWidth,innerHeight:window.innerHeight})}return window.addEventListener("resize",O),()=>window.removeEventListener("resize",O)},[]);const p=L.useMemo(()=>c===(n==null?void 0:n[n.length-1])||null,[n,c]),g=L.useMemo(()=>{var O;return(O=n==null?void 0:n.findIndex(w=>w===c))!=null?O:null},[n,c]),R=n&&n.length>0&&(i||i===0)&&!Number.isNaN(i)&&n[i]===c||!n,_=L.useMemo(()=>{const O=l?{width:l.getBoundingClientRect().width,height:l.getBoundingClientRect().height}:typeof window<"u"?{width:window.innerWidth,height:window.innerHeight}:{width:0,height:0};var w;return(w=n==null?void 0:n.map(v=>{const G=typeof v=="string";let M=0;if(G&&(M=parseInt(v,10)),se(o)){const C=G?M:E?v*O.height:0;return E?o==="bottom"?O.height-C:-O.height+C:C}const N=G?M:E?v*O.width:0;return E?o==="right"?O.width-N:-O.width+N:N}))!=null?w:[]},[n,E,l]),m=L.useMemo(()=>g!==null?_==null?void 0:_[g]:null,[_,g]),I=L.useCallback(O=>{var w;const v=(w=_==null?void 0:_.findIndex(G=>G===O))!=null?w:null;a(v),ae(r.current,{transition:`transform ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`,transform:se(o)?`translate3d(0, ${O}px, 0)`:`translate3d(${O}px, 0, 0)`}),_&&v!==_.length-1&&i!==void 0&&v!==i&&v<i?ae(s.current,{transition:`opacity ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`,opacity:"0"}):ae(s.current,{transition:`opacity ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`,opacity:"1"}),f(n==null?void 0:n[Math.max(v,0)])},[r.current,n,_,i,s,f]);L.useEffect(()=>{if(c||e){var O;const w=(O=n==null?void 0:n.findIndex(v=>v===e||v===c))!=null?O:-1;_&&w!==-1&&typeof _[w]=="number"&&I(_[w])}},[c,e,n,_,I]);function T({draggedDistance:O,closeDrawer:w,velocity:v,dismissible:G}){if(i===void 0)return;const M=o==="bottom"||o==="right"?(m??0)-O:(m??0)+O,N=g===i-1,C=g===0,x=O>0;if(N&&ae(s.current,{transition:`opacity ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`}),!u&&v>2&&!x){G?w():I(_[0]);return}if(!u&&v>2&&x&&_&&n){I(_[n.length-1]);return}const U=_==null?void 0:_.reduce((D,P)=>typeof D!="number"||typeof P!="number"?D:Math.abs(P-M)<Math.abs(D-M)?P:D),y=se(o)?window.innerHeight:window.innerWidth;if(v>Ds&&Math.abs(O)<y*.4){const D=x?1:-1;if(D>0&&p&&n){I(_[n.length-1]);return}if(C&&D<0&&G&&w(),g===null)return;I(_[g+D]);return}I(U)}function S({draggedDistance:O}){if(m===null)return;const w=o==="bottom"||o==="right"?m-O:m+O;(o==="bottom"||o==="right")&&w<_[_.length-1]||(o==="top"||o==="left")&&w>_[_.length-1]||ae(r.current,{transform:se(o)?`translate3d(0, ${w}px, 0)`:`translate3d(${w}px, 0, 0)`})}function b(O,w){if(!n||typeof g!="number"||!_||i===void 0)return null;const v=g===i-1;if(g>=i&&w)return 0;if(v&&!w)return 1;if(!R&&!v)return null;const M=v?g+1:g-1,N=v?_[M]-_[M-1]:_[M+1]-_[M],C=O/Math.abs(N);return v?1-C:C}return{isLastSnapPoint:p,activeSnapPoint:c,shouldFade:R,getPercentageDragged:b,setActiveSnapPoint:f,activeSnapPointIndex:g,onRelease:T,onDrag:S,snapPointsOffset:_}}const Co=()=>()=>{};function No(){const{direction:e,isOpen:t,shouldScaleBackground:n,setBackgroundColorOnScale:r,noBodyStyles:s}=At(),i=L.useRef(null),a=z.useMemo(()=>document.body.style.backgroundColor,[]);function o(){return(window.innerWidth-An)/window.innerWidth}L.useEffect(()=>{if(t&&n){i.current&&clearTimeout(i.current);const l=document.querySelector("[data-vaul-drawer-wrapper]")||document.querySelector("[vaul-drawer-wrapper]");if(!l)return;Do(r&&!s?cn(document.body,{background:"black"}):Co,cn(l,{transformOrigin:se(e)?"top":"left",transitionProperty:"transform, border-radius",transitionDuration:`${K.DURATION}s`,transitionTimingFunction:`cubic-bezier(${K.EASE.join(",")})`}));const u=cn(l,{borderRadius:`${Os}px`,overflow:"hidden",...se(e)?{transform:`scale(${o()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`}:{transform:`scale(${o()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`}});return()=>{u(),i.current=window.setTimeout(()=>{a?document.body.style.background=a:document.body.style.removeProperty("background")},K.DURATION*1e3)}}},[t,n,a])}let It=null;function Po({isOpen:e,modal:t,nested:n,hasBeenOpened:r,preventScrollRestoration:s,noBodyStyles:i}){const[a,o]=L.useState(()=>typeof window<"u"?window.location.href:""),l=L.useRef(0),u=L.useCallback(()=>{if(fr()&&It===null&&e&&!i){It={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left,height:document.body.style.height,right:"unset"};const{scrollX:f,innerHeight:E}=window;document.body.style.setProperty("position","fixed","important"),Object.assign(document.body.style,{top:`${-l.current}px`,left:`${-f}px`,right:"0px",height:"auto"}),window.setTimeout(()=>window.requestAnimationFrame(()=>{const h=E-window.innerHeight;h&&l.current>=E&&(document.body.style.top=`${-(l.current+h)}px`)}),300)}},[e]),c=L.useCallback(()=>{if(fr()&&It!==null&&!i){const f=-parseInt(document.body.style.top,10),E=-parseInt(document.body.style.left,10);Object.assign(document.body.style,It),window.requestAnimationFrame(()=>{if(s&&a!==window.location.href){o(window.location.href);return}window.scrollTo(E,f)}),It=null}},[a]);return L.useEffect(()=>{function f(){l.current=window.scrollY}return f(),window.addEventListener("scroll",f),()=>{window.removeEventListener("scroll",f)}},[]),L.useEffect(()=>{if(t)return()=>{typeof document>"u"||document.querySelector("[data-vaul-drawer]")||c()}},[t,c]),L.useEffect(()=>{n||!r||(e?(!window.matchMedia("(display-mode: standalone)").matches&&u(),t||window.setTimeout(()=>{c()},500)):c())},[e,r,a,t,n,u,c]),{restorePositionSetting:c}}function Lo({open:e,onOpenChange:t,children:n,onDrag:r,onRelease:s,snapPoints:i,shouldScaleBackground:a=!1,setBackgroundColorOnScale:o=!0,closeThreshold:l=Oo,scrollLockTimeout:u=xo,dismissible:c=!0,handleOnly:f=!1,fadeFromIndex:E=i&&i.length-1,activeSnapPoint:h,setActiveSnapPoint:p,fixed:g,modal:R=!0,onClose:_,nested:m,noBodyStyles:I=!1,direction:T="bottom",defaultOpen:S=!1,disablePreventScroll:b=!0,snapToSequentialPoint:O=!1,preventScrollRestoration:w=!1,repositionInputs:v=!0,onAnimationEnd:G,container:M,autoFocus:N=!1}){var C,x;const[U=!1,y]=bs({defaultProp:S,prop:e,onChange:j=>{t==null||t(j),!j&&!m&&Wi(),setTimeout(()=>{G==null||G(j)},K.DURATION*1e3),j&&!R&&typeof window<"u"&&window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"}),j||(document.body.style.pointerEvents="auto")}}),[D,P]=L.useState(!1),[F,W]=L.useState(!1),[B,ve]=L.useState(!1),ge=L.useRef(null),le=L.useRef(null),Ue=L.useRef(null),k=L.useRef(null),Z=L.useRef(null),fe=L.useRef(!1),ye=L.useRef(null),re=L.useRef(0),Ie=L.useRef(!1),ut=L.useRef(!S),Ot=L.useRef(0),H=L.useRef(null),$=L.useRef(((C=H.current)==null?void 0:C.getBoundingClientRect().height)||0),_e=L.useRef(((x=H.current)==null?void 0:x.getBoundingClientRect().width)||0),ft=L.useRef(0),ji=L.useCallback(j=>{i&&j===pt.length-1&&(le.current=new Date)},[]),{activeSnapPoint:Vi,activeSnapPointIndex:rt,setActiveSnapPoint:rr,onRelease:Hi,snapPointsOffset:pt,onDrag:ki,shouldFade:sr,getPercentageDragged:$i}=Mo({snapPoints:i,activeSnapPointProp:h,setActiveSnapPointProp:p,drawerRef:H,fadeFromIndex:E,overlayRef:ge,onSnapPointChange:ji,direction:T,container:M,snapToSequentialPoint:O});To({isDisabled:!U||F||!R||B||!D||!v||!b});const{restorePositionSetting:Wi}=Po({isOpen:U,modal:R,nested:m??!1,hasBeenOpened:D,preventScrollRestoration:w,noBodyStyles:I});function xt(){return(window.innerWidth-An)/window.innerWidth}function zi(j){var q,X;!c&&!i||H.current&&!H.current.contains(j.target)||($.current=((q=H.current)==null?void 0:q.getBoundingClientRect().height)||0,_e.current=((X=H.current)==null?void 0:X.getBoundingClientRect().width)||0,W(!0),Ue.current=new Date,ys()&&window.addEventListener("touchend",()=>fe.current=!1,{once:!0}),j.target.setPointerCapture(j.pointerId),re.current=se(T)?j.pageY:j.pageX)}function ir(j,q){var X;let Y=j;const ee=(X=window.getSelection())==null?void 0:X.toString(),Te=H.current?Ct(H.current,T):null,pe=new Date;if(Y.tagName==="SELECT"||Y.hasAttribute("data-vaul-no-drag")||Y.closest("[data-vaul-no-drag]"))return!1;if(T==="right"||T==="left")return!0;if(le.current&&pe.getTime()-le.current.getTime()<500)return!1;if(Te!==null&&(T==="bottom"?Te>0:Te<0))return!0;if(ee&&ee.length>0)return!1;if(Z.current&&pe.getTime()-Z.current.getTime()<u&&Te===0||q)return Z.current=pe,!1;for(;Y;){if(Y.scrollHeight>Y.clientHeight){if(Y.scrollTop!==0)return Z.current=new Date,!1;if(Y.getAttribute("role")==="dialog")return!0}Y=Y.parentNode}return!0}function Yi(j){if(H.current&&F){const q=T==="bottom"||T==="right"?1:-1,X=(re.current-(se(T)?j.pageY:j.pageX))*q,Y=X>0,ee=i&&!c&&!Y;if(ee&&rt===0)return;const Te=Math.abs(X),pe=document.querySelector("[data-vaul-drawer-wrapper]"),Ve=T==="bottom"||T==="top"?$.current:_e.current;let be=Te/Ve;const We=$i(Te,Y);if(We!==null&&(be=We),ee&&be>=1||!fe.current&&!ir(j.target,Y))return;if(H.current.classList.add(dn),fe.current=!0,ae(H.current,{transition:"none"}),ae(ge.current,{transition:"none"}),i&&ki({draggedDistance:X}),Y&&!i){const Pe=Ao(X),bt=Math.min(Pe*-1,0)*q;ae(H.current,{transform:se(T)?`translate3d(0, ${bt}px, 0)`:`translate3d(${bt}px, 0, 0)`});return}const He=1-be;if((sr||E&&rt===E-1)&&(r==null||r(j,be),ae(ge.current,{opacity:`${He}`,transition:"none"},!0)),pe&&ge.current&&a){const Pe=Math.min(xt()+be*(1-xt()),1),bt=8-be*8,or=Math.max(0,14-be*14);ae(pe,{borderRadius:`${bt}px`,transform:se(T)?`scale(${Pe}) translate3d(0, ${or}px, 0)`:`scale(${Pe}) translate3d(${or}px, 0, 0)`,transition:"none"},!0)}if(!i){const Pe=Te*q;ae(H.current,{transform:se(T)?`translate3d(0, ${Pe}px, 0)`:`translate3d(${Pe}px, 0, 0)`})}}}L.useEffect(()=>{window.requestAnimationFrame(()=>{ut.current=!0})},[]),L.useEffect(()=>{var j;function q(){if(!H.current||!v)return;const X=document.activeElement;if(vn(X)||Ie.current){var Y;const ee=((Y=window.visualViewport)==null?void 0:Y.height)||0,Te=window.innerHeight;let pe=Te-ee;const Ve=H.current.getBoundingClientRect().height||0,be=Ve>Te*.8;ft.current||(ft.current=Ve);const We=H.current.getBoundingClientRect().top;if(Math.abs(Ot.current-pe)>60&&(Ie.current=!Ie.current),i&&i.length>0&&pt&&rt){const He=pt[rt]||0;pe+=He}if(Ot.current=pe,Ve>ee||Ie.current){const He=H.current.getBoundingClientRect().height;let Pe=He;He>ee&&(Pe=ee-(be?We:An)),g?H.current.style.height=`${He-Math.max(pe,0)}px`:H.current.style.height=`${Math.max(Pe,ee-We)}px`}else po()||(H.current.style.height=`${ft.current}px`);i&&i.length>0&&!Ie.current?H.current.style.bottom="0px":H.current.style.bottom=`${Math.max(pe,0)}px`}}return(j=window.visualViewport)==null||j.addEventListener("resize",q),()=>{var X;return(X=window.visualViewport)==null?void 0:X.removeEventListener("resize",q)}},[rt,i,pt]);function mt(j){qi(),_==null||_(),j||y(!1),setTimeout(()=>{i&&rr(i[0])},K.DURATION*1e3)}function ar(){if(!H.current)return;const j=document.querySelector("[data-vaul-drawer-wrapper]"),q=Ct(H.current,T);ae(H.current,{transform:"translate3d(0, 0, 0)",transition:`transform ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`}),ae(ge.current,{transition:`opacity ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`,opacity:"1"}),a&&q&&q>0&&U&&ae(j,{borderRadius:`${Os}px`,overflow:"hidden",...se(T)?{transform:`scale(${xt()}) translate3d(0, calc(env(safe-area-inset-top) + 14px), 0)`,transformOrigin:"top"}:{transform:`scale(${xt()}) translate3d(calc(env(safe-area-inset-top) + 14px), 0, 0)`,transformOrigin:"left"},transitionProperty:"transform, border-radius",transitionDuration:`${K.DURATION}s`,transitionTimingFunction:`cubic-bezier(${K.EASE.join(",")})`},!0)}function qi(){!F||!H.current||(H.current.classList.remove(dn),fe.current=!1,W(!1),k.current=new Date)}function Xi(j){if(!F||!H.current)return;H.current.classList.remove(dn),fe.current=!1,W(!1),k.current=new Date;const q=Ct(H.current,T);if(!j||!ir(j.target,!1)||!q||Number.isNaN(q)||Ue.current===null)return;const X=k.current.getTime()-Ue.current.getTime(),Y=re.current-(se(T)?j.pageY:j.pageX),ee=Math.abs(Y)/X;if(ee>.05&&(ve(!0),setTimeout(()=>{ve(!1)},200)),i){Hi({draggedDistance:Y*(T==="bottom"||T==="right"?1:-1),closeDrawer:mt,velocity:ee,dismissible:c}),s==null||s(j,!0);return}if(T==="bottom"||T==="right"?Y>0:Y<0){ar(),s==null||s(j,!0);return}if(ee>Ds){mt(),s==null||s(j,!1);return}var Te;const pe=Math.min((Te=H.current.getBoundingClientRect().height)!=null?Te:0,window.innerHeight);var Ve;const be=Math.min((Ve=H.current.getBoundingClientRect().width)!=null?Ve:0,window.innerWidth),We=T==="left"||T==="right";if(Math.abs(q)>=(We?be:pe)*l){mt(),s==null||s(j,!1);return}s==null||s(j,!0),ar()}L.useEffect(()=>(U&&(ae(document.documentElement,{scrollBehavior:"auto"}),le.current=new Date),()=>{vo(document.documentElement,"scrollBehavior")}),[U]);function Qi(j){const q=j?(window.innerWidth-Nt)/window.innerWidth:1,X=j?-16:0;ye.current&&window.clearTimeout(ye.current),ae(H.current,{transition:`transform ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`,transform:se(T)?`scale(${q}) translate3d(0, ${X}px, 0)`:`scale(${q}) translate3d(${X}px, 0, 0)`}),!j&&H.current&&(ye.current=setTimeout(()=>{const Y=Ct(H.current,T);ae(H.current,{transition:"none",transform:se(T)?`translate3d(0, ${Y}px, 0)`:`translate3d(${Y}px, 0, 0)`})},500))}function Zi(j,q){if(q<0)return;const X=(window.innerWidth-Nt)/window.innerWidth,Y=X+q*(1-X),ee=-16+q*Nt;ae(H.current,{transform:se(T)?`scale(${Y}) translate3d(0, ${ee}px, 0)`:`scale(${Y}) translate3d(${ee}px, 0, 0)`,transition:"none"})}function Ki(j,q){const X=se(T)?window.innerHeight:window.innerWidth,Y=q?(X-Nt)/X:1,ee=q?-16:0;q&&ae(H.current,{transition:`transform ${K.DURATION}s cubic-bezier(${K.EASE.join(",")})`,transform:se(T)?`scale(${Y}) translate3d(0, ${ee}px, 0)`:`scale(${Y}) translate3d(${ee}px, 0, 0)`})}return L.useEffect(()=>{R||window.requestAnimationFrame(()=>{document.body.style.pointerEvents="auto"})},[R]),L.createElement(na,{defaultOpen:S,onOpenChange:j=>{!c&&!j||(j?P(!0):mt(!0),y(j))},open:U},L.createElement(ws.Provider,{value:{activeSnapPoint:Vi,snapPoints:i,setActiveSnapPoint:rr,drawerRef:H,overlayRef:ge,onOpenChange:t,onPress:zi,onRelease:Xi,onDrag:Yi,dismissible:c,shouldAnimate:ut,handleOnly:f,isOpen:U,isDragging:F,shouldFade:sr,closeDrawer:mt,onNestedDrag:Zi,onNestedOpenChange:Qi,onNestedRelease:Ki,keyboardIsOpen:Ie,modal:R,snapPointsOffset:pt,activeSnapPointIndex:rt,direction:T,shouldScaleBackground:a,setBackgroundColorOnScale:o,noBodyStyles:I,container:M,autoFocus:N}},n))}const Ms=L.forwardRef(function({...e},t){const{overlayRef:n,snapPoints:r,onRelease:s,shouldFade:i,isOpen:a,modal:o,shouldAnimate:l}=At(),u=vs(t,n),c=r&&r.length>0;if(!o)return null;const f=L.useCallback(E=>s(E),[s]);return L.createElement(ia,{onMouseUp:f,ref:u,"data-vaul-overlay":"","data-vaul-snap-points":a&&c?"true":"false","data-vaul-snap-points-overlay":a&&i?"true":"false","data-vaul-animate":l!=null&&l.current?"true":"false",...e})});Ms.displayName="Drawer.Overlay";const Cs=L.forwardRef(function({onPointerDownOutside:e,style:t,onOpenAutoFocus:n,...r},s){const{drawerRef:i,onPress:a,onRelease:o,onDrag:l,keyboardIsOpen:u,snapPointsOffset:c,activeSnapPointIndex:f,modal:E,isOpen:h,direction:p,snapPoints:g,container:R,handleOnly:_,shouldAnimate:m,autoFocus:I}=At(),[T,S]=L.useState(!1),b=vs(s,i),O=L.useRef(null),w=L.useRef(null),v=L.useRef(!1),G=g&&g.length>0;No();const M=(C,x,U=0)=>{if(v.current)return!0;const y=Math.abs(C.y),D=Math.abs(C.x),P=D>y,F=["bottom","right"].includes(x)?1:-1;if(x==="left"||x==="right"){if(!(C.x*F<0)&&D>=0&&D<=U)return P}else if(!(C.y*F<0)&&y>=0&&y<=U)return!P;return v.current=!0,!0};L.useEffect(()=>{G&&window.requestAnimationFrame(()=>{S(!0)})},[]);function N(C){O.current=null,v.current=!1,o(C)}return L.createElement(sa,{"data-vaul-drawer-direction":p,"data-vaul-drawer":"","data-vaul-delayed-snap-points":T?"true":"false","data-vaul-snap-points":h&&G?"true":"false","data-vaul-custom-container":R?"true":"false","data-vaul-animate":m!=null&&m.current?"true":"false",...r,ref:b,style:c&&c.length>0?{"--snap-point-height":`${c[f??0]}px`,...t}:t,onPointerDown:C=>{_||(r.onPointerDown==null||r.onPointerDown.call(r,C),O.current={x:C.pageX,y:C.pageY},a(C))},onOpenAutoFocus:C=>{n==null||n(C),I||C.preventDefault()},onPointerDownOutside:C=>{if(e==null||e(C),!E||C.defaultPrevented){C.preventDefault();return}u.current&&(u.current=!1)},onFocusOutside:C=>{if(!E){C.preventDefault();return}},onPointerMove:C=>{if(w.current=C,_||(r.onPointerMove==null||r.onPointerMove.call(r,C),!O.current))return;const x=C.pageY-O.current.y,U=C.pageX-O.current.x,y=C.pointerType==="touch"?10:2;M({x:U,y:x},p,y)?l(C):(Math.abs(U)>y||Math.abs(x)>y)&&(O.current=null)},onPointerUp:C=>{r.onPointerUp==null||r.onPointerUp.call(r,C),O.current=null,v.current=!1,o(C)},onPointerOut:C=>{r.onPointerOut==null||r.onPointerOut.call(r,C),N(w.current)},onContextMenu:C=>{r.onContextMenu==null||r.onContextMenu.call(r,C),w.current&&N(w.current)}})});Cs.displayName="Drawer.Content";const Go=250,Fo=120,Uo=L.forwardRef(function({preventCycle:e=!1,children:t,...n},r){const{closeDrawer:s,isDragging:i,snapPoints:a,activeSnapPoint:o,setActiveSnapPoint:l,dismissible:u,handleOnly:c,isOpen:f,onPress:E,onDrag:h}=At(),p=L.useRef(null),g=L.useRef(!1);function R(){if(g.current){I();return}window.setTimeout(()=>{_()},Fo)}function _(){if(i||e||g.current){I();return}if(I(),!a||a.length===0){u||s();return}if(o===a[a.length-1]&&u){s();return}const S=a.findIndex(O=>O===o);if(S===-1)return;const b=a[S+1];l(b)}function m(){p.current=window.setTimeout(()=>{g.current=!0},Go)}function I(){p.current&&window.clearTimeout(p.current),g.current=!1}return L.createElement("div",{onClick:R,onPointerCancel:I,onPointerDown:T=>{c&&E(T),m()},onPointerMove:T=>{c&&h(T)},ref:r,"data-vaul-drawer-visible":f?"true":"false","data-vaul-handle":"","aria-hidden":"true",...n},L.createElement("span",{"data-vaul-handle-hitarea":"","aria-hidden":"true"},t))});Uo.displayName="Drawer.Handle";function Bo(e){const t=At(),{container:n=t.container,...r}=e;return L.createElement(ra,{container:n,...r})}const Fe={Root:Lo,Content:Cs,Overlay:Ms,Portal:Bo,Close:Ji,Title:ea,Description:ta},Ns=({shouldScaleBackground:e=!0,...t})=>d.jsx(Fe.Root,{shouldScaleBackground:e,...t});Ns.displayName="Drawer";const jo=Fe.Portal,hr=Fe.Close,Ps=z.forwardRef(({className:e,...t},n)=>d.jsx(Fe.Overlay,{ref:n,className:ue("fixed inset-0 z-50 bg-black/80",e),...t}));Ps.displayName=Fe.Overlay.displayName;const Ls=z.forwardRef(({className:e,children:t,...n},r)=>d.jsxs(jo,{children:[d.jsx(Ps,{}),d.jsxs(Fe.Content,{ref:r,className:ue("fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background",e),...n,children:[d.jsx("div",{className:"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted"}),t]})]}));Ls.displayName="DrawerContent";const Gs=({className:e,...t})=>d.jsx("div",{className:ue("grid gap-1.5 p-4 text-center sm:text-left",e),...t});Gs.displayName="DrawerHeader";const Fs=({className:e,...t})=>d.jsx("div",{className:ue("mt-auto flex flex-col gap-2 p-4",e),...t});Fs.displayName="DrawerFooter";const Us=z.forwardRef(({className:e,...t},n)=>d.jsx(Fe.Title,{ref:n,className:ue("text-lg font-semibold leading-none tracking-tight",e),...t}));Us.displayName=Fe.Title.displayName;const Bs=z.forwardRef(({className:e,...t},n)=>d.jsx(Fe.Description,{ref:n,className:ue("text-sm text-muted-foreground",e),...t}));Bs.displayName=Fe.Description.displayName;function Vo({media:e,altText:t,title:n,onDelete:r,disabled:s=!1}){return d.jsxs("div",{className:"space-y-5",children:[d.jsx("div",{className:"overflow-hidden rounded-lg border bg-background",children:St(e.mime_type)?d.jsx("img",{src:e.url,alt:t||e.name,className:"object-contain w-full h-auto max-h-[400px]"}):d.jsxs("div",{className:"flex flex-col justify-center items-center h-72 bg-muted/30",children:[Rs(e.mime_type),d.jsx("span",{className:"mt-4 text-sm text-muted-foreground",children:e.mime_type.split("/")[1].toUpperCase()})]})}),d.jsxs("div",{className:"grid grid-cols-2 gap-y-2 gap-x-4 text-sm",children:[d.jsx("div",{className:"text-muted-foreground",children:"Type:"}),d.jsx("div",{className:"font-medium",children:e.mime_type}),d.jsx("div",{className:"text-muted-foreground",children:"Size:"}),d.jsx("div",{className:"font-medium",children:jn(e.size)}),e.width&&e.height&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"text-muted-foreground",children:"Dimensions:"}),d.jsxs("div",{className:"font-medium",children:[e.width," × ",e.height,"px"]})]}),d.jsx("div",{className:"text-muted-foreground",children:"Collection:"}),d.jsx("div",{children:d.jsx(Bn,{variant:"outline",children:e.collection_name})})]}),d.jsxs("div",{className:"flex gap-3 pt-1",children:[St(e.mime_type)&&d.jsx(Q,{variant:"outline",size:"sm",className:"flex-1",asChild:!0,disabled:s,children:d.jsxs("a",{href:e.url,download:!0,target:"_blank",rel:"noopener noreferrer",children:[d.jsx(gs,{className:"mr-2 w-4 h-4"}),"Download"]})}),d.jsxs(Q,{variant:"destructive",size:"sm",className:"flex-1 text-white",onClick:r,disabled:s,children:[d.jsx(zt,{className:"mr-2 w-4 h-4"}),"Delete"]})]})]})}function Ho({media:e,collections:t,formData:n,setData:r,errors:s={},disabled:i=!1}){var a;return d.jsxs(_s,{children:[d.jsxs(xa,{className:"pb-3",children:[d.jsx(ba,{children:"Media Information"}),d.jsx(Ma,{children:"Edit details and properties for this media item"})]}),d.jsxs(Ts,{className:"space-y-5",children:[d.jsxs("div",{className:"space-y-2",children:[d.jsx(ht,{htmlFor:"media-name",className:"text-base font-medium",children:"File Name"}),d.jsx(Tn,{id:"media-name",value:n.name,onChange:o=>r("name",o.target.value),className:ue(s.name&&"border-destructive"),disabled:i}),s.name&&d.jsx("p",{className:"text-xs text-destructive",children:s.name})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(ht,{htmlFor:"media-collection",className:"text-base font-medium",children:"Collection"}),d.jsxs(Rn,{value:n.collection_name,onValueChange:o=>r("collection_name",o),disabled:i,children:[d.jsx(wn,{id:"media-collection",children:d.jsx(yn,{placeholder:"Select a collection"})}),d.jsx(Sn,{children:t.map(o=>d.jsx(Ht,{value:o.name,children:o.name},o.name))})]})]}),St(e.mime_type)&&d.jsxs("div",{className:"p-4 space-y-4 rounded-md bg-muted/30",children:[d.jsx("h3",{className:"text-sm font-medium",children:"Image Properties"}),d.jsxs("div",{className:"space-y-2",children:[d.jsxs(ht,{htmlFor:"media-alt-text",className:"flex items-center",children:["Alt Text",d.jsx(Ca,{children:d.jsxs(Na,{children:[d.jsx(Pa,{asChild:!0,children:d.jsx(_a,{className:"h-3.5 w-3.5 ml-1.5 text-muted-foreground"})}),d.jsx(La,{side:"right",className:"max-w-80",children:d.jsx("p",{children:"Alternative text describes an image and helps with accessibility and SEO. It should be descriptive of what appears in the image."})})]})})]}),d.jsx(ka,{id:"media-alt-text",value:n.alt_text,onChange:o=>r("alt_text",o.target.value),placeholder:"Describe this image for screen readers and SEO",className:"resize-none",rows:2,disabled:i})]}),d.jsxs("div",{className:"space-y-2",children:[d.jsx(ht,{htmlFor:"media-title",children:"Title Attribute"}),d.jsx(Tn,{id:"media-title",value:n.title,onChange:o=>r("title",o.target.value),placeholder:"Optional title shown on hover",disabled:i})]})]}),d.jsx(Ga,{}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx(ht,{htmlFor:"media-public",className:"block mb-1",children:"Public Access"}),d.jsx("p",{className:"text-sm text-muted-foreground",children:"Allow access without authentication"})]}),d.jsx(za,{id:"media-public",checked:((a=n.custom_properties)==null?void 0:a.public)===!0,onCheckedChange:o=>r("custom_properties",{...n.custom_properties,public:o}),disabled:i})]})]})]})}function ko({isOpen:e,onOpenChange:t,selectedMedia:n,collections:r,onUpdate:s,onDelete:i,formData:a,setData:o,processing:l,errors:u={}}){if(!n)return null;const c=()=>{s()};return d.jsx(Ns,{open:e,onOpenChange:f=>{l&&!f||t(f)},children:d.jsx(Ls,{className:"max-h-[95vh]",children:d.jsxs("div",{className:"mx-auto w-full max-w-5xl flex flex-col h-[90vh]",children:[d.jsxs(Gs,{className:"flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx(Us,{children:"Media Details"}),d.jsx(Bs,{children:"View and edit information for this media item"})]}),d.jsx(hr,{asChild:!0,children:d.jsxs(Q,{variant:"ghost",size:"icon",disabled:l,children:[d.jsx(Kt,{className:"w-4 h-4"}),d.jsx("span",{className:"sr-only",children:"Close"})]})})]}),d.jsx("div",{className:"overflow-hidden flex-1",children:d.jsx(Wa,{className:"px-6 h-full",children:d.jsxs("div",{className:"grid grid-cols-1 gap-6 py-4 md:grid-cols-5",children:[d.jsx("div",{className:"md:col-span-2",children:d.jsx(Vo,{media:n,altText:a.alt_text,title:a.title,onDelete:i,disabled:l})}),d.jsx("div",{className:"md:col-span-3",children:d.jsx(Ho,{media:n,collections:r,formData:a,setData:o,errors:u,disabled:l})})]})})}),d.jsx(Fs,{className:"border-t bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:d.jsxs("div",{className:"flex gap-2 justify-end",children:[d.jsx(hr,{asChild:!0,children:d.jsx(Q,{variant:"outline",disabled:l,children:"Close"})}),d.jsxs(Q,{onClick:c,disabled:l,children:[d.jsx(Ta,{className:"mr-2 w-4 h-4"}),l?"Saving...":"Save Changes"]})]})})]})})})}function $o({isOpen:e,onOpenChange:t,onConfirm:n,media:r,processing:s=!1}){return d.jsx(Ya,{open:e,onOpenChange:i=>{s&&!i||t(i)},children:d.jsxs(qa,{children:[d.jsxs(Xa,{children:[d.jsx(Qa,{children:"Delete Media"}),d.jsxs(Za,{children:["Are you sure you want to delete this media item?",(r==null?void 0:r.model_id)&&d.jsx("div",{className:"mt-2 font-medium text-destructive",children:"Warning: This media is currently in use. Deleting it may affect content that references it."})]})]}),d.jsxs(Ka,{children:[d.jsx(Ja,{disabled:s,children:"Cancel"}),d.jsx(eo,{onClick:n,className:ue(Ba({variant:"destructive"}),"mt-2 sm:mt-0"),disabled:s,children:s?d.jsxs(d.Fragment,{children:[d.jsx(Ra,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})}var Hn="Progress",kn=100,[Wo,bp]=aa(Hn),[zo,Yo]=Wo(Hn),js=z.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=qo,...a}=e;(s||s===0)&&!gr(s)&&console.error(Xo(`${s}`,"Progress"));const o=gr(s)?s:kn;r!==null&&!Ir(r,o)&&console.error(Qo(`${r}`,"Progress"));const l=Ir(r,o)?r:null,u=Yt(l)?i(l,o):void 0;return d.jsx(zo,{scope:n,value:l,max:o,children:d.jsx(hs.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Yt(l)?l:void 0,"aria-valuetext":u,role:"progressbar","data-state":ks(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});js.displayName=Hn;var Vs="ProgressIndicator",Hs=z.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=Yo(Vs,n);return d.jsx(hs.div,{"data-state":ks(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});Hs.displayName=Vs;function qo(e,t){return`${Math.round(e/t*100)}%`}function ks(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Yt(e){return typeof e=="number"}function gr(e){return Yt(e)&&!isNaN(e)&&e>0}function Ir(e,t){return Yt(e)&&!isNaN(e)&&e<=t&&e>=0}function Xo(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${kn}\`.`}function Qo(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${kn} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var $s=js,Zo=Hs;const Ws=z.forwardRef(({className:e,value:t,...n},r)=>d.jsx($s,{ref:r,className:ue("relative h-2 w-full overflow-hidden rounded-full bg-primary/20",e),...n,children:d.jsx(Zo,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ws.displayName=$s.displayName;function Ko({file:e,progress:t,status:n,error:r,onCancel:s,preview:i}){return d.jsxs("div",{className:ue("relative overflow-hidden rounded-md border bg-background transition-all group hover:shadow-md",n==="success"&&"ring-2 ring-green-500",n==="error"&&"ring-2 ring-destructive"),children:[d.jsxs("div",{className:"overflow-hidden relative aspect-square",children:[d.jsx("img",{src:i,alt:e.name,className:"object-cover w-full h-full transition-transform group-hover:scale-105"}),d.jsxs("div",{className:ue("absolute inset-0 flex flex-col items-center justify-center transition-opacity",n==="uploading"?"bg-black/50":n==="success"?"bg-green-500/20":"bg-destructive/20",n==="success"&&"opacity-0 group-hover:opacity-100"),children:[n==="uploading"&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"mb-2 w-4/5",children:d.jsx(Ws,{value:t,className:"h-2"})}),d.jsxs("span",{className:"text-xs font-medium text-white",children:[t,"%"]})]}),n==="success"&&d.jsx(_n,{className:"w-10 h-10 text-green-500"}),n==="error"&&d.jsx(cr,{className:"w-10 h-10 text-destructive"})]}),n==="uploading"&&d.jsxs(Q,{variant:"outline",size:"icon",className:"absolute top-2 right-2 w-6 h-6 border-none backdrop-blur-sm bg-background/80",onClick:s,children:[d.jsx(Kt,{className:"w-4 h-4"}),d.jsx("span",{className:"sr-only",children:"Cancel upload"})]}),n==="success"&&d.jsx("div",{className:"absolute top-2 right-2",children:d.jsx(_n,{className:"w-5 h-5 text-green-500"})}),n==="error"&&d.jsx("div",{className:"absolute top-2 right-2",children:d.jsx(cr,{className:"w-5 h-5 text-destructive"})})]}),d.jsxs("div",{className:"p-2",children:[d.jsx("div",{className:"text-sm font-medium truncate",children:e.name}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{className:"text-xs text-muted-foreground",children:[Math.round(e.size/1024)," KB"]}),n==="error"&&r&&d.jsx("div",{className:"text-xs truncate text-destructive",title:r,children:r.length>20?r.substring(0,20)+"...":r})]})]})]})}/*!
 * FilePond 4.32.7
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Jo=e=>e instanceof HTMLElement,el=(e,t=[],n=[])=>{const r={...e},s=[],i=[],a=()=>({...r}),o=()=>{const p=[...s];return s.length=0,p},l=()=>{const p=[...i];i.length=0,p.forEach(({type:g,data:R})=>{u(g,R)})},u=(p,g,R)=>{if(R&&!document.hidden){i.push({type:p,data:g});return}h[p]&&h[p](g),s.push({type:p,data:g})},c=(p,...g)=>E[p]?E[p](...g):null,f={getState:a,processActionQueue:o,processDispatchQueue:l,dispatch:u,query:c};let E={};t.forEach(p=>{E={...p(r),...E}});let h={};return n.forEach(p=>{h={...p(u,c,r),...h}}),f},tl=(e,t,n)=>{if(typeof n=="function"){e[t]=n;return}Object.defineProperty(e,t,{...n})},J=(e,t)=>{for(const n in e)e.hasOwnProperty(n)&&t(n,e[n])},$e=e=>{const t={};return J(e,n=>{tl(t,n,e[n])}),t},oe=(e,t,n=null)=>{if(n===null)return e.getAttribute(t)||e.hasAttribute(t);e.setAttribute(t,n)},nl="http://www.w3.org/2000/svg",rl=["svg","path"],_r=e=>rl.includes(e),qt=(e,t,n={})=>{typeof t=="object"&&(n=t,t=null);const r=_r(e)?document.createElementNS(nl,e):document.createElement(e);return t&&(_r(e)?oe(r,"class",t):r.className=t),J(n,(s,i)=>{oe(r,s,i)}),r},sl=e=>(t,n)=>{typeof n<"u"&&e.children[n]?e.insertBefore(t,e.children[n]):e.appendChild(t)},il=(e,t)=>(n,r)=>(typeof r<"u"?t.splice(r,0,n):t.push(n),n),al=(e,t)=>n=>(t.splice(t.indexOf(n),1),n.element.parentNode&&e.removeChild(n.element),n),ol=typeof window<"u"&&typeof window.document<"u",zs=()=>ol,ll=zs()?qt("svg"):{},cl="children"in ll?e=>e.children.length:e=>e.childNodes.length,Ys=(e,t,n,r)=>{const s=n[0]||e.left,i=n[1]||e.top,a=s+e.width,o=i+e.height*(r[1]||1),l={element:{...e},inner:{left:e.left,top:e.top,right:e.right,bottom:e.bottom},outer:{left:s,top:i,right:a,bottom:o}};return t.filter(u=>!u.isRectIgnored()).map(u=>u.rect).forEach(u=>{Tr(l.inner,{...u.inner}),Tr(l.outer,{...u.outer})}),Rr(l.inner),l.outer.bottom+=l.element.marginBottom,l.outer.right+=l.element.marginRight,Rr(l.outer),l},Tr=(e,t)=>{t.top+=e.top,t.right+=e.left,t.bottom+=e.top,t.left+=e.left,t.bottom>e.bottom&&(e.bottom=t.bottom),t.right>e.right&&(e.right=t.right)},Rr=e=>{e.width=e.right-e.left,e.height=e.bottom-e.top},qe=e=>typeof e=="number",dl=(e,t,n,r=.001)=>Math.abs(e-t)<r&&Math.abs(n)<r,ul=({stiffness:e=.5,damping:t=.75,mass:n=10}={})=>{let r=null,s=null,i=0,a=!1;const u=$e({interpolate:(c,f)=>{if(a)return;if(!(qe(r)&&qe(s))){a=!0,i=0;return}const E=-(s-r)*e;i+=E/n,s+=i,i*=t,dl(s,r,i)||f?(s=r,i=0,a=!0,u.onupdate(s),u.oncomplete(s)):u.onupdate(s)},target:{set:c=>{if(qe(c)&&!qe(s)&&(s=c),r===null&&(r=c,s=c),r=c,s===r||typeof r>"u"){a=!0,i=0,u.onupdate(s),u.oncomplete(s);return}a=!1},get:()=>r},resting:{get:()=>a},onupdate:c=>{},oncomplete:c=>{}});return u},fl=e=>e<.5?2*e*e:-1+(4-2*e)*e,pl=({duration:e=500,easing:t=fl,delay:n=0}={})=>{let r=null,s,i,a=!0,o=!1,l=null;const c=$e({interpolate:(f,E)=>{a||l===null||(r===null&&(r=f),!(f-r<n)&&(s=f-r-n,s>=e||E?(s=1,i=o?0:1,c.onupdate(i*l),c.oncomplete(i*l),a=!0):(i=s/e,c.onupdate((s>=0?t(o?1-i:i):0)*l))))},target:{get:()=>o?0:l,set:f=>{if(l===null){l=f,c.onupdate(f),c.oncomplete(f);return}f<l?(l=1,o=!0):(o=!1,l=f),a=!1,r=null}},resting:{get:()=>a},onupdate:f=>{},oncomplete:f=>{}});return c},wr={spring:ul,tween:pl},ml=(e,t,n)=>{const r=e[t]&&typeof e[t][n]=="object"?e[t][n]:e[t]||e,s=typeof r=="string"?r:r.type,i=typeof r=="object"?{...r}:{};return wr[s]?wr[s](i):null},$n=(e,t,n,r=!1)=>{t=Array.isArray(t)?t:[t],t.forEach(s=>{e.forEach(i=>{let a=i,o=()=>n[i],l=u=>n[i]=u;typeof i=="object"&&(a=i.key,o=i.getter||o,l=i.setter||l),!(s[a]&&!r)&&(s[a]={get:o,set:l})})})},El=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:r})=>{const s={...t},i=[];return J(e,(a,o)=>{const l=ml(o);if(!l)return;l.onupdate=c=>{t[a]=c},l.target=s[a],$n([{key:a,setter:c=>{l.target!==c&&(l.target=c)},getter:()=>t[a]}],[n,r],t,!0),i.push(l)}),{write:a=>{let o=document.hidden,l=!0;return i.forEach(u=>{u.resting||(l=!1),u.interpolate(a,o)}),l},destroy:()=>{}}},hl=e=>(t,n)=>{e.addEventListener(t,n)},gl=e=>(t,n)=>{e.removeEventListener(t,n)},Il=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:r,viewState:s,view:i})=>{const a=[],o=hl(i.element),l=gl(i.element);return r.on=(u,c)=>{a.push({type:u,fn:c}),o(u,c)},r.off=(u,c)=>{a.splice(a.findIndex(f=>f.type===u&&f.fn===c),1),l(u,c)},{write:()=>!0,destroy:()=>{a.forEach(u=>{l(u.type,u.fn)})}}},_l=({mixinConfig:e,viewProps:t,viewExternalAPI:n})=>{$n(e,n,t)},me=e=>e!=null,Tl={opacity:1,scaleX:1,scaleY:1,translateX:0,translateY:0,rotateX:0,rotateY:0,rotateZ:0,originX:0,originY:0},Rl=({mixinConfig:e,viewProps:t,viewInternalAPI:n,viewExternalAPI:r,view:s})=>{const i={...t},a={};$n(e,[n,r],t);const o=()=>[t.translateX||0,t.translateY||0],l=()=>[t.scaleX||0,t.scaleY||0],u=()=>s.rect?Ys(s.rect,s.childViews,o(),l()):null;return n.rect={get:u},r.rect={get:u},e.forEach(c=>{t[c]=typeof i[c]>"u"?Tl[c]:i[c]}),{write:()=>{if(wl(a,t))return yl(s.element,t),Object.assign(a,{...t}),!0},destroy:()=>{}}},wl=(e,t)=>{if(Object.keys(e).length!==Object.keys(t).length)return!0;for(const n in t)if(t[n]!==e[n])return!0;return!1},yl=(e,{opacity:t,perspective:n,translateX:r,translateY:s,scaleX:i,scaleY:a,rotateX:o,rotateY:l,rotateZ:u,originX:c,originY:f,width:E,height:h})=>{let p="",g="";(me(c)||me(f))&&(g+=`transform-origin: ${c||0}px ${f||0}px;`),me(n)&&(p+=`perspective(${n}px) `),(me(r)||me(s))&&(p+=`translate3d(${r||0}px, ${s||0}px, 0) `),(me(i)||me(a))&&(p+=`scale3d(${me(i)?i:1}, ${me(a)?a:1}, 1) `),me(u)&&(p+=`rotateZ(${u}rad) `),me(o)&&(p+=`rotateX(${o}rad) `),me(l)&&(p+=`rotateY(${l}rad) `),p.length&&(g+=`transform:${p};`),me(t)&&(g+=`opacity:${t};`,t===0&&(g+="visibility:hidden;"),t<1&&(g+="pointer-events:none;")),me(h)&&(g+=`height:${h}px;`),me(E)&&(g+=`width:${E}px;`);const R=e.elementCurrentStyle||"";(g.length!==R.length||g!==R)&&(e.style.cssText=g,e.elementCurrentStyle=g)},Sl={styles:Rl,listeners:Il,animations:El,apis:_l},yr=(e={},t={},n={})=>(t.layoutCalculated||(e.paddingTop=parseInt(n.paddingTop,10)||0,e.marginTop=parseInt(n.marginTop,10)||0,e.marginRight=parseInt(n.marginRight,10)||0,e.marginBottom=parseInt(n.marginBottom,10)||0,e.marginLeft=parseInt(n.marginLeft,10)||0,t.layoutCalculated=!0),e.left=t.offsetLeft||0,e.top=t.offsetTop||0,e.width=t.offsetWidth||0,e.height=t.offsetHeight||0,e.right=e.left+e.width,e.bottom=e.top+e.height,e.scrollTop=t.scrollTop,e.hidden=t.offsetParent===null,e),ie=({tag:e="div",name:t=null,attributes:n={},read:r=()=>{},write:s=()=>{},create:i=()=>{},destroy:a=()=>{},filterFrameActionsForChild:o=(h,p)=>p,didCreateView:l=()=>{},didWriteView:u=()=>{},ignoreRect:c=!1,ignoreRectUpdate:f=!1,mixins:E=[]}={})=>(h,p={})=>{const g=qt(e,`filepond--${t}`,n),R=window.getComputedStyle(g,null),_=yr();let m=null,I=!1;const T=[],S=[],b={},O={},w=[s],v=[r],G=[a],M=()=>g,N=()=>T.concat(),C=()=>b,x=k=>(Z,fe)=>Z(k,fe),U=()=>m||(m=Ys(_,T,[0,0],[1,1]),m),y=()=>R,D=()=>{m=null,T.forEach(fe=>fe._read()),!(f&&_.width&&_.height)&&yr(_,g,R);const Z={root:le,props:p,rect:_};v.forEach(fe=>fe(Z))},P=(k,Z,fe)=>{let ye=Z.length===0;return w.forEach(re=>{re({props:p,root:le,actions:Z,timestamp:k,shouldOptimize:fe})===!1&&(ye=!1)}),S.forEach(re=>{re.write(k)===!1&&(ye=!1)}),T.filter(re=>!!re.element.parentNode).forEach(re=>{re._write(k,o(re,Z),fe)||(ye=!1)}),T.forEach((re,Ie)=>{re.element.parentNode||(le.appendChild(re.element,Ie),re._read(),re._write(k,o(re,Z),fe),ye=!1)}),I=ye,u({props:p,root:le,actions:Z,timestamp:k}),ye},F=()=>{S.forEach(k=>k.destroy()),G.forEach(k=>{k({root:le,props:p})}),T.forEach(k=>k._destroy())},W={element:{get:M},style:{get:y},childViews:{get:N}},B={...W,rect:{get:U},ref:{get:C},is:k=>t===k,appendChild:sl(g),createChildView:x(h),linkView:k=>(T.push(k),k),unlinkView:k=>{T.splice(T.indexOf(k),1)},appendChildView:il(g,T),removeChildView:al(g,T),registerWriter:k=>w.push(k),registerReader:k=>v.push(k),registerDestroyer:k=>G.push(k),invalidateLayout:()=>g.layoutCalculated=!1,dispatch:h.dispatch,query:h.query},ve={element:{get:M},childViews:{get:N},rect:{get:U},resting:{get:()=>I},isRectIgnored:()=>c,_read:D,_write:P,_destroy:F},ge={...W,rect:{get:()=>_}};Object.keys(E).sort((k,Z)=>k==="styles"?1:Z==="styles"?-1:0).forEach(k=>{const Z=Sl[k]({mixinConfig:E[k],viewProps:p,viewState:O,viewInternalAPI:B,viewExternalAPI:ve,view:$e(ge)});Z&&S.push(Z)});const le=$e(B);i({root:le,props:p});const Ue=cl(g);return T.forEach((k,Z)=>{le.appendChild(k.element,Ue+Z)}),l(le),$e(ve)},vl=(e,t,n=60)=>{const r="__framePainter";if(window[r]){window[r].readers.push(e),window[r].writers.push(t);return}window[r]={readers:[e],writers:[t]};const s=window[r],i=1e3/n;let a=null,o=null,l=null,u=null;const c=()=>{document.hidden?(l=()=>window.setTimeout(()=>f(performance.now()),i),u=()=>window.clearTimeout(o)):(l=()=>window.requestAnimationFrame(f),u=()=>window.cancelAnimationFrame(o))};document.addEventListener("visibilitychange",()=>{u&&u(),c(),f(performance.now())});const f=E=>{o=l(f),a||(a=E);const h=E-a;h<=i||(a=E-h%i,s.readers.forEach(p=>p()),s.writers.forEach(p=>p(E)))};return c(),f(performance.now()),{pause:()=>{u(o)}}},he=(e,t)=>({root:n,props:r,actions:s=[],timestamp:i,shouldOptimize:a})=>{s.filter(o=>e[o.type]).forEach(o=>e[o.type]({root:n,props:r,action:o.data,timestamp:i,shouldOptimize:a})),t&&t({root:n,props:r,actions:s,timestamp:i,shouldOptimize:a})},Sr=(e,t)=>t.parentNode.insertBefore(e,t),vr=(e,t)=>t.parentNode.insertBefore(e,t.nextSibling),Jt=e=>Array.isArray(e),Be=e=>e==null,Al=e=>e.trim(),en=e=>""+e,Dl=(e,t=",")=>Be(e)?[]:Jt(e)?e:en(e).split(t).map(Al).filter(n=>n.length),qs=e=>typeof e=="boolean",Xs=e=>qs(e)?e:e==="true",Ee=e=>typeof e=="string",Qs=e=>qe(e)?e:Ee(e)?en(e).replace(/[a-z]+/gi,""):0,kt=e=>parseInt(Qs(e),10),Ar=e=>parseFloat(Qs(e)),dt=e=>qe(e)&&isFinite(e)&&Math.floor(e)===e,Dr=(e,t=1e3)=>{if(dt(e))return e;let n=en(e).trim();return/MB$/i.test(n)?(n=n.replace(/MB$i/,"").trim(),kt(n)*t*t):/KB/i.test(n)?(n=n.replace(/KB$i/,"").trim(),kt(n)*t):kt(n)},Xe=e=>typeof e=="function",Ol=e=>{let t=self,n=e.split("."),r=null;for(;r=n.shift();)if(t=t[r],!t)return null;return t},Or={process:"POST",patch:"PATCH",revert:"DELETE",fetch:"GET",restore:"GET",load:"GET"},xl=e=>{const t={};return t.url=Ee(e)?e:e.url||"",t.timeout=e.timeout?parseInt(e.timeout,10):0,t.headers=e.headers?e.headers:{},J(Or,n=>{t[n]=bl(n,e[n],Or[n],t.timeout,t.headers)}),t.process=e.process||Ee(e)||e.url?t.process:null,t.remove=e.remove||null,delete t.headers,t},bl=(e,t,n,r,s)=>{if(t===null)return null;if(typeof t=="function")return t;const i={url:n==="GET"||n==="PATCH"?`?${e}=`:"",method:n,headers:s,withCredentials:!1,timeout:r,onload:null,ondata:null,onerror:null};if(Ee(t))return i.url=t,i;if(Object.assign(i,t),Ee(i.headers)){const a=i.headers.split(/:(.+)/);i.headers={header:a[0],value:a[1]}}return i.withCredentials=Xs(i.withCredentials),i},Ml=e=>xl(e),Cl=e=>e===null,de=e=>typeof e=="object"&&e!==null,Nl=e=>de(e)&&Ee(e.url)&&de(e.process)&&de(e.revert)&&de(e.restore)&&de(e.fetch),Dn=e=>Jt(e)?"array":Cl(e)?"null":dt(e)?"int":/^[0-9]+ ?(?:GB|MB|KB)$/gi.test(e)?"bytes":Nl(e)?"api":typeof e,Pl=e=>e.replace(/{\s*'/g,'{"').replace(/'\s*}/g,'"}').replace(/'\s*:/g,'":').replace(/:\s*'/g,':"').replace(/,\s*'/g,',"').replace(/'\s*,/g,'",'),Ll={array:Dl,boolean:Xs,int:e=>Dn(e)==="bytes"?Dr(e):kt(e),number:Ar,float:Ar,bytes:Dr,string:e=>Xe(e)?e:en(e),function:e=>Ol(e),serverapi:Ml,object:e=>{try{return JSON.parse(Pl(e))}catch{return null}}},Gl=(e,t)=>Ll[t](e),Zs=(e,t,n)=>{if(e===t)return e;let r=Dn(e);if(r!==n){const s=Gl(e,n);if(r=Dn(s),s===null)throw`Trying to assign value with incorrect type to "${option}", allowed type: "${n}"`;e=s}return e},Fl=(e,t)=>{let n=e;return{enumerable:!0,get:()=>n,set:r=>{n=Zs(r,e,t)}}},Ul=e=>{const t={};return J(e,n=>{const r=e[n];t[n]=Fl(r[0],r[1])}),$e(t)},Bl=e=>({items:[],listUpdateTimeout:null,itemUpdateTimeout:null,processingQueue:[],options:Ul(e)}),tn=(e,t="-")=>e.split(/(?=[A-Z])/).map(n=>n.toLowerCase()).join(t),jl=(e,t)=>{const n={};return J(t,r=>{n[r]={get:()=>e.getState().options[r],set:s=>{e.dispatch(`SET_${tn(r,"_").toUpperCase()}`,{value:s})}}}),n},Vl=e=>(t,n,r)=>{const s={};return J(e,i=>{const a=tn(i,"_").toUpperCase();s[`SET_${a}`]=o=>{try{r.options[i]=o.value}catch{}t(`DID_SET_${a}`,{value:r.options[i]})}}),s},Hl=e=>t=>{const n={};return J(e,r=>{n[`GET_${tn(r,"_").toUpperCase()}`]=s=>t.options[r]}),n},xe={API:1,DROP:2,BROWSE:3,PASTE:4,NONE:5},Wn=()=>Math.random().toString(36).substring(2,11),zn=(e,t)=>e.splice(t,1),kl=(e,t)=>{t?e():document.hidden?Promise.resolve(1).then(e):setTimeout(e,0)},nn=()=>{const e=[],t=(r,s)=>{zn(e,e.findIndex(i=>i.event===r&&(i.cb===s||!s)))},n=(r,s,i)=>{e.filter(a=>a.event===r).map(a=>a.cb).forEach(a=>kl(()=>a(...s),i))};return{fireSync:(r,...s)=>{n(r,s,!0)},fire:(r,...s)=>{n(r,s,!1)},on:(r,s)=>{e.push({event:r,cb:s})},onOnce:(r,s)=>{e.push({event:r,cb:(...i)=>{t(r,s),s(...i)}})},off:t}},Ks=(e,t,n)=>{Object.getOwnPropertyNames(e).filter(r=>!n.includes(r)).forEach(r=>Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r)))},$l=["fire","process","revert","load","on","off","onOnce","retryLoad","extend","archive","archived","release","released","requestProcessing","freeze"],Re=e=>{const t={};return Ks(e,t,$l),t},Wl=e=>{e.forEach((t,n)=>{t.released&&zn(e,n)})},V={INIT:1,IDLE:2,PROCESSING_QUEUED:9,PROCESSING:3,PROCESSING_COMPLETE:5,PROCESSING_ERROR:6,PROCESSING_REVERT_ERROR:10,LOADING:7,LOAD_ERROR:8},ce={INPUT:1,LIMBO:2,LOCAL:3},Js=e=>/[^0-9]+/.exec(e),ei=()=>Js(1.1.toLocaleString())[0],zl=()=>{const e=ei(),t=1e3.toLocaleString();return t!=="1000"?Js(t)[0]:e==="."?",":"."},A={BOOLEAN:"boolean",INT:"int",NUMBER:"number",STRING:"string",ARRAY:"array",OBJECT:"object",FUNCTION:"function",ACTION:"action",SERVER_API:"serverapi",REGEX:"regex"},Yn=[],Me=(e,t,n)=>new Promise((r,s)=>{const i=Yn.filter(o=>o.key===e).map(o=>o.cb);if(i.length===0){r(t);return}const a=i.shift();i.reduce((o,l)=>o.then(u=>l(u,n)),a(t,n)).then(o=>r(o)).catch(o=>s(o))}),tt=(e,t,n)=>Yn.filter(r=>r.key===e).map(r=>r.cb(t,n)),Yl=(e,t)=>Yn.push({key:e,cb:t}),ql=e=>Object.assign(it,e),Xt=()=>({...it}),Xl=e=>{J(e,(t,n)=>{it[t]&&(it[t][0]=Zs(n,it[t][0],it[t][1]))})},it={id:[null,A.STRING],name:["filepond",A.STRING],disabled:[!1,A.BOOLEAN],className:[null,A.STRING],required:[!1,A.BOOLEAN],captureMethod:[null,A.STRING],allowSyncAcceptAttribute:[!0,A.BOOLEAN],allowDrop:[!0,A.BOOLEAN],allowBrowse:[!0,A.BOOLEAN],allowPaste:[!0,A.BOOLEAN],allowMultiple:[!1,A.BOOLEAN],allowReplace:[!0,A.BOOLEAN],allowRevert:[!0,A.BOOLEAN],allowRemove:[!0,A.BOOLEAN],allowProcess:[!0,A.BOOLEAN],allowReorder:[!1,A.BOOLEAN],allowDirectoriesOnly:[!1,A.BOOLEAN],storeAsFile:[!1,A.BOOLEAN],forceRevert:[!1,A.BOOLEAN],maxFiles:[null,A.INT],checkValidity:[!1,A.BOOLEAN],itemInsertLocationFreedom:[!0,A.BOOLEAN],itemInsertLocation:["before",A.STRING],itemInsertInterval:[75,A.INT],dropOnPage:[!1,A.BOOLEAN],dropOnElement:[!0,A.BOOLEAN],dropValidation:[!1,A.BOOLEAN],ignoredFiles:[[".ds_store","thumbs.db","desktop.ini"],A.ARRAY],instantUpload:[!0,A.BOOLEAN],maxParallelUploads:[2,A.INT],allowMinimumUploadDuration:[!0,A.BOOLEAN],chunkUploads:[!1,A.BOOLEAN],chunkForce:[!1,A.BOOLEAN],chunkSize:[5e6,A.INT],chunkRetryDelays:[[500,1e3,3e3],A.ARRAY],server:[null,A.SERVER_API],fileSizeBase:[1e3,A.INT],labelFileSizeBytes:["bytes",A.STRING],labelFileSizeKilobytes:["KB",A.STRING],labelFileSizeMegabytes:["MB",A.STRING],labelFileSizeGigabytes:["GB",A.STRING],labelDecimalSeparator:[ei(),A.STRING],labelThousandsSeparator:[zl(),A.STRING],labelIdle:['Drag & Drop your files or <span class="filepond--label-action">Browse</span>',A.STRING],labelInvalidField:["Field contains invalid files",A.STRING],labelFileWaitingForSize:["Waiting for size",A.STRING],labelFileSizeNotAvailable:["Size not available",A.STRING],labelFileCountSingular:["file in list",A.STRING],labelFileCountPlural:["files in list",A.STRING],labelFileLoading:["Loading",A.STRING],labelFileAdded:["Added",A.STRING],labelFileLoadError:["Error during load",A.STRING],labelFileRemoved:["Removed",A.STRING],labelFileRemoveError:["Error during remove",A.STRING],labelFileProcessing:["Uploading",A.STRING],labelFileProcessingComplete:["Upload complete",A.STRING],labelFileProcessingAborted:["Upload cancelled",A.STRING],labelFileProcessingError:["Error during upload",A.STRING],labelFileProcessingRevertError:["Error during revert",A.STRING],labelTapToCancel:["tap to cancel",A.STRING],labelTapToRetry:["tap to retry",A.STRING],labelTapToUndo:["tap to undo",A.STRING],labelButtonRemoveItem:["Remove",A.STRING],labelButtonAbortItemLoad:["Abort",A.STRING],labelButtonRetryItemLoad:["Retry",A.STRING],labelButtonAbortItemProcessing:["Cancel",A.STRING],labelButtonUndoItemProcessing:["Undo",A.STRING],labelButtonRetryItemProcessing:["Retry",A.STRING],labelButtonProcessItem:["Upload",A.STRING],iconRemove:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M11.586 13l-2.293 2.293a1 1 0 0 0 1.414 1.414L13 14.414l2.293 2.293a1 1 0 0 0 1.414-1.414L14.414 13l2.293-2.293a1 1 0 0 0-1.414-1.414L13 11.586l-2.293-2.293a1 1 0 0 0-1.414 1.414L11.586 13z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],iconProcess:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M14 10.414v3.585a1 1 0 0 1-2 0v-3.585l-1.293 1.293a1 1 0 0 1-1.414-1.415l3-3a1 1 0 0 1 1.414 0l3 3a1 1 0 0 1-1.414 1.415L14 10.414zM9 18a1 1 0 0 1 0-2h8a1 1 0 0 1 0 2H9z" fill="currentColor" fill-rule="evenodd"/></svg>',A.STRING],iconRetry:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M10.81 9.185l-.038.02A4.997 4.997 0 0 0 8 13.683a5 5 0 0 0 5 5 5 5 0 0 0 5-5 1 1 0 0 1 2 0A7 7 0 1 1 9.722 7.496l-.842-.21a.999.999 0 1 1 .484-1.94l3.23.806c.535.133.86.675.73 1.21l-.804 3.233a.997.997 0 0 1-1.21.73.997.997 0 0 1-.73-1.21l.23-.928v-.002z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],iconUndo:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M9.185 10.81l.02-.038A4.997 4.997 0 0 1 13.683 8a5 5 0 0 1 5 5 5 5 0 0 1-5 5 1 1 0 0 0 0 2A7 7 0 1 0 7.496 9.722l-.21-.842a.999.999 0 1 0-1.94.484l.806 3.23c.133.535.675.86 1.21.73l3.233-.803a.997.997 0 0 0 .73-1.21.997.997 0 0 0-1.21-.73l-.928.23-.002-.001z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],iconDone:['<svg width="26" height="26" viewBox="0 0 26 26" xmlns="http://www.w3.org/2000/svg"><path d="M18.293 9.293a1 1 0 0 1 1.414 1.414l-7.002 7a1 1 0 0 1-1.414 0l-3.998-4a1 1 0 1 1 1.414-1.414L12 15.586l6.294-6.293z" fill="currentColor" fill-rule="nonzero"/></svg>',A.STRING],oninit:[null,A.FUNCTION],onwarning:[null,A.FUNCTION],onerror:[null,A.FUNCTION],onactivatefile:[null,A.FUNCTION],oninitfile:[null,A.FUNCTION],onaddfilestart:[null,A.FUNCTION],onaddfileprogress:[null,A.FUNCTION],onaddfile:[null,A.FUNCTION],onprocessfilestart:[null,A.FUNCTION],onprocessfileprogress:[null,A.FUNCTION],onprocessfileabort:[null,A.FUNCTION],onprocessfilerevert:[null,A.FUNCTION],onprocessfile:[null,A.FUNCTION],onprocessfiles:[null,A.FUNCTION],onremovefile:[null,A.FUNCTION],onpreparefile:[null,A.FUNCTION],onupdatefiles:[null,A.FUNCTION],onreorderfiles:[null,A.FUNCTION],beforeDropFile:[null,A.FUNCTION],beforeAddFile:[null,A.FUNCTION],beforeRemoveFile:[null,A.FUNCTION],beforePrepareFile:[null,A.FUNCTION],stylePanelLayout:[null,A.STRING],stylePanelAspectRatio:[null,A.STRING],styleItemPanelAspectRatio:[null,A.STRING],styleButtonRemoveItemPosition:["left",A.STRING],styleButtonProcessItemPosition:["right",A.STRING],styleLoadIndicatorPosition:["right",A.STRING],styleProgressIndicatorPosition:["right",A.STRING],styleButtonRemoveItemAlign:[!1,A.BOOLEAN],files:[[],A.ARRAY],credits:[["https://pqina.nl/","Powered by PQINA"],A.ARRAY]},Qe=(e,t)=>Be(t)?e[0]||null:dt(t)?e[t]||null:(typeof t=="object"&&(t=t.id),e.find(n=>n.id===t)||null),ti=e=>{if(Be(e))return e;if(/:/.test(e)){const t=e.split(":");return t[1]/t[0]}return parseFloat(e)},Ce=e=>e.filter(t=>!t.archived),Ql={EMPTY:0,IDLE:1,ERROR:2,BUSY:3,READY:4};let Pt=null;const Zl=()=>{if(Pt===null)try{const e=new DataTransfer;e.items.add(new File(["hello world"],"This_Works.txt"));const t=document.createElement("input");t.setAttribute("type","file"),t.files=e.files,Pt=t.files.length===1}catch{Pt=!1}return Pt},Kl=[V.LOAD_ERROR,V.PROCESSING_ERROR,V.PROCESSING_REVERT_ERROR],Jl=[V.LOADING,V.PROCESSING,V.PROCESSING_QUEUED,V.INIT],ec=[V.PROCESSING_COMPLETE],tc=e=>Kl.includes(e.status),nc=e=>Jl.includes(e.status),rc=e=>ec.includes(e.status),xr=e=>de(e.options.server)&&(de(e.options.server.process)||Xe(e.options.server.process)),sc=e=>({GET_STATUS:()=>{const t=Ce(e.items),{EMPTY:n,ERROR:r,BUSY:s,IDLE:i,READY:a}=Ql;return t.length===0?n:t.some(tc)?r:t.some(nc)?s:t.some(rc)?a:i},GET_ITEM:t=>Qe(e.items,t),GET_ACTIVE_ITEM:t=>Qe(Ce(e.items),t),GET_ACTIVE_ITEMS:()=>Ce(e.items),GET_ITEMS:()=>e.items,GET_ITEM_NAME:t=>{const n=Qe(e.items,t);return n?n.filename:null},GET_ITEM_SIZE:t=>{const n=Qe(e.items,t);return n?n.fileSize:null},GET_STYLES:()=>Object.keys(e.options).filter(t=>/^style/.test(t)).map(t=>({name:t,value:e.options[t]})),GET_PANEL_ASPECT_RATIO:()=>/circle/.test(e.options.stylePanelLayout)?1:ti(e.options.stylePanelAspectRatio),GET_ITEM_PANEL_ASPECT_RATIO:()=>e.options.styleItemPanelAspectRatio,GET_ITEMS_BY_STATUS:t=>Ce(e.items).filter(n=>n.status===t),GET_TOTAL_ITEMS:()=>Ce(e.items).length,SHOULD_UPDATE_FILE_INPUT:()=>e.options.storeAsFile&&Zl()&&!xr(e),IS_ASYNC:()=>xr(e),GET_FILE_SIZE_LABELS:t=>({labelBytes:t("GET_LABEL_FILE_SIZE_BYTES")||void 0,labelKilobytes:t("GET_LABEL_FILE_SIZE_KILOBYTES")||void 0,labelMegabytes:t("GET_LABEL_FILE_SIZE_MEGABYTES")||void 0,labelGigabytes:t("GET_LABEL_FILE_SIZE_GIGABYTES")||void 0})}),ic=e=>{const t=Ce(e.items).length;if(!e.options.allowMultiple)return t===0;const n=e.options.maxFiles;return n===null||t<n},ni=(e,t,n)=>Math.max(Math.min(n,e),t),ac=(e,t,n)=>e.splice(t,0,n),oc=(e,t,n)=>Be(t)?null:typeof n>"u"?(e.push(t),t):(n=ni(n,0,e.length),ac(e,n,t),t),On=e=>/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*)\s*$/i.test(e),Dt=e=>`${e}`.split("/").pop().split("?").shift(),rn=e=>e.split(".").pop(),lc=e=>{if(typeof e!="string")return"";const t=e.split("/").pop();return/svg/.test(t)?"svg":/zip|compressed/.test(t)?"zip":/plain/.test(t)?"txt":/msword/.test(t)?"doc":/[a-z]+/.test(t)?t==="jpeg"?"jpg":t:""},_t=(e,t="")=>(t+e).slice(-t.length),ri=(e=new Date)=>`${e.getFullYear()}-${_t(e.getMonth()+1,"00")}-${_t(e.getDate(),"00")}_${_t(e.getHours(),"00")}-${_t(e.getMinutes(),"00")}-${_t(e.getSeconds(),"00")}`,ct=(e,t,n=null,r=null)=>{const s=typeof n=="string"?e.slice(0,e.size,n):e.slice(0,e.size,e.type);return s.lastModifiedDate=new Date,e._relativePath&&(s._relativePath=e._relativePath),Ee(t)||(t=ri()),t&&r===null&&rn(t)?s.name=t:(r=r||lc(s.type),s.name=t+(r?"."+r:"")),s},cc=()=>window.BlobBuilder=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,si=(e,t)=>{const n=cc();if(n){const r=new n;return r.append(e),r.getBlob(t)}return new Blob([e],{type:t})},dc=(e,t)=>{const n=new ArrayBuffer(e.length),r=new Uint8Array(n);for(let s=0;s<e.length;s++)r[s]=e.charCodeAt(s);return si(n,t)},ii=e=>(/^data:(.+);/.exec(e)||[])[1]||null,uc=e=>e.split(",")[1].replace(/\s/g,""),fc=e=>atob(uc(e)),pc=e=>{const t=ii(e),n=fc(e);return dc(n,t)},mc=(e,t,n)=>ct(pc(e),t,null,n),Ec=e=>{if(!/^content-disposition:/i.test(e))return null;const t=e.split(/filename=|filename\*=.+''/).splice(1).map(n=>n.trim().replace(/^["']|[;"']{0,2}$/g,"")).filter(n=>n.length);return t.length?decodeURI(t[t.length-1]):null},hc=e=>{if(/content-length:/i.test(e)){const t=e.match(/[0-9]+/)[0];return t?parseInt(t,10):null}return null},gc=e=>/x-content-transfer-id:/i.test(e)&&(e.split(":")[1]||"").trim()||null,qn=e=>{const t={source:null,name:null,size:null},n=e.split(`
`);for(let r of n){const s=Ec(r);if(s){t.name=s;continue}const i=hc(r);if(i){t.size=i;continue}const a=gc(r);if(a){t.source=a;continue}}return t},Ic=e=>{const t={source:null,complete:!1,progress:0,size:null,timestamp:null,duration:0,request:null},n=()=>t.progress,r=()=>{t.request&&t.request.abort&&t.request.abort()},s=()=>{const o=t.source;a.fire("init",o),o instanceof File?a.fire("load",o):o instanceof Blob?a.fire("load",ct(o,o.name)):On(o)?a.fire("load",mc(o)):i(o)},i=o=>{if(!e){a.fire("error",{type:"error",body:"Can't load URL",code:400});return}t.timestamp=Date.now(),t.request=e(o,l=>{t.duration=Date.now()-t.timestamp,t.complete=!0,l instanceof Blob&&(l=ct(l,l.name||Dt(o))),a.fire("load",l instanceof Blob?l:l?l.body:null)},l=>{a.fire("error",typeof l=="string"?{type:"error",code:0,body:l}:l)},(l,u,c)=>{if(c&&(t.size=c),t.duration=Date.now()-t.timestamp,!l){t.progress=null;return}t.progress=u/c,a.fire("progress",t.progress)},()=>{a.fire("abort")},l=>{const u=qn(typeof l=="string"?l:l.headers);a.fire("meta",{size:t.size||u.size,filename:u.name,source:u.source})})},a={...nn(),setSource:o=>t.source=o,getProgress:n,abort:r,load:s};return a},br=e=>/GET|HEAD/.test(e),Ze=(e,t,n)=>{const r={onheaders:()=>{},onprogress:()=>{},onload:()=>{},ontimeout:()=>{},onerror:()=>{},onabort:()=>{},abort:()=>{s=!0,a.abort()}};let s=!1,i=!1;n={method:"POST",headers:{},withCredentials:!1,...n},t=encodeURI(t),br(n.method)&&e&&(t=`${t}${encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))}`);const a=new XMLHttpRequest,o=br(n.method)?a:a.upload;return o.onprogress=l=>{s||r.onprogress(l.lengthComputable,l.loaded,l.total)},a.onreadystatechange=()=>{a.readyState<2||a.readyState===4&&a.status===0||i||(i=!0,r.onheaders(a))},a.onload=()=>{a.status>=200&&a.status<300?r.onload(a):r.onerror(a)},a.onerror=()=>r.onerror(a),a.onabort=()=>{s=!0,r.onabort()},a.ontimeout=()=>r.ontimeout(a),a.open(n.method,t,!0),dt(n.timeout)&&(a.timeout=n.timeout),Object.keys(n.headers).forEach(l=>{const u=unescape(encodeURIComponent(n.headers[l]));a.setRequestHeader(l,u)}),n.responseType&&(a.responseType=n.responseType),n.withCredentials&&(a.withCredentials=!0),a.send(e),r},te=(e,t,n,r)=>({type:e,code:t,body:n,headers:r}),Ke=e=>t=>{e(te("error",0,"Timeout",t.getAllResponseHeaders()))},Mr=e=>/\?/.test(e),wt=(...e)=>{let t="";return e.forEach(n=>{t+=Mr(t)&&Mr(n)?n.replace(/\?/,"&"):n}),t},un=(e="",t)=>{if(typeof t=="function")return t;if(!t||!Ee(t.url))return null;const n=t.onload||(s=>s),r=t.onerror||(s=>null);return(s,i,a,o,l,u)=>{const c=Ze(s,wt(e,t.url),{...t,responseType:"blob"});return c.onload=f=>{const E=f.getAllResponseHeaders(),h=qn(E).name||Dt(s);i(te("load",f.status,t.method==="HEAD"?null:ct(n(f.response),h),E))},c.onerror=f=>{a(te("error",f.status,r(f.response)||f.statusText,f.getAllResponseHeaders()))},c.onheaders=f=>{u(te("headers",f.status,null,f.getAllResponseHeaders()))},c.ontimeout=Ke(a),c.onprogress=o,c.onabort=l,c}},Ae={QUEUED:0,COMPLETE:1,PROCESSING:2,ERROR:3,WAITING:4},_c=(e,t,n,r,s,i,a,o,l,u,c)=>{const f=[],{chunkTransferId:E,chunkServer:h,chunkSize:p,chunkRetryDelays:g}=c,R={serverId:E,aborted:!1},_=t.ondata||(x=>x),m=t.onload||((x,U)=>U==="HEAD"?x.getResponseHeader("Upload-Offset"):x.response),I=t.onerror||(x=>null),T=x=>{const U=new FormData;de(s)&&U.append(n,JSON.stringify(s));const y=typeof t.headers=="function"?t.headers(r,s):{...t.headers,"Upload-Length":r.size},D={...t,headers:y},P=Ze(_(U),wt(e,t.url),D);P.onload=F=>x(m(F,D.method)),P.onerror=F=>a(te("error",F.status,I(F.response)||F.statusText,F.getAllResponseHeaders())),P.ontimeout=Ke(a)},S=x=>{const U=wt(e,h.url,R.serverId),D={headers:typeof t.headers=="function"?t.headers(R.serverId):{...t.headers},method:"HEAD"},P=Ze(null,U,D);P.onload=F=>x(m(F,D.method)),P.onerror=F=>a(te("error",F.status,I(F.response)||F.statusText,F.getAllResponseHeaders())),P.ontimeout=Ke(a)},b=Math.floor(r.size/p);for(let x=0;x<=b;x++){const U=x*p,y=r.slice(U,U+p,"application/offset+octet-stream");f[x]={index:x,size:y.size,offset:U,data:y,file:r,progress:0,retries:[...g],status:Ae.QUEUED,error:null,request:null,timeout:null}}const O=()=>i(R.serverId),w=x=>x.status===Ae.QUEUED||x.status===Ae.ERROR,v=x=>{if(R.aborted)return;if(x=x||f.find(w),!x){f.every(B=>B.status===Ae.COMPLETE)&&O();return}x.status=Ae.PROCESSING,x.progress=null;const U=h.ondata||(B=>B),y=h.onerror||(B=>null),D=h.onload||(()=>{}),P=wt(e,h.url,R.serverId),F=typeof h.headers=="function"?h.headers(x):{...h.headers,"Content-Type":"application/offset+octet-stream","Upload-Offset":x.offset,"Upload-Length":r.size,"Upload-Name":r.name},W=x.request=Ze(U(x.data),P,{...h,headers:F});W.onload=B=>{D(B,x.index,f.length),x.status=Ae.COMPLETE,x.request=null,N()},W.onprogress=(B,ve,ge)=>{x.progress=B?ve:null,M()},W.onerror=B=>{x.status=Ae.ERROR,x.request=null,x.error=y(B.response)||B.statusText,G(x)||a(te("error",B.status,y(B.response)||B.statusText,B.getAllResponseHeaders()))},W.ontimeout=B=>{x.status=Ae.ERROR,x.request=null,G(x)||Ke(a)(B)},W.onabort=()=>{x.status=Ae.QUEUED,x.request=null,l()}},G=x=>x.retries.length===0?!1:(x.status=Ae.WAITING,clearTimeout(x.timeout),x.timeout=setTimeout(()=>{v(x)},x.retries.shift()),!0),M=()=>{const x=f.reduce((y,D)=>y===null||D.progress===null?null:y+D.progress,0);if(x===null)return o(!1,0,0);const U=f.reduce((y,D)=>y+D.size,0);o(!0,x,U)},N=()=>{f.filter(U=>U.status===Ae.PROCESSING).length>=1||v()},C=()=>{f.forEach(x=>{clearTimeout(x.timeout),x.request&&x.request.abort()})};return R.serverId?S(x=>{R.aborted||(f.filter(U=>U.offset<x).forEach(U=>{U.status=Ae.COMPLETE,U.progress=U.size}),N())}):T(x=>{R.aborted||(u(x),R.serverId=x,N())}),{abort:()=>{R.aborted=!0,C()}}},Tc=(e,t,n,r)=>(s,i,a,o,l,u,c)=>{if(!s)return;const f=r.chunkUploads,E=f&&s.size>r.chunkSize,h=f&&(E||r.chunkForce);if(s instanceof Blob&&h)return _c(e,t,n,s,i,a,o,l,u,c,r);const p=t.ondata||(S=>S),g=t.onload||(S=>S),R=t.onerror||(S=>null),_=typeof t.headers=="function"?t.headers(s,i)||{}:{...t.headers},m={...t,headers:_};var I=new FormData;de(i)&&I.append(n,JSON.stringify(i)),(s instanceof Blob?[{name:null,file:s}]:s).forEach(S=>{I.append(n,S.file,S.name===null?S.file.name:`${S.name}${S.file.name}`)});const T=Ze(p(I),wt(e,t.url),m);return T.onload=S=>{a(te("load",S.status,g(S.response),S.getAllResponseHeaders()))},T.onerror=S=>{o(te("error",S.status,R(S.response)||S.statusText,S.getAllResponseHeaders()))},T.ontimeout=Ke(o),T.onprogress=l,T.onabort=u,T},Rc=(e="",t,n,r)=>typeof t=="function"?(...s)=>t(n,...s,r):!t||!Ee(t.url)?null:Tc(e,t,n,r),Tt=(e="",t)=>{if(typeof t=="function")return t;if(!t||!Ee(t.url))return(s,i)=>i();const n=t.onload||(s=>s),r=t.onerror||(s=>null);return(s,i,a)=>{const o=Ze(s,e+t.url,t);return o.onload=l=>{i(te("load",l.status,n(l.response),l.getAllResponseHeaders()))},o.onerror=l=>{a(te("error",l.status,r(l.response)||l.statusText,l.getAllResponseHeaders()))},o.ontimeout=Ke(a),o}},ai=(e=0,t=1)=>e+Math.random()*(t-e),wc=(e,t=1e3,n=0,r=25,s=250)=>{let i=null;const a=Date.now(),o=()=>{let l=Date.now()-a,u=ai(r,s);l+u>t&&(u=l+u-t);let c=l/t;if(c>=1||document.hidden){e(1);return}e(c),i=setTimeout(o,u)};return t>0&&o(),{clear:()=>{clearTimeout(i)}}},yc=(e,t)=>{const n={complete:!1,perceivedProgress:0,perceivedPerformanceUpdater:null,progress:null,timestamp:null,perceivedDuration:0,duration:0,request:null,response:null},{allowMinimumUploadDuration:r}=t,s=(c,f)=>{const E=()=>{n.duration===0||n.progress===null||u.fire("progress",u.getProgress())},h=()=>{n.complete=!0,u.fire("load-perceived",n.response.body)};u.fire("start"),n.timestamp=Date.now(),n.perceivedPerformanceUpdater=wc(p=>{n.perceivedProgress=p,n.perceivedDuration=Date.now()-n.timestamp,E(),n.response&&n.perceivedProgress===1&&!n.complete&&h()},r?ai(750,1500):0),n.request=e(c,f,p=>{n.response=de(p)?p:{type:"load",code:200,body:`${p}`,headers:{}},n.duration=Date.now()-n.timestamp,n.progress=1,u.fire("load",n.response.body),(!r||r&&n.perceivedProgress===1)&&h()},p=>{n.perceivedPerformanceUpdater.clear(),u.fire("error",de(p)?p:{type:"error",code:0,body:`${p}`})},(p,g,R)=>{n.duration=Date.now()-n.timestamp,n.progress=p?g/R:null,E()},()=>{n.perceivedPerformanceUpdater.clear(),u.fire("abort",n.response?n.response.body:null)},p=>{u.fire("transfer",p)})},i=()=>{n.request&&(n.perceivedPerformanceUpdater.clear(),n.request.abort&&n.request.abort(),n.complete=!0)},a=()=>{i(),n.complete=!1,n.perceivedProgress=0,n.progress=0,n.timestamp=null,n.perceivedDuration=0,n.duration=0,n.request=null,n.response=null},o=r?()=>n.progress?Math.min(n.progress,n.perceivedProgress):null:()=>n.progress||null,l=r?()=>Math.min(n.duration,n.perceivedDuration):()=>n.duration,u={...nn(),process:s,abort:i,getProgress:o,getDuration:l,reset:a};return u},oi=e=>e.substring(0,e.lastIndexOf("."))||e,Sc=e=>{let t=[e.name,e.size,e.type];return e instanceof Blob||On(e)?t[0]=e.name||ri():On(e)?(t[1]=e.length,t[2]=ii(e)):Ee(e)&&(t[0]=Dt(e),t[1]=0,t[2]="application/octet-stream"),{name:t[0],size:t[1],type:t[2]}},Je=e=>!!(e instanceof File||e instanceof Blob&&e.name),li=e=>{if(!de(e))return e;const t=Jt(e)?[]:{};for(const n in e){if(!e.hasOwnProperty(n))continue;const r=e[n];t[n]=r&&de(r)?li(r):r}return t},vc=(e=null,t=null,n=null)=>{const r=Wn(),s={archived:!1,frozen:!1,released:!1,source:null,file:n,serverFileReference:t,transferId:null,processingAborted:!1,status:t?V.PROCESSING_COMPLETE:V.INIT,activeLoader:null,activeProcessor:null};let i=null;const a={},o=w=>s.status=w,l=(w,...v)=>{s.released||s.frozen||b.fire(w,...v)},u=()=>rn(s.file.name),c=()=>s.file.type,f=()=>s.file.size,E=()=>s.file,h=(w,v,G)=>{if(s.source=w,b.fireSync("init"),s.file){b.fireSync("load-skip");return}s.file=Sc(w),v.on("init",()=>{l("load-init")}),v.on("meta",M=>{s.file.size=M.size,s.file.filename=M.filename,M.source&&(e=ce.LIMBO,s.serverFileReference=M.source,s.status=V.PROCESSING_COMPLETE),l("load-meta")}),v.on("progress",M=>{o(V.LOADING),l("load-progress",M)}),v.on("error",M=>{o(V.LOAD_ERROR),l("load-request-error",M)}),v.on("abort",()=>{o(V.INIT),l("load-abort")}),v.on("load",M=>{s.activeLoader=null;const N=x=>{s.file=Je(x)?x:s.file,e===ce.LIMBO&&s.serverFileReference?o(V.PROCESSING_COMPLETE):o(V.IDLE),l("load")},C=x=>{s.file=M,l("load-meta"),o(V.LOAD_ERROR),l("load-file-error",x)};if(s.serverFileReference){N(M);return}G(M,N,C)}),v.setSource(w),s.activeLoader=v,v.load()},p=()=>{s.activeLoader&&s.activeLoader.load()},g=()=>{if(s.activeLoader){s.activeLoader.abort();return}o(V.INIT),l("load-abort")},R=(w,v)=>{if(s.processingAborted){s.processingAborted=!1;return}if(o(V.PROCESSING),i=null,!(s.file instanceof Blob)){b.on("load",()=>{R(w,v)});return}w.on("load",N=>{s.transferId=null,s.serverFileReference=N}),w.on("transfer",N=>{s.transferId=N}),w.on("load-perceived",N=>{s.activeProcessor=null,s.transferId=null,s.serverFileReference=N,o(V.PROCESSING_COMPLETE),l("process-complete",N)}),w.on("start",()=>{l("process-start")}),w.on("error",N=>{s.activeProcessor=null,o(V.PROCESSING_ERROR),l("process-error",N)}),w.on("abort",N=>{s.activeProcessor=null,s.serverFileReference=N,o(V.IDLE),l("process-abort"),i&&i()}),w.on("progress",N=>{l("process-progress",N)});const G=N=>{s.archived||w.process(N,{...a})},M=console.error;v(s.file,G,M),s.activeProcessor=w},_=()=>{s.processingAborted=!1,o(V.PROCESSING_QUEUED)},m=()=>new Promise(w=>{if(!s.activeProcessor){s.processingAborted=!0,o(V.IDLE),l("process-abort"),w();return}i=()=>{w()},s.activeProcessor.abort()}),I=(w,v)=>new Promise((G,M)=>{const N=s.serverFileReference!==null?s.serverFileReference:s.transferId;if(N===null){G();return}w(N,()=>{s.serverFileReference=null,s.transferId=null,G()},C=>{if(!v){G();return}o(V.PROCESSING_REVERT_ERROR),l("process-revert-error"),M(C)}),o(V.IDLE),l("process-revert")}),T=(w,v,G)=>{const M=w.split("."),N=M[0],C=M.pop();let x=a;M.forEach(U=>x=x[U]),JSON.stringify(x[C])!==JSON.stringify(v)&&(x[C]=v,l("metadata-update",{key:N,value:a[N],silent:G}))},b={id:{get:()=>r},origin:{get:()=>e,set:w=>e=w},serverId:{get:()=>s.serverFileReference},transferId:{get:()=>s.transferId},status:{get:()=>s.status},filename:{get:()=>s.file.name},filenameWithoutExtension:{get:()=>oi(s.file.name)},fileExtension:{get:u},fileType:{get:c},fileSize:{get:f},file:{get:E},relativePath:{get:()=>s.file._relativePath},source:{get:()=>s.source},getMetadata:w=>li(w?a[w]:a),setMetadata:(w,v,G)=>{if(de(w)){const M=w;return Object.keys(M).forEach(N=>{T(N,M[N],v)}),w}return T(w,v,G),v},extend:(w,v)=>O[w]=v,abortLoad:g,retryLoad:p,requestProcessing:_,abortProcessing:m,load:h,process:R,revert:I,...nn(),freeze:()=>s.frozen=!0,release:()=>s.released=!0,released:{get:()=>s.released},archive:()=>s.archived=!0,archived:{get:()=>s.archived},setFile:w=>s.file=w},O=$e(b);return O},Ac=(e,t)=>Be(t)?0:Ee(t)?e.findIndex(n=>n.id===t):-1,Cr=(e,t)=>{const n=Ac(e,t);if(!(n<0))return e[n]||null},Nr=(e,t,n,r,s,i)=>{const a=Ze(null,e,{method:"GET",responseType:"blob"});return a.onload=o=>{const l=o.getAllResponseHeaders(),u=qn(l).name||Dt(e);t(te("load",o.status,ct(o.response,u),l))},a.onerror=o=>{n(te("error",o.status,o.statusText,o.getAllResponseHeaders()))},a.onheaders=o=>{i(te("headers",o.status,null,o.getAllResponseHeaders()))},a.ontimeout=Ke(n),a.onprogress=r,a.onabort=s,a},Pr=e=>(e.indexOf("//")===0&&(e=location.protocol+e),e.toLowerCase().replace("blob:","").replace(/([a-z])?:\/\//,"$1").split("/")[0]),Dc=e=>(e.indexOf(":")>-1||e.indexOf("//")>-1)&&Pr(location.href)!==Pr(e),Lt=e=>(...t)=>Xe(e)?e(...t):e,Oc=e=>!Je(e.file),fn=(e,t)=>{clearTimeout(t.listUpdateTimeout),t.listUpdateTimeout=setTimeout(()=>{e("DID_UPDATE_ITEMS",{items:Ce(t.items)})},0)},Lr=(e,...t)=>new Promise(n=>{if(!e)return n(!0);const r=e(...t);if(r==null)return n(!0);if(typeof r=="boolean")return n(r);typeof r.then=="function"&&r.then(n)}),pn=(e,t)=>{e.items.sort((n,r)=>t(Re(n),Re(r)))},De=(e,t)=>({query:n,success:r=()=>{},failure:s=()=>{},...i}={})=>{const a=Qe(e.items,n);if(!a){s({error:te("error",0,"Item not found"),file:null});return}t(a,r,s,i||{})},xc=(e,t,n)=>({ABORT_ALL:()=>{Ce(n.items).forEach(r=>{r.freeze(),r.abortLoad(),r.abortProcessing()})},DID_SET_FILES:({value:r=[]})=>{const s=r.map(a=>({source:a.source?a.source:a,options:a.options}));let i=Ce(n.items);i.forEach(a=>{s.find(o=>o.source===a.source||o.source===a.file)||e("REMOVE_ITEM",{query:a,remove:!1})}),i=Ce(n.items),s.forEach((a,o)=>{i.find(l=>l.source===a.source||l.file===a.source)||e("ADD_ITEM",{...a,interactionMethod:xe.NONE,index:o})})},DID_UPDATE_ITEM_METADATA:({id:r,action:s,change:i})=>{i.silent||(clearTimeout(n.itemUpdateTimeout),n.itemUpdateTimeout=setTimeout(()=>{const a=Cr(n.items,r);if(!t("IS_ASYNC")){Me("SHOULD_PREPARE_OUTPUT",!1,{item:a,query:t,action:s,change:i}).then(c=>{const f=t("GET_BEFORE_PREPARE_FILE");f&&(c=f(a,c)),c&&e("REQUEST_PREPARE_OUTPUT",{query:r,item:a,success:E=>{e("DID_PREPARE_OUTPUT",{id:r,file:E})}},!0)});return}a.origin===ce.LOCAL&&e("DID_LOAD_ITEM",{id:a.id,error:null,serverFileReference:a.source});const o=()=>{setTimeout(()=>{e("REQUEST_ITEM_PROCESSING",{query:r})},32)},l=c=>{a.revert(Tt(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(c?o:()=>{}).catch(()=>{})},u=c=>{a.abortProcessing().then(c?o:()=>{})};if(a.status===V.PROCESSING_COMPLETE)return l(n.options.instantUpload);if(a.status===V.PROCESSING)return u(n.options.instantUpload);n.options.instantUpload&&o()},0))},MOVE_ITEM:({query:r,index:s})=>{const i=Qe(n.items,r);if(!i)return;const a=n.items.indexOf(i);s=ni(s,0,n.items.length-1),a!==s&&n.items.splice(s,0,n.items.splice(a,1)[0])},SORT:({compare:r})=>{pn(n,r),e("DID_SORT_ITEMS",{items:t("GET_ACTIVE_ITEMS")})},ADD_ITEMS:({items:r,index:s,interactionMethod:i,success:a=()=>{},failure:o=()=>{}})=>{let l=s;if(s===-1||typeof s>"u"){const h=t("GET_ITEM_INSERT_LOCATION"),p=t("GET_TOTAL_ITEMS");l=h==="before"?0:p}const u=t("GET_IGNORED_FILES"),c=h=>Je(h)?!u.includes(h.name.toLowerCase()):!Be(h),E=r.filter(c).map(h=>new Promise((p,g)=>{e("ADD_ITEM",{interactionMethod:i,source:h.source||h,success:p,failure:g,index:l++,options:h.options||{}})}));Promise.all(E).then(a).catch(o)},ADD_ITEM:({source:r,index:s=-1,interactionMethod:i,success:a=()=>{},failure:o=()=>{},options:l={}})=>{if(Be(r)){o({error:te("error",0,"No source"),file:null});return}if(Je(r)&&n.options.ignoredFiles.includes(r.name.toLowerCase()))return;if(!ic(n)){if(n.options.allowMultiple||!n.options.allowMultiple&&!n.options.allowReplace){const m=te("warning",0,"Max files");e("DID_THROW_MAX_FILES",{source:r,error:m}),o({error:m,file:null});return}const _=Ce(n.items)[0];if(_.status===V.PROCESSING_COMPLETE||_.status===V.PROCESSING_REVERT_ERROR){const m=t("GET_FORCE_REVERT");if(_.revert(Tt(n.options.server.url,n.options.server.revert),m).then(()=>{m&&e("ADD_ITEM",{source:r,index:s,interactionMethod:i,success:a,failure:o,options:l})}).catch(()=>{}),m)return}e("REMOVE_ITEM",{query:_.id})}const u=l.type==="local"?ce.LOCAL:l.type==="limbo"?ce.LIMBO:ce.INPUT,c=vc(u,u===ce.INPUT?null:r,l.file);Object.keys(l.metadata||{}).forEach(_=>{c.setMetadata(_,l.metadata[_])}),tt("DID_CREATE_ITEM",c,{query:t,dispatch:e});const f=t("GET_ITEM_INSERT_LOCATION");n.options.itemInsertLocationFreedom||(s=f==="before"?-1:n.items.length),oc(n.items,c,s),Xe(f)&&r&&pn(n,f);const E=c.id;c.on("init",()=>{e("DID_INIT_ITEM",{id:E})}),c.on("load-init",()=>{e("DID_START_ITEM_LOAD",{id:E})}),c.on("load-meta",()=>{e("DID_UPDATE_ITEM_META",{id:E})}),c.on("load-progress",_=>{e("DID_UPDATE_ITEM_LOAD_PROGRESS",{id:E,progress:_})}),c.on("load-request-error",_=>{const m=Lt(n.options.labelFileLoadError)(_);if(_.code>=400&&_.code<500){e("DID_THROW_ITEM_INVALID",{id:E,error:_,status:{main:m,sub:`${_.code} (${_.body})`}}),o({error:_,file:Re(c)});return}e("DID_THROW_ITEM_LOAD_ERROR",{id:E,error:_,status:{main:m,sub:n.options.labelTapToRetry}})}),c.on("load-file-error",_=>{e("DID_THROW_ITEM_INVALID",{id:E,error:_.status,status:_.status}),o({error:_.status,file:Re(c)})}),c.on("load-abort",()=>{e("REMOVE_ITEM",{query:E})}),c.on("load-skip",()=>{c.on("metadata-update",_=>{Je(c.file)&&e("DID_UPDATE_ITEM_METADATA",{id:E,change:_})}),e("COMPLETE_LOAD_ITEM",{query:E,item:c,data:{source:r,success:a}})}),c.on("load",()=>{const _=m=>{if(!m){e("REMOVE_ITEM",{query:E});return}c.on("metadata-update",I=>{e("DID_UPDATE_ITEM_METADATA",{id:E,change:I})}),Me("SHOULD_PREPARE_OUTPUT",!1,{item:c,query:t}).then(I=>{const T=t("GET_BEFORE_PREPARE_FILE");T&&(I=T(c,I));const S=()=>{e("COMPLETE_LOAD_ITEM",{query:E,item:c,data:{source:r,success:a}}),fn(e,n)};if(I){e("REQUEST_PREPARE_OUTPUT",{query:E,item:c,success:b=>{e("DID_PREPARE_OUTPUT",{id:E,file:b}),S()}},!0);return}S()})};Me("DID_LOAD_ITEM",c,{query:t,dispatch:e}).then(()=>{Lr(t("GET_BEFORE_ADD_FILE"),Re(c)).then(_)}).catch(m=>{if(!m||!m.error||!m.status)return _(!1);e("DID_THROW_ITEM_INVALID",{id:E,error:m.error,status:m.status})})}),c.on("process-start",()=>{e("DID_START_ITEM_PROCESSING",{id:E})}),c.on("process-progress",_=>{e("DID_UPDATE_ITEM_PROCESS_PROGRESS",{id:E,progress:_})}),c.on("process-error",_=>{e("DID_THROW_ITEM_PROCESSING_ERROR",{id:E,error:_,status:{main:Lt(n.options.labelFileProcessingError)(_),sub:n.options.labelTapToRetry}})}),c.on("process-revert-error",_=>{e("DID_THROW_ITEM_PROCESSING_REVERT_ERROR",{id:E,error:_,status:{main:Lt(n.options.labelFileProcessingRevertError)(_),sub:n.options.labelTapToRetry}})}),c.on("process-complete",_=>{e("DID_COMPLETE_ITEM_PROCESSING",{id:E,error:null,serverFileReference:_}),e("DID_DEFINE_VALUE",{id:E,value:_})}),c.on("process-abort",()=>{e("DID_ABORT_ITEM_PROCESSING",{id:E})}),c.on("process-revert",()=>{e("DID_REVERT_ITEM_PROCESSING",{id:E}),e("DID_DEFINE_VALUE",{id:E,value:null})}),e("DID_ADD_ITEM",{id:E,index:s,interactionMethod:i}),fn(e,n);const{url:h,load:p,restore:g,fetch:R}=n.options.server||{};c.load(r,Ic(u===ce.INPUT?Ee(r)&&Dc(r)&&R?un(h,R):Nr:u===ce.LIMBO?un(h,g):un(h,p)),(_,m,I)=>{Me("LOAD_FILE",_,{query:t}).then(m).catch(I)})},REQUEST_PREPARE_OUTPUT:({item:r,success:s,failure:i=()=>{}})=>{const a={error:te("error",0,"Item not found"),file:null};if(r.archived)return i(a);Me("PREPARE_OUTPUT",r.file,{query:t,item:r}).then(o=>{Me("COMPLETE_PREPARE_OUTPUT",o,{query:t,item:r}).then(l=>{if(r.archived)return i(a);s(l)})})},COMPLETE_LOAD_ITEM:({item:r,data:s})=>{const{success:i,source:a}=s,o=t("GET_ITEM_INSERT_LOCATION");if(Xe(o)&&a&&pn(n,o),e("DID_LOAD_ITEM",{id:r.id,error:null,serverFileReference:r.origin===ce.INPUT?null:a}),i(Re(r)),r.origin===ce.LOCAL){e("DID_LOAD_LOCAL_ITEM",{id:r.id});return}if(r.origin===ce.LIMBO){e("DID_COMPLETE_ITEM_PROCESSING",{id:r.id,error:null,serverFileReference:a}),e("DID_DEFINE_VALUE",{id:r.id,value:r.serverId||a});return}t("IS_ASYNC")&&n.options.instantUpload&&e("REQUEST_ITEM_PROCESSING",{query:r.id})},RETRY_ITEM_LOAD:De(n,r=>{r.retryLoad()}),REQUEST_ITEM_PREPARE:De(n,(r,s,i)=>{e("REQUEST_PREPARE_OUTPUT",{query:r.id,item:r,success:a=>{e("DID_PREPARE_OUTPUT",{id:r.id,file:a}),s({file:r,output:a})},failure:i},!0)}),REQUEST_ITEM_PROCESSING:De(n,(r,s,i)=>{if(!(r.status===V.IDLE||r.status===V.PROCESSING_ERROR)){const o=()=>e("REQUEST_ITEM_PROCESSING",{query:r,success:s,failure:i}),l=()=>document.hidden?o():setTimeout(o,32);r.status===V.PROCESSING_COMPLETE||r.status===V.PROCESSING_REVERT_ERROR?r.revert(Tt(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(l).catch(()=>{}):r.status===V.PROCESSING&&r.abortProcessing().then(l);return}r.status!==V.PROCESSING_QUEUED&&(r.requestProcessing(),e("DID_REQUEST_ITEM_PROCESSING",{id:r.id}),e("PROCESS_ITEM",{query:r,success:s,failure:i},!0))}),PROCESS_ITEM:De(n,(r,s,i)=>{const a=t("GET_MAX_PARALLEL_UPLOADS");if(t("GET_ITEMS_BY_STATUS",V.PROCESSING).length===a){n.processingQueue.push({id:r.id,success:s,failure:i});return}if(r.status===V.PROCESSING)return;const l=()=>{const c=n.processingQueue.shift();if(!c)return;const{id:f,success:E,failure:h}=c,p=Qe(n.items,f);if(!p||p.archived){l();return}e("PROCESS_ITEM",{query:f,success:E,failure:h},!0)};r.onOnce("process-complete",()=>{s(Re(r)),l();const c=n.options.server;if(n.options.instantUpload&&r.origin===ce.LOCAL&&Xe(c.remove)){const h=()=>{};r.origin=ce.LIMBO,n.options.server.remove(r.source,h,h)}t("GET_ITEMS_BY_STATUS",V.PROCESSING_COMPLETE).length===n.items.length&&e("DID_COMPLETE_ITEM_PROCESSING_ALL")}),r.onOnce("process-error",c=>{i({error:c,file:Re(r)}),l()});const u=n.options;r.process(yc(Rc(u.server.url,u.server.process,u.name,{chunkTransferId:r.transferId,chunkServer:u.server.patch,chunkUploads:u.chunkUploads,chunkForce:u.chunkForce,chunkSize:u.chunkSize,chunkRetryDelays:u.chunkRetryDelays}),{allowMinimumUploadDuration:t("GET_ALLOW_MINIMUM_UPLOAD_DURATION")}),(c,f,E)=>{Me("PREPARE_OUTPUT",c,{query:t,item:r}).then(h=>{e("DID_PREPARE_OUTPUT",{id:r.id,file:h}),f(h)}).catch(E)})}),RETRY_ITEM_PROCESSING:De(n,r=>{e("REQUEST_ITEM_PROCESSING",{query:r})}),REQUEST_REMOVE_ITEM:De(n,r=>{Lr(t("GET_BEFORE_REMOVE_FILE"),Re(r)).then(s=>{s&&e("REMOVE_ITEM",{query:r})})}),RELEASE_ITEM:De(n,r=>{r.release()}),REMOVE_ITEM:De(n,(r,s,i,a)=>{const o=()=>{const u=r.id;Cr(n.items,u).archive(),e("DID_REMOVE_ITEM",{error:null,id:u,item:r}),fn(e,n),s(Re(r))},l=n.options.server;r.origin===ce.LOCAL&&l&&Xe(l.remove)&&a.remove!==!1?(e("DID_START_ITEM_REMOVE",{id:r.id}),l.remove(r.source,()=>o(),u=>{e("DID_THROW_ITEM_REMOVE_ERROR",{id:r.id,error:te("error",0,u,null),status:{main:Lt(n.options.labelFileRemoveError)(u),sub:n.options.labelTapToRetry}})})):((a.revert&&r.origin!==ce.LOCAL&&r.serverId!==null||n.options.chunkUploads&&r.file.size>n.options.chunkSize||n.options.chunkUploads&&n.options.chunkForce)&&r.revert(Tt(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")),o())}),ABORT_ITEM_LOAD:De(n,r=>{r.abortLoad()}),ABORT_ITEM_PROCESSING:De(n,r=>{if(r.serverId){e("REVERT_ITEM_PROCESSING",{id:r.id});return}r.abortProcessing().then(()=>{n.options.instantUpload&&e("REMOVE_ITEM",{query:r.id})})}),REQUEST_REVERT_ITEM_PROCESSING:De(n,r=>{if(!n.options.instantUpload){e("REVERT_ITEM_PROCESSING",{query:r});return}const s=o=>{o&&e("REVERT_ITEM_PROCESSING",{query:r})},i=t("GET_BEFORE_REMOVE_FILE");if(!i)return s(!0);const a=i(Re(r));if(a==null)return s(!0);if(typeof a=="boolean")return s(a);typeof a.then=="function"&&a.then(s)}),REVERT_ITEM_PROCESSING:De(n,r=>{r.revert(Tt(n.options.server.url,n.options.server.revert),t("GET_FORCE_REVERT")).then(()=>{(n.options.instantUpload||Oc(r))&&e("REMOVE_ITEM",{query:r.id})}).catch(()=>{})}),SET_OPTIONS:({options:r})=>{const s=Object.keys(r),i=bc.filter(o=>s.includes(o));[...i,...Object.keys(r).filter(o=>!i.includes(o))].forEach(o=>{e(`SET_${tn(o,"_").toUpperCase()}`,{value:r[o]})})}}),bc=["server"],Xn=e=>e,je=e=>document.createElement(e),ne=(e,t)=>{let n=e.childNodes[0];n?t!==n.nodeValue&&(n.nodeValue=t):(n=document.createTextNode(t),e.appendChild(n))},Gr=(e,t,n,r)=>{const s=(r%360-90)*Math.PI/180;return{x:e+n*Math.cos(s),y:t+n*Math.sin(s)}},Mc=(e,t,n,r,s,i)=>{const a=Gr(e,t,n,s),o=Gr(e,t,n,r);return["M",a.x,a.y,"A",n,n,0,i,0,o.x,o.y].join(" ")},Cc=(e,t,n,r,s)=>{let i=1;return s>r&&s-r<=.5&&(i=0),r>s&&r-s>=.5&&(i=0),Mc(e,t,n,Math.min(.9999,r)*360,Math.min(.9999,s)*360,i)},Nc=({root:e,props:t})=>{t.spin=!1,t.progress=0,t.opacity=0;const n=qt("svg");e.ref.path=qt("path",{"stroke-width":2,"stroke-linecap":"round"}),n.appendChild(e.ref.path),e.ref.svg=n,e.appendChild(n)},Pc=({root:e,props:t})=>{if(t.opacity===0)return;t.align&&(e.element.dataset.align=t.align);const n=parseInt(oe(e.ref.path,"stroke-width"),10),r=e.rect.element.width*.5;let s=0,i=0;t.spin?(s=0,i=.5):(s=0,i=t.progress);const a=Cc(r,r,r-n,s,i);oe(e.ref.path,"d",a),oe(e.ref.path,"stroke-opacity",t.spin||t.progress>0?1:0)},Fr=ie({tag:"div",name:"progress-indicator",ignoreRectUpdate:!0,ignoreRect:!0,create:Nc,write:Pc,mixins:{apis:["progress","spin","align"],styles:["opacity"],animations:{opacity:{type:"tween",duration:500},progress:{type:"spring",stiffness:.95,damping:.65,mass:10}}}}),Lc=({root:e,props:t})=>{e.element.innerHTML=(t.icon||"")+`<span>${t.label}</span>`,t.isDisabled=!1},Gc=({root:e,props:t})=>{const{isDisabled:n}=t,r=e.query("GET_DISABLED")||t.opacity===0;r&&!n?(t.isDisabled=!0,oe(e.element,"disabled","disabled")):!r&&n&&(t.isDisabled=!1,e.element.removeAttribute("disabled"))},ci=ie({tag:"button",attributes:{type:"button"},ignoreRect:!0,ignoreRectUpdate:!0,name:"file-action-button",mixins:{apis:["label"],styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}},listeners:!0},create:Lc,write:Gc}),di=(e,t=".",n=1e3,r={})=>{const{labelBytes:s="bytes",labelKilobytes:i="KB",labelMegabytes:a="MB",labelGigabytes:o="GB"}=r;e=Math.round(Math.abs(e));const l=n,u=n*n,c=n*n*n;return e<l?`${e} ${s}`:e<u?`${Math.floor(e/l)} ${i}`:e<c?`${Ur(e/u,1,t)} ${a}`:`${Ur(e/c,2,t)} ${o}`},Ur=(e,t,n)=>e.toFixed(t).split(".").filter(r=>r!=="0").join(n),Fc=({root:e,props:t})=>{const n=je("span");n.className="filepond--file-info-main",oe(n,"aria-hidden","true"),e.appendChild(n),e.ref.fileName=n;const r=je("span");r.className="filepond--file-info-sub",e.appendChild(r),e.ref.fileSize=r,ne(r,e.query("GET_LABEL_FILE_WAITING_FOR_SIZE")),ne(n,Xn(e.query("GET_ITEM_NAME",t.id)))},xn=({root:e,props:t})=>{ne(e.ref.fileSize,di(e.query("GET_ITEM_SIZE",t.id),".",e.query("GET_FILE_SIZE_BASE"),e.query("GET_FILE_SIZE_LABELS",e.query))),ne(e.ref.fileName,Xn(e.query("GET_ITEM_NAME",t.id)))},Br=({root:e,props:t})=>{if(dt(e.query("GET_ITEM_SIZE",t.id))){xn({root:e,props:t});return}ne(e.ref.fileSize,e.query("GET_LABEL_FILE_SIZE_NOT_AVAILABLE"))},Uc=ie({name:"file-info",ignoreRect:!0,ignoreRectUpdate:!0,write:he({DID_LOAD_ITEM:xn,DID_UPDATE_ITEM_META:xn,DID_THROW_ITEM_LOAD_ERROR:Br,DID_THROW_ITEM_INVALID:Br}),didCreateView:e=>{tt("CREATE_VIEW",{...e,view:e})},create:Fc,mixins:{styles:["translateX","translateY"],animations:{translateX:"spring",translateY:"spring"}}}),ui=e=>Math.round(e*100),Bc=({root:e})=>{const t=je("span");t.className="filepond--file-status-main",e.appendChild(t),e.ref.main=t;const n=je("span");n.className="filepond--file-status-sub",e.appendChild(n),e.ref.sub=n,fi({root:e,action:{progress:null}})},fi=({root:e,action:t})=>{const n=t.progress===null?e.query("GET_LABEL_FILE_LOADING"):`${e.query("GET_LABEL_FILE_LOADING")} ${ui(t.progress)}%`;ne(e.ref.main,n),ne(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},jc=({root:e,action:t})=>{const n=t.progress===null?e.query("GET_LABEL_FILE_PROCESSING"):`${e.query("GET_LABEL_FILE_PROCESSING")} ${ui(t.progress)}%`;ne(e.ref.main,n),ne(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},Vc=({root:e})=>{ne(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING")),ne(e.ref.sub,e.query("GET_LABEL_TAP_TO_CANCEL"))},Hc=({root:e})=>{ne(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_ABORTED")),ne(e.ref.sub,e.query("GET_LABEL_TAP_TO_RETRY"))},kc=({root:e})=>{ne(e.ref.main,e.query("GET_LABEL_FILE_PROCESSING_COMPLETE")),ne(e.ref.sub,e.query("GET_LABEL_TAP_TO_UNDO"))},jr=({root:e})=>{ne(e.ref.main,""),ne(e.ref.sub,"")},Rt=({root:e,action:t})=>{ne(e.ref.main,t.status.main),ne(e.ref.sub,t.status.sub)},$c=ie({name:"file-status",ignoreRect:!0,ignoreRectUpdate:!0,write:he({DID_LOAD_ITEM:jr,DID_REVERT_ITEM_PROCESSING:jr,DID_REQUEST_ITEM_PROCESSING:Vc,DID_ABORT_ITEM_PROCESSING:Hc,DID_COMPLETE_ITEM_PROCESSING:kc,DID_UPDATE_ITEM_PROCESS_PROGRESS:jc,DID_UPDATE_ITEM_LOAD_PROGRESS:fi,DID_THROW_ITEM_LOAD_ERROR:Rt,DID_THROW_ITEM_INVALID:Rt,DID_THROW_ITEM_PROCESSING_ERROR:Rt,DID_THROW_ITEM_PROCESSING_REVERT_ERROR:Rt,DID_THROW_ITEM_REMOVE_ERROR:Rt}),didCreateView:e=>{tt("CREATE_VIEW",{...e,view:e})},create:Bc,mixins:{styles:["translateX","translateY","opacity"],animations:{opacity:{type:"tween",duration:250},translateX:"spring",translateY:"spring"}}}),bn={AbortItemLoad:{label:"GET_LABEL_BUTTON_ABORT_ITEM_LOAD",action:"ABORT_ITEM_LOAD",className:"filepond--action-abort-item-load",align:"LOAD_INDICATOR_POSITION"},RetryItemLoad:{label:"GET_LABEL_BUTTON_RETRY_ITEM_LOAD",action:"RETRY_ITEM_LOAD",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-load",align:"BUTTON_PROCESS_ITEM_POSITION"},RemoveItem:{label:"GET_LABEL_BUTTON_REMOVE_ITEM",action:"REQUEST_REMOVE_ITEM",icon:"GET_ICON_REMOVE",className:"filepond--action-remove-item",align:"BUTTON_REMOVE_ITEM_POSITION"},ProcessItem:{label:"GET_LABEL_BUTTON_PROCESS_ITEM",action:"REQUEST_ITEM_PROCESSING",icon:"GET_ICON_PROCESS",className:"filepond--action-process-item",align:"BUTTON_PROCESS_ITEM_POSITION"},AbortItemProcessing:{label:"GET_LABEL_BUTTON_ABORT_ITEM_PROCESSING",action:"ABORT_ITEM_PROCESSING",className:"filepond--action-abort-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RetryItemProcessing:{label:"GET_LABEL_BUTTON_RETRY_ITEM_PROCESSING",action:"RETRY_ITEM_PROCESSING",icon:"GET_ICON_RETRY",className:"filepond--action-retry-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"},RevertItemProcessing:{label:"GET_LABEL_BUTTON_UNDO_ITEM_PROCESSING",action:"REQUEST_REVERT_ITEM_PROCESSING",icon:"GET_ICON_UNDO",className:"filepond--action-revert-item-processing",align:"BUTTON_PROCESS_ITEM_POSITION"}},Mn=[];J(bn,e=>{Mn.push(e)});const Se=e=>{if(Cn(e)==="right")return 0;const t=e.ref.buttonRemoveItem.rect.element;return t.hidden?null:t.width+t.left},Wc=e=>e.ref.buttonAbortItemLoad.rect.element.width,Gt=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.height/4),zc=e=>Math.floor(e.ref.buttonRemoveItem.rect.element.left/2),Yc=e=>e.query("GET_STYLE_LOAD_INDICATOR_POSITION"),qc=e=>e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION"),Cn=e=>e.query("GET_STYLE_BUTTON_REMOVE_ITEM_POSITION"),Xc={buttonAbortItemLoad:{opacity:0},buttonRetryItemLoad:{opacity:0},buttonRemoveItem:{opacity:0},buttonProcessItem:{opacity:0},buttonAbortItemProcessing:{opacity:0},buttonRetryItemProcessing:{opacity:0},buttonRevertItemProcessing:{opacity:0},loadProgressIndicator:{opacity:0,align:Yc},processProgressIndicator:{opacity:0,align:qc},processingCompleteIndicator:{opacity:0,scaleX:.75,scaleY:.75},info:{translateX:0,translateY:0,opacity:0},status:{translateX:0,translateY:0,opacity:0}},Vr={buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:Se},status:{translateX:Se}},mn={buttonAbortItemProcessing:{opacity:1},processProgressIndicator:{opacity:1},status:{opacity:1}},at={DID_THROW_ITEM_INVALID:{buttonRemoveItem:{opacity:1},info:{translateX:Se},status:{translateX:Se,opacity:1}},DID_START_ITEM_LOAD:{buttonAbortItemLoad:{opacity:1},loadProgressIndicator:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_LOAD_ERROR:{buttonRetryItemLoad:{opacity:1},buttonRemoveItem:{opacity:1},info:{translateX:Se},status:{opacity:1}},DID_START_ITEM_REMOVE:{processProgressIndicator:{opacity:1,align:Cn},info:{translateX:Se},status:{opacity:0}},DID_THROW_ITEM_REMOVE_ERROR:{processProgressIndicator:{opacity:0,align:Cn},buttonRemoveItem:{opacity:1},info:{translateX:Se},status:{opacity:1,translateX:Se}},DID_LOAD_ITEM:Vr,DID_LOAD_LOCAL_ITEM:{buttonRemoveItem:{opacity:1},info:{translateX:Se},status:{translateX:Se}},DID_START_ITEM_PROCESSING:mn,DID_REQUEST_ITEM_PROCESSING:mn,DID_UPDATE_ITEM_PROCESS_PROGRESS:mn,DID_COMPLETE_ITEM_PROCESSING:{buttonRevertItemProcessing:{opacity:1},info:{opacity:1},status:{opacity:1}},DID_THROW_ITEM_PROCESSING_ERROR:{buttonRemoveItem:{opacity:1},buttonRetryItemProcessing:{opacity:1},status:{opacity:1},info:{translateX:Se}},DID_THROW_ITEM_PROCESSING_REVERT_ERROR:{buttonRevertItemProcessing:{opacity:1},status:{opacity:1},info:{opacity:1}},DID_ABORT_ITEM_PROCESSING:{buttonRemoveItem:{opacity:1},buttonProcessItem:{opacity:1},info:{translateX:Se},status:{opacity:1}},DID_REVERT_ITEM_PROCESSING:Vr},Qc=ie({create:({root:e})=>{e.element.innerHTML=e.query("GET_ICON_DONE")},name:"processing-complete-indicator",ignoreRect:!0,mixins:{styles:["scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",opacity:{type:"tween",duration:250}}}}),Zc=({root:e,props:t})=>{const n=Object.keys(bn).reduce((p,g)=>(p[g]={...bn[g]},p),{}),{id:r}=t,s=e.query("GET_ALLOW_REVERT"),i=e.query("GET_ALLOW_REMOVE"),a=e.query("GET_ALLOW_PROCESS"),o=e.query("GET_INSTANT_UPLOAD"),l=e.query("IS_ASYNC"),u=e.query("GET_STYLE_BUTTON_REMOVE_ITEM_ALIGN");let c;l?a&&!s?c=p=>!/RevertItemProcessing/.test(p):!a&&s?c=p=>!/ProcessItem|RetryItemProcessing|AbortItemProcessing/.test(p):!a&&!s&&(c=p=>!/Process/.test(p)):c=p=>!/Process/.test(p);const f=c?Mn.filter(c):Mn.concat();if(o&&s&&(n.RevertItemProcessing.label="GET_LABEL_BUTTON_REMOVE_ITEM",n.RevertItemProcessing.icon="GET_ICON_REMOVE"),l&&!s){const p=at.DID_COMPLETE_ITEM_PROCESSING;p.info.translateX=zc,p.info.translateY=Gt,p.status.translateY=Gt,p.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}if(l&&!a&&(["DID_START_ITEM_PROCESSING","DID_REQUEST_ITEM_PROCESSING","DID_UPDATE_ITEM_PROCESS_PROGRESS","DID_THROW_ITEM_PROCESSING_ERROR"].forEach(p=>{at[p].status.translateY=Gt}),at.DID_THROW_ITEM_PROCESSING_ERROR.status.translateX=Wc),u&&s){n.RevertItemProcessing.align="BUTTON_REMOVE_ITEM_POSITION";const p=at.DID_COMPLETE_ITEM_PROCESSING;p.info.translateX=Se,p.status.translateY=Gt,p.processingCompleteIndicator={opacity:1,scaleX:1,scaleY:1}}i||(n.RemoveItem.disabled=!0),J(n,(p,g)=>{const R=e.createChildView(ci,{label:e.query(g.label),icon:e.query(g.icon),opacity:0});f.includes(p)&&e.appendChildView(R),g.disabled&&(R.element.setAttribute("disabled","disabled"),R.element.setAttribute("hidden","hidden")),R.element.dataset.align=e.query(`GET_STYLE_${g.align}`),R.element.classList.add(g.className),R.on("click",_=>{_.stopPropagation(),!g.disabled&&e.dispatch(g.action,{query:r})}),e.ref[`button${p}`]=R}),e.ref.processingCompleteIndicator=e.appendChildView(e.createChildView(Qc)),e.ref.processingCompleteIndicator.element.dataset.align=e.query("GET_STYLE_BUTTON_PROCESS_ITEM_POSITION"),e.ref.info=e.appendChildView(e.createChildView(Uc,{id:r})),e.ref.status=e.appendChildView(e.createChildView($c,{id:r}));const E=e.appendChildView(e.createChildView(Fr,{opacity:0,align:e.query("GET_STYLE_LOAD_INDICATOR_POSITION")}));E.element.classList.add("filepond--load-indicator"),e.ref.loadProgressIndicator=E;const h=e.appendChildView(e.createChildView(Fr,{opacity:0,align:e.query("GET_STYLE_PROGRESS_INDICATOR_POSITION")}));h.element.classList.add("filepond--process-indicator"),e.ref.processProgressIndicator=h,e.ref.activeStyles=[]},Kc=({root:e,actions:t,props:n})=>{Jc({root:e,actions:t,props:n});let r=t.concat().filter(s=>/^DID_/.test(s.type)).reverse().find(s=>at[s.type]);if(r){e.ref.activeStyles=[];const s=at[r.type];J(Xc,(i,a)=>{const o=e.ref[i];J(a,(l,u)=>{const c=s[i]&&typeof s[i][l]<"u"?s[i][l]:u;e.ref.activeStyles.push({control:o,key:l,value:c})})})}e.ref.activeStyles.forEach(({control:s,key:i,value:a})=>{s[i]=typeof a=="function"?a(e):a})},Jc=he({DID_SET_LABEL_BUTTON_ABORT_ITEM_PROCESSING:({root:e,action:t})=>{e.ref.buttonAbortItemProcessing.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_LOAD:({root:e,action:t})=>{e.ref.buttonAbortItemLoad.label=t.value},DID_SET_LABEL_BUTTON_ABORT_ITEM_REMOVAL:({root:e,action:t})=>{e.ref.buttonAbortItemRemoval.label=t.value},DID_REQUEST_ITEM_PROCESSING:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_START_ITEM_LOAD:({root:e})=>{e.ref.loadProgressIndicator.spin=!0,e.ref.loadProgressIndicator.progress=0},DID_START_ITEM_REMOVE:({root:e})=>{e.ref.processProgressIndicator.spin=!0,e.ref.processProgressIndicator.progress=0},DID_UPDATE_ITEM_LOAD_PROGRESS:({root:e,action:t})=>{e.ref.loadProgressIndicator.spin=!1,e.ref.loadProgressIndicator.progress=t.progress},DID_UPDATE_ITEM_PROCESS_PROGRESS:({root:e,action:t})=>{e.ref.processProgressIndicator.spin=!1,e.ref.processProgressIndicator.progress=t.progress}}),ed=ie({create:Zc,write:Kc,didCreateView:e=>{tt("CREATE_VIEW",{...e,view:e})},name:"file"}),td=({root:e,props:t})=>{e.ref.fileName=je("legend"),e.appendChild(e.ref.fileName),e.ref.file=e.appendChildView(e.createChildView(ed,{id:t.id})),e.ref.data=!1},nd=({root:e,props:t})=>{ne(e.ref.fileName,Xn(e.query("GET_ITEM_NAME",t.id)))},rd=ie({create:td,ignoreRect:!0,write:he({DID_LOAD_ITEM:nd}),didCreateView:e=>{tt("CREATE_VIEW",{...e,view:e})},tag:"fieldset",name:"file-wrapper"}),Hr={type:"spring",damping:.6,mass:7},sd=({root:e,props:t})=>{[{name:"top"},{name:"center",props:{translateY:null,scaleY:null},mixins:{animations:{scaleY:Hr},styles:["translateY","scaleY"]}},{name:"bottom",props:{translateY:null},mixins:{animations:{translateY:Hr},styles:["translateY"]}}].forEach(n=>{id(e,n,t.name)}),e.element.classList.add(`filepond--${t.name}`),e.ref.scalable=null},id=(e,t,n)=>{const r=ie({name:`panel-${t.name} filepond--${n}`,mixins:t.mixins,ignoreRectUpdate:!0}),s=e.createChildView(r,t.props);e.ref[t.name]=e.appendChildView(s)},ad=({root:e,props:t})=>{if((e.ref.scalable===null||t.scalable!==e.ref.scalable)&&(e.ref.scalable=qs(t.scalable)?t.scalable:!0,e.element.dataset.scalable=e.ref.scalable),!t.height)return;const n=e.ref.top.rect.element,r=e.ref.bottom.rect.element,s=Math.max(n.height+r.height,t.height);e.ref.center.translateY=n.height,e.ref.center.scaleY=(s-n.height-r.height)/100,e.ref.bottom.translateY=s-r.height},pi=ie({name:"panel",read:({root:e,props:t})=>t.heightCurrent=e.ref.bottom.translateY,write:ad,create:sd,ignoreRect:!0,mixins:{apis:["height","heightCurrent","scalable"]}}),od=e=>{const t=e.map(r=>r.id);let n;return{setIndex:r=>{n=r},getIndex:()=>n,getItemIndex:r=>t.indexOf(r.id)}},kr={type:"spring",stiffness:.75,damping:.45,mass:10},$r="spring",Wr={DID_START_ITEM_LOAD:"busy",DID_UPDATE_ITEM_LOAD_PROGRESS:"loading",DID_THROW_ITEM_INVALID:"load-invalid",DID_THROW_ITEM_LOAD_ERROR:"load-error",DID_LOAD_ITEM:"idle",DID_THROW_ITEM_REMOVE_ERROR:"remove-error",DID_START_ITEM_REMOVE:"busy",DID_START_ITEM_PROCESSING:"busy processing",DID_REQUEST_ITEM_PROCESSING:"busy processing",DID_UPDATE_ITEM_PROCESS_PROGRESS:"processing",DID_COMPLETE_ITEM_PROCESSING:"processing-complete",DID_THROW_ITEM_PROCESSING_ERROR:"processing-error",DID_THROW_ITEM_PROCESSING_REVERT_ERROR:"processing-revert-error",DID_ABORT_ITEM_PROCESSING:"cancelled",DID_REVERT_ITEM_PROCESSING:"idle"},ld=({root:e,props:t})=>{if(e.ref.handleClick=r=>e.dispatch("DID_ACTIVATE_ITEM",{id:t.id}),e.element.id=`filepond--item-${t.id}`,e.element.addEventListener("click",e.ref.handleClick),e.ref.container=e.appendChildView(e.createChildView(rd,{id:t.id})),e.ref.panel=e.appendChildView(e.createChildView(pi,{name:"item-panel"})),e.ref.panel.height=null,t.markedForRemoval=!1,!e.query("GET_ALLOW_REORDER"))return;e.element.dataset.dragState="idle";const n=r=>{if(!r.isPrimary)return;let s=!1;const i={x:r.pageX,y:r.pageY};t.dragOrigin={x:e.translateX,y:e.translateY},t.dragCenter={x:r.offsetX,y:r.offsetY};const a=od(e.query("GET_ACTIVE_ITEMS"));e.dispatch("DID_GRAB_ITEM",{id:t.id,dragState:a});const o=f=>{if(!f.isPrimary)return;f.stopPropagation(),f.preventDefault(),t.dragOffset={x:f.pageX-i.x,y:f.pageY-i.y},t.dragOffset.x*t.dragOffset.x+t.dragOffset.y*t.dragOffset.y>16&&!s&&(s=!0,e.element.removeEventListener("click",e.ref.handleClick)),e.dispatch("DID_DRAG_ITEM",{id:t.id,dragState:a})},l=f=>{f.isPrimary&&(t.dragOffset={x:f.pageX-i.x,y:f.pageY-i.y},c())},u=()=>{c()},c=()=>{document.removeEventListener("pointercancel",u),document.removeEventListener("pointermove",o),document.removeEventListener("pointerup",l),e.dispatch("DID_DROP_ITEM",{id:t.id,dragState:a}),s&&setTimeout(()=>e.element.addEventListener("click",e.ref.handleClick),0)};document.addEventListener("pointercancel",u),document.addEventListener("pointermove",o),document.addEventListener("pointerup",l)};e.element.addEventListener("pointerdown",n)},cd=he({DID_UPDATE_PANEL_HEIGHT:({root:e,action:t})=>{e.height=t.height}}),dd=he({DID_GRAB_ITEM:({root:e,props:t})=>{t.dragOrigin={x:e.translateX,y:e.translateY}},DID_DRAG_ITEM:({root:e})=>{e.element.dataset.dragState="drag"},DID_DROP_ITEM:({root:e,props:t})=>{t.dragOffset=null,t.dragOrigin=null,e.element.dataset.dragState="drop"}},({root:e,actions:t,props:n,shouldOptimize:r})=>{e.element.dataset.dragState==="drop"&&e.scaleX<=1&&(e.element.dataset.dragState="idle");let s=t.concat().filter(a=>/^DID_/.test(a.type)).reverse().find(a=>Wr[a.type]);s&&s.type!==n.currentState&&(n.currentState=s.type,e.element.dataset.filepondItemState=Wr[n.currentState]||"");const i=e.query("GET_ITEM_PANEL_ASPECT_RATIO")||e.query("GET_PANEL_ASPECT_RATIO");i?r||(e.height=e.rect.element.width*i):(cd({root:e,actions:t,props:n}),!e.height&&e.ref.container.rect.element.height>0&&(e.height=e.ref.container.rect.element.height)),r&&(e.ref.panel.height=null),e.ref.panel.height=e.height}),ud=ie({create:ld,write:dd,destroy:({root:e,props:t})=>{e.element.removeEventListener("click",e.ref.handleClick),e.dispatch("RELEASE_ITEM",{query:t.id})},tag:"li",name:"item",mixins:{apis:["id","interactionMethod","markedForRemoval","spawnDate","dragCenter","dragOrigin","dragOffset"],styles:["translateX","translateY","scaleX","scaleY","opacity","height"],animations:{scaleX:$r,scaleY:$r,translateX:kr,translateY:kr,opacity:{type:"tween",duration:150}}}});var Qn=(e,t)=>Math.max(1,Math.floor((e+1)/t));const Zn=(e,t,n)=>{if(!n)return;const r=e.rect.element.width,s=t.length;let i=null;if(s===0||n.top<t[0].rect.element.top)return-1;const o=t[0].rect.element,l=o.marginLeft+o.marginRight,u=o.width+l,c=Qn(r,u);if(c===1){for(let h=0;h<s;h++){const p=t[h],g=p.rect.outer.top+p.rect.element.height*.5;if(n.top<g)return h}return s}const f=o.marginTop+o.marginBottom,E=o.height+f;for(let h=0;h<s;h++){const p=h%c,g=Math.floor(h/c),R=p*u,_=g*E,m=_-o.marginTop,I=R+u,T=_+E+o.marginBottom;if(n.top<T&&n.top>m){if(n.left<I)return h;h!==s-1?i=h:i=null}}return i!==null?i:s},Ft={height:0,width:0,get getHeight(){return this.height},set setHeight(e){(this.height===0||e===0)&&(this.height=e)},get getWidth(){return this.width},set setWidth(e){(this.width===0||e===0)&&(this.width=e)}},fd=({root:e})=>{oe(e.element,"role","list"),e.ref.lastItemSpanwDate=Date.now()},pd=({root:e,action:t})=>{const{id:n,index:r,interactionMethod:s}=t;e.ref.addIndex=r;const i=Date.now();let a=i,o=1;if(s!==xe.NONE){o=0;const l=e.query("GET_ITEM_INSERT_INTERVAL"),u=i-e.ref.lastItemSpanwDate;a=u<l?i+(l-u):i}e.ref.lastItemSpanwDate=a,e.appendChildView(e.createChildView(ud,{spawnDate:a,id:n,opacity:o,interactionMethod:s}),r)},zr=(e,t,n,r=0,s=1)=>{e.dragOffset?(e.translateX=null,e.translateY=null,e.translateX=e.dragOrigin.x+e.dragOffset.x,e.translateY=e.dragOrigin.y+e.dragOffset.y,e.scaleX=1.025,e.scaleY=1.025):(e.translateX=t,e.translateY=n,Date.now()>e.spawnDate&&(e.opacity===0&&md(e,t,n,r,s),e.scaleX=1,e.scaleY=1,e.opacity=1))},md=(e,t,n,r,s)=>{e.interactionMethod===xe.NONE?(e.translateX=null,e.translateX=t,e.translateY=null,e.translateY=n):e.interactionMethod===xe.DROP?(e.translateX=null,e.translateX=t-r*20,e.translateY=null,e.translateY=n-s*10,e.scaleX=.8,e.scaleY=.8):e.interactionMethod===xe.BROWSE?(e.translateY=null,e.translateY=n-30):e.interactionMethod===xe.API&&(e.translateX=null,e.translateX=t-30,e.translateY=null)},Ed=({root:e,action:t})=>{const{id:n}=t,r=e.childViews.find(s=>s.id===n);r&&(r.scaleX=.9,r.scaleY=.9,r.opacity=0,r.markedForRemoval=!0)},En=e=>e.rect.element.height+e.rect.element.marginBottom*.5+e.rect.element.marginTop*.5,hd=e=>e.rect.element.width+e.rect.element.marginLeft*.5+e.rect.element.marginRight*.5,gd=({root:e,action:t})=>{const{id:n,dragState:r}=t,s=e.query("GET_ITEM",{id:n}),i=e.childViews.find(R=>R.id===n),a=e.childViews.length,o=r.getItemIndex(s);if(!i)return;const l={x:i.dragOrigin.x+i.dragOffset.x+i.dragCenter.x,y:i.dragOrigin.y+i.dragOffset.y+i.dragCenter.y},u=En(i),c=hd(i);let f=Math.floor(e.rect.outer.width/c);f>a&&(f=a);const E=Math.floor(a/f+1);Ft.setHeight=u*E,Ft.setWidth=c*f;var h={y:Math.floor(l.y/u),x:Math.floor(l.x/c),getGridIndex:function(){return l.y>Ft.getHeight||l.y<0||l.x>Ft.getWidth||l.x<0?o:this.y*f+this.x},getColIndex:function(){const _=e.query("GET_ACTIVE_ITEMS"),m=e.childViews.filter(M=>M.rect.element.height),I=_.map(M=>m.find(N=>N.id===M.id)),T=I.findIndex(M=>M===i),S=En(i),b=I.length;let O=b,w=0,v=0,G=0;for(let M=0;M<b;M++)if(w=En(I[M]),G=v,v=G+w,l.y<v){if(T>M){if(l.y<G+S){O=M;break}continue}O=M;break}return O}};const p=f>1?h.getGridIndex():h.getColIndex();e.dispatch("MOVE_ITEM",{query:i,index:p});const g=r.getIndex();if(g===void 0||g!==p){if(r.setIndex(p),g===void 0)return;e.dispatch("DID_REORDER_ITEMS",{items:e.query("GET_ACTIVE_ITEMS"),origin:o,target:p})}},Id=he({DID_ADD_ITEM:pd,DID_REMOVE_ITEM:Ed,DID_DRAG_ITEM:gd}),_d=({root:e,props:t,actions:n,shouldOptimize:r})=>{Id({root:e,props:t,actions:n});const{dragCoordinates:s}=t,i=e.rect.element.width,a=e.childViews.filter(I=>I.rect.element.height),o=e.query("GET_ACTIVE_ITEMS").map(I=>a.find(T=>T.id===I.id)).filter(I=>I),l=s?Zn(e,o,s):null,u=e.ref.addIndex||null;e.ref.addIndex=null;let c=0,f=0,E=0;if(o.length===0)return;const h=o[0].rect.element,p=h.marginTop+h.marginBottom,g=h.marginLeft+h.marginRight,R=h.width+g,_=h.height+p,m=Qn(i,R);if(m===1){let I=0,T=0;o.forEach((S,b)=>{if(l){let v=b-l;v===-2?T=-p*.25:v===-1?T=-p*.75:v===0?T=p*.75:v===1?T=p*.25:T=0}r&&(S.translateX=null,S.translateY=null),S.markedForRemoval||zr(S,0,I+T);let w=(S.rect.element.height+p)*(S.markedForRemoval?S.opacity:1);I+=w})}else{let I=0,T=0;o.forEach((S,b)=>{b===l&&(c=1),b===u&&(E+=1),S.markedForRemoval&&S.opacity<.5&&(f-=1);const O=b+E+c+f,w=O%m,v=Math.floor(O/m),G=w*R,M=v*_,N=Math.sign(G-I),C=Math.sign(M-T);I=G,T=M,!S.markedForRemoval&&(r&&(S.translateX=null,S.translateY=null),zr(S,G,M,N,C))})}},Td=(e,t)=>t.filter(n=>n.data&&n.data.id?e.id===n.data.id:!0),Rd=ie({create:fd,write:_d,tag:"ul",name:"list",didWriteView:({root:e})=>{e.childViews.filter(t=>t.markedForRemoval&&t.opacity===0&&t.resting).forEach(t=>{t._destroy(),e.removeChildView(t)})},filterFrameActionsForChild:Td,mixins:{apis:["dragCoordinates"]}}),wd=({root:e,props:t})=>{e.ref.list=e.appendChildView(e.createChildView(Rd)),t.dragCoordinates=null,t.overflowing=!1},yd=({root:e,props:t,action:n})=>{e.query("GET_ITEM_INSERT_LOCATION_FREEDOM")&&(t.dragCoordinates={left:n.position.scopeLeft-e.ref.list.rect.element.left,top:n.position.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},Sd=({props:e})=>{e.dragCoordinates=null},vd=he({DID_DRAG:yd,DID_END_DRAG:Sd}),Ad=({root:e,props:t,actions:n})=>{if(vd({root:e,props:t,actions:n}),e.ref.list.dragCoordinates=t.dragCoordinates,t.overflowing&&!t.overflow&&(t.overflowing=!1,e.element.dataset.state="",e.height=null),t.overflow){const r=Math.round(t.overflow);r!==e.height&&(t.overflowing=!0,e.element.dataset.state="overflow",e.height=r)}},Dd=ie({create:wd,write:Ad,name:"list-scroller",mixins:{apis:["overflow","dragCoordinates"],styles:["height","translateY"],animations:{translateY:"spring"}}}),Ne=(e,t,n,r="")=>{n?oe(e,t,r):e.removeAttribute(t)},Od=e=>{if(!(!e||e.value==="")){try{e.value=""}catch{}if(e.value){const t=je("form"),n=e.parentNode,r=e.nextSibling;t.appendChild(e),t.reset(),r?n.insertBefore(e,r):n.appendChild(e)}}},xd=({root:e,props:t})=>{e.element.id=`filepond--browser-${t.id}`,oe(e.element,"name",e.query("GET_NAME")),oe(e.element,"aria-controls",`filepond--assistant-${t.id}`),oe(e.element,"aria-labelledby",`filepond--drop-label-${t.id}`),mi({root:e,action:{value:e.query("GET_ACCEPTED_FILE_TYPES")}}),Ei({root:e,action:{value:e.query("GET_ALLOW_MULTIPLE")}}),hi({root:e,action:{value:e.query("GET_ALLOW_DIRECTORIES_ONLY")}}),Nn({root:e}),gi({root:e,action:{value:e.query("GET_REQUIRED")}}),Ii({root:e,action:{value:e.query("GET_CAPTURE_METHOD")}}),e.ref.handleChange=n=>{if(!e.element.value)return;const r=Array.from(e.element.files).map(s=>(s._relativePath=s.webkitRelativePath,s));setTimeout(()=>{t.onload(r),Od(e.element)},250)},e.element.addEventListener("change",e.ref.handleChange)},mi=({root:e,action:t})=>{e.query("GET_ALLOW_SYNC_ACCEPT_ATTRIBUTE")&&Ne(e.element,"accept",!!t.value,t.value?t.value.join(","):"")},Ei=({root:e,action:t})=>{Ne(e.element,"multiple",t.value)},hi=({root:e,action:t})=>{Ne(e.element,"webkitdirectory",t.value)},Nn=({root:e})=>{const t=e.query("GET_DISABLED"),n=e.query("GET_ALLOW_BROWSE"),r=t||!n;Ne(e.element,"disabled",r)},gi=({root:e,action:t})=>{t.value?e.query("GET_TOTAL_ITEMS")===0&&Ne(e.element,"required",!0):Ne(e.element,"required",!1)},Ii=({root:e,action:t})=>{Ne(e.element,"capture",!!t.value,t.value===!0?"":t.value)},Yr=({root:e})=>{const{element:t}=e;if(e.query("GET_TOTAL_ITEMS")>0){Ne(t,"required",!1),Ne(t,"name",!1);const n=e.query("GET_ACTIVE_ITEMS");let r=!1;for(let s=0;s<n.length;s++)n[s].status===V.LOAD_ERROR&&(r=!0);e.element.setCustomValidity(r?e.query("GET_LABEL_INVALID_FIELD"):"")}else Ne(t,"name",!0,e.query("GET_NAME")),e.query("GET_CHECK_VALIDITY")&&t.setCustomValidity(""),e.query("GET_REQUIRED")&&Ne(t,"required",!0)},bd=({root:e})=>{e.query("GET_CHECK_VALIDITY")&&e.element.setCustomValidity(e.query("GET_LABEL_INVALID_FIELD"))},Md=ie({tag:"input",name:"browser",ignoreRect:!0,ignoreRectUpdate:!0,attributes:{type:"file"},create:xd,destroy:({root:e})=>{e.element.removeEventListener("change",e.ref.handleChange)},write:he({DID_LOAD_ITEM:Yr,DID_REMOVE_ITEM:Yr,DID_THROW_ITEM_INVALID:bd,DID_SET_DISABLED:Nn,DID_SET_ALLOW_BROWSE:Nn,DID_SET_ALLOW_DIRECTORIES_ONLY:hi,DID_SET_ALLOW_MULTIPLE:Ei,DID_SET_ACCEPTED_FILE_TYPES:mi,DID_SET_CAPTURE_METHOD:Ii,DID_SET_REQUIRED:gi})}),qr={ENTER:13,SPACE:32},Cd=({root:e,props:t})=>{const n=je("label");oe(n,"for",`filepond--browser-${t.id}`),oe(n,"id",`filepond--drop-label-${t.id}`),e.ref.handleKeyDown=r=>{(r.keyCode===qr.ENTER||r.keyCode===qr.SPACE)&&(r.preventDefault(),e.ref.label.click())},e.ref.handleClick=r=>{r.target===n||n.contains(r.target)||e.ref.label.click()},n.addEventListener("keydown",e.ref.handleKeyDown),e.element.addEventListener("click",e.ref.handleClick),_i(n,t.caption),e.appendChild(n),e.ref.label=n},_i=(e,t)=>{e.innerHTML=t;const n=e.querySelector(".filepond--label-action");return n&&oe(n,"tabindex","0"),t},Nd=ie({name:"drop-label",ignoreRect:!0,create:Cd,destroy:({root:e})=>{e.ref.label.addEventListener("keydown",e.ref.handleKeyDown),e.element.removeEventListener("click",e.ref.handleClick)},write:he({DID_SET_LABEL_IDLE:({root:e,action:t})=>{_i(e.ref.label,t.value)}}),mixins:{styles:["opacity","translateX","translateY"],animations:{opacity:{type:"tween",duration:150},translateX:"spring",translateY:"spring"}}}),Pd=ie({name:"drip-blob",ignoreRect:!0,mixins:{styles:["translateX","translateY","scaleX","scaleY","opacity"],animations:{scaleX:"spring",scaleY:"spring",translateX:"spring",translateY:"spring",opacity:{type:"tween",duration:250}}}}),Ld=({root:e})=>{const t=e.rect.element.width*.5,n=e.rect.element.height*.5;e.ref.blob=e.appendChildView(e.createChildView(Pd,{opacity:0,scaleX:2.5,scaleY:2.5,translateX:t,translateY:n}))},Gd=({root:e,action:t})=>{if(!e.ref.blob){Ld({root:e});return}e.ref.blob.translateX=t.position.scopeLeft,e.ref.blob.translateY=t.position.scopeTop,e.ref.blob.scaleX=1,e.ref.blob.scaleY=1,e.ref.blob.opacity=1},Fd=({root:e})=>{e.ref.blob&&(e.ref.blob.opacity=0)},Ud=({root:e})=>{e.ref.blob&&(e.ref.blob.scaleX=2.5,e.ref.blob.scaleY=2.5,e.ref.blob.opacity=0)},Bd=({root:e,props:t,actions:n})=>{jd({root:e,props:t,actions:n});const{blob:r}=e.ref;n.length===0&&r&&r.opacity===0&&(e.removeChildView(r),e.ref.blob=null)},jd=he({DID_DRAG:Gd,DID_DROP:Ud,DID_END_DRAG:Fd}),Vd=ie({ignoreRect:!0,ignoreRectUpdate:!0,name:"drip",write:Bd}),Ti=(e,t)=>{try{const n=new DataTransfer;t.forEach(r=>{r instanceof File?n.items.add(r):n.items.add(new File([r],r.name,{type:r.type}))}),e.files=n.files}catch{return!1}return!0},Hd=({root:e})=>{e.ref.fields={};const t=document.createElement("legend");t.textContent="Files",e.element.appendChild(t)},sn=(e,t)=>e.ref.fields[t],Kn=e=>{e.query("GET_ACTIVE_ITEMS").forEach(t=>{e.ref.fields[t.id]&&e.element.appendChild(e.ref.fields[t.id])})},Xr=({root:e})=>Kn(e),kd=({root:e,action:t})=>{const s=!(e.query("GET_ITEM",t.id).origin===ce.LOCAL)&&e.query("SHOULD_UPDATE_FILE_INPUT"),i=je("input");i.type=s?"file":"hidden",i.name=e.query("GET_NAME"),e.ref.fields[t.id]=i,Kn(e)},$d=({root:e,action:t})=>{const n=sn(e,t.id);if(!n||(t.serverFileReference!==null&&(n.value=t.serverFileReference),!e.query("SHOULD_UPDATE_FILE_INPUT")))return;const r=e.query("GET_ITEM",t.id);Ti(n,[r.file])},Wd=({root:e,action:t})=>{e.query("SHOULD_UPDATE_FILE_INPUT")&&setTimeout(()=>{const n=sn(e,t.id);n&&Ti(n,[t.file])},0)},zd=({root:e})=>{e.element.disabled=e.query("GET_DISABLED")},Yd=({root:e,action:t})=>{const n=sn(e,t.id);n&&(n.parentNode&&n.parentNode.removeChild(n),delete e.ref.fields[t.id])},qd=({root:e,action:t})=>{const n=sn(e,t.id);n&&(t.value===null?n.removeAttribute("value"):n.type!="file"&&(n.value=t.value),Kn(e))},Xd=he({DID_SET_DISABLED:zd,DID_ADD_ITEM:kd,DID_LOAD_ITEM:$d,DID_REMOVE_ITEM:Yd,DID_DEFINE_VALUE:qd,DID_PREPARE_OUTPUT:Wd,DID_REORDER_ITEMS:Xr,DID_SORT_ITEMS:Xr}),Qd=ie({tag:"fieldset",name:"data",create:Hd,write:Xd,ignoreRect:!0}),Zd=e=>"getRootNode"in e?e.getRootNode():document,Kd=["jpg","jpeg","png","gif","bmp","webp","svg","tiff"],Jd=["css","csv","html","txt"],eu={zip:"zip|compressed",epub:"application/epub+zip"},Ri=(e="")=>(e=e.toLowerCase(),Kd.includes(e)?"image/"+(e==="jpg"?"jpeg":e==="svg"?"svg+xml":e):Jd.includes(e)?"text/"+e:eu[e]||""),Jn=e=>new Promise((t,n)=>{const r=lu(e);if(r.length&&!tu(e))return t(r);nu(e).then(t)}),tu=e=>e.files?e.files.length>0:!1,nu=e=>new Promise((t,n)=>{const r=(e.items?Array.from(e.items):[]).filter(s=>ru(s)).map(s=>su(s));if(!r.length){t(e.files?Array.from(e.files):[]);return}Promise.all(r).then(s=>{const i=[];s.forEach(a=>{i.push.apply(i,a)}),t(i.filter(a=>a).map(a=>(a._relativePath||(a._relativePath=a.webkitRelativePath),a)))}).catch(console.error)}),ru=e=>{if(wi(e)){const t=er(e);if(t)return t.isFile||t.isDirectory}return e.kind==="file"},su=e=>new Promise((t,n)=>{if(ou(e)){iu(er(e)).then(t).catch(n);return}t([e.getAsFile()])}),iu=e=>new Promise((t,n)=>{const r=[];let s=0,i=0;const a=()=>{i===0&&s===0&&t(r)},o=l=>{s++;const u=l.createReader(),c=()=>{u.readEntries(f=>{if(f.length===0){s--,a();return}f.forEach(E=>{E.isDirectory?o(E):(i++,E.file(h=>{const p=au(h);E.fullPath&&(p._relativePath=E.fullPath),r.push(p),i--,a()}))}),c()},n)};c()};o(e)}),au=e=>{if(e.type.length)return e;const t=e.lastModifiedDate,n=e.name,r=Ri(rn(e.name));return r.length&&(e=e.slice(0,e.size,r),e.name=n,e.lastModifiedDate=t),e},ou=e=>wi(e)&&(er(e)||{}).isDirectory,wi=e=>"webkitGetAsEntry"in e,er=e=>e.webkitGetAsEntry(),lu=e=>{let t=[];try{if(t=du(e),t.length)return t;t=cu(e)}catch{}return t},cu=e=>{let t=e.getData("url");return typeof t=="string"&&t.length?[t]:[]},du=e=>{let t=e.getData("text/html");if(typeof t=="string"&&t.length){const n=t.match(/src\s*=\s*"(.+?)"/);if(n)return[n[1]]}return[]},Qt=[],et=e=>({pageLeft:e.pageX,pageTop:e.pageY,scopeLeft:e.offsetX||e.layerX,scopeTop:e.offsetY||e.layerY}),uu=(e,t,n)=>{const r=fu(t),s={element:e,filterElement:n,state:null,ondrop:()=>{},onenter:()=>{},ondrag:()=>{},onexit:()=>{},onload:()=>{},allowdrop:()=>{}};return s.destroy=r.addListener(s),s},fu=e=>{const t=Qt.find(r=>r.element===e);if(t)return t;const n=pu(e);return Qt.push(n),n},pu=e=>{const t=[],n={dragenter:Eu,dragover:hu,dragleave:Iu,drop:gu},r={};J(n,(i,a)=>{r[i]=a(e,t),e.addEventListener(i,r[i],!1)});const s={element:e,addListener:i=>(t.push(i),()=>{t.splice(t.indexOf(i),1),t.length===0&&(Qt.splice(Qt.indexOf(s),1),J(n,a=>{e.removeEventListener(a,r[a],!1)}))})};return s},mu=(e,t)=>("elementFromPoint"in e||(e=document),e.elementFromPoint(t.x,t.y)),tr=(e,t)=>{const n=Zd(t),r=mu(n,{x:e.pageX-window.pageXOffset,y:e.pageY-window.pageYOffset});return r===t||t.contains(r)};let yi=null;const Ut=(e,t)=>{try{e.dropEffect=t}catch{}},Eu=(e,t)=>n=>{n.preventDefault(),yi=n.target,t.forEach(r=>{const{element:s,onenter:i}=r;tr(n,s)&&(r.state="enter",i(et(n)))})},hu=(e,t)=>n=>{n.preventDefault();const r=n.dataTransfer;Jn(r).then(s=>{let i=!1;t.some(a=>{const{filterElement:o,element:l,onenter:u,onexit:c,ondrag:f,allowdrop:E}=a;Ut(r,"copy");const h=E(s);if(!h){Ut(r,"none");return}if(tr(n,l)){if(i=!0,a.state===null){a.state="enter",u(et(n));return}if(a.state="over",o&&!h){Ut(r,"none");return}f(et(n))}else o&&!i&&Ut(r,"none"),a.state&&(a.state=null,c(et(n)))})})},gu=(e,t)=>n=>{n.preventDefault();const r=n.dataTransfer;Jn(r).then(s=>{t.forEach(i=>{const{filterElement:a,element:o,ondrop:l,onexit:u,allowdrop:c}=i;if(i.state=null,!(a&&!tr(n,o))){if(!c(s))return u(et(n));l(et(n),s)}})})},Iu=(e,t)=>n=>{yi===n.target&&t.forEach(r=>{const{onexit:s}=r;r.state=null,s(et(n))})},_u=(e,t,n)=>{e.classList.add("filepond--hopper");const{catchesDropsOnPage:r,requiresDropOnElement:s,filterItems:i=c=>c}=n,a=uu(e,r?document.documentElement:e,s);let o="",l="";a.allowdrop=c=>t(i(c)),a.ondrop=(c,f)=>{const E=i(f);if(!t(E)){u.ondragend(c);return}l="drag-drop",u.onload(E,c)},a.ondrag=c=>{u.ondrag(c)},a.onenter=c=>{l="drag-over",u.ondragstart(c)},a.onexit=c=>{l="drag-exit",u.ondragend(c)};const u={updateHopperState:()=>{o!==l&&(e.dataset.hopperState=l,o=l)},onload:()=>{},ondragstart:()=>{},ondrag:()=>{},ondragend:()=>{},destroy:()=>{a.destroy()}};return u};let Pn=!1;const lt=[],Si=e=>{const t=document.activeElement;if(t&&(/textarea|input/i.test(t.nodeName)||t.getAttribute("contenteditable")==="true")){let r=!1,s=t;for(;s!==document.body;){if(s.classList.contains("filepond--root")){r=!0;break}s=s.parentNode}if(!r)return}Jn(e.clipboardData).then(r=>{r.length&&lt.forEach(s=>s(r))})},Tu=e=>{lt.includes(e)||(lt.push(e),!Pn&&(Pn=!0,document.addEventListener("paste",Si)))},Ru=e=>{zn(lt,lt.indexOf(e)),lt.length===0&&(document.removeEventListener("paste",Si),Pn=!1)},wu=()=>{const e=n=>{t.onload(n)},t={destroy:()=>{Ru(e)},onload:()=>{}};return Tu(e),t},yu=({root:e,props:t})=>{e.element.id=`filepond--assistant-${t.id}`,oe(e.element,"role","alert"),oe(e.element,"aria-live","polite"),oe(e.element,"aria-relevant","additions")};let Qr=null,Zr=null;const hn=[],an=(e,t)=>{e.element.textContent=t},Su=e=>{e.element.textContent=""},vi=(e,t,n)=>{const r=e.query("GET_TOTAL_ITEMS");an(e,`${n} ${t}, ${r} ${r===1?e.query("GET_LABEL_FILE_COUNT_SINGULAR"):e.query("GET_LABEL_FILE_COUNT_PLURAL")}`),clearTimeout(Zr),Zr=setTimeout(()=>{Su(e)},1500)},Ai=e=>e.element.parentNode.contains(document.activeElement),vu=({root:e,action:t})=>{if(!Ai(e))return;e.element.textContent="";const n=e.query("GET_ITEM",t.id);hn.push(n.filename),clearTimeout(Qr),Qr=setTimeout(()=>{vi(e,hn.join(", "),e.query("GET_LABEL_FILE_ADDED")),hn.length=0},750)},Au=({root:e,action:t})=>{if(!Ai(e))return;const n=t.item;vi(e,n.filename,e.query("GET_LABEL_FILE_REMOVED"))},Du=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename,s=e.query("GET_LABEL_FILE_PROCESSING_COMPLETE");an(e,`${r} ${s}`)},Kr=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename,s=e.query("GET_LABEL_FILE_PROCESSING_ABORTED");an(e,`${r} ${s}`)},Bt=({root:e,action:t})=>{const r=e.query("GET_ITEM",t.id).filename;an(e,`${t.status.main} ${r} ${t.status.sub}`)},Ou=ie({create:yu,ignoreRect:!0,ignoreRectUpdate:!0,write:he({DID_LOAD_ITEM:vu,DID_REMOVE_ITEM:Au,DID_COMPLETE_ITEM_PROCESSING:Du,DID_ABORT_ITEM_PROCESSING:Kr,DID_REVERT_ITEM_PROCESSING:Kr,DID_THROW_ITEM_REMOVE_ERROR:Bt,DID_THROW_ITEM_LOAD_ERROR:Bt,DID_THROW_ITEM_INVALID:Bt,DID_THROW_ITEM_PROCESSING_ERROR:Bt}),tag:"span",name:"assistant"}),Di=(e,t="-")=>e.replace(new RegExp(`${t}.`,"g"),n=>n.charAt(1).toUpperCase()),Oi=(e,t=16,n=!0)=>{let r=Date.now(),s=null;return(...i)=>{clearTimeout(s);const a=Date.now()-r,o=()=>{r=Date.now(),e(...i)};a<t?n||(s=setTimeout(o,t-a)):o()}},xu=1e6,Zt=e=>e.preventDefault(),bu=({root:e,props:t})=>{const n=e.query("GET_ID");n&&(e.element.id=n);const r=e.query("GET_CLASS_NAME");r&&r.split(" ").filter(l=>l.length).forEach(l=>{e.element.classList.add(l)}),e.ref.label=e.appendChildView(e.createChildView(Nd,{...t,translateY:null,caption:e.query("GET_LABEL_IDLE")})),e.ref.list=e.appendChildView(e.createChildView(Dd,{translateY:null})),e.ref.panel=e.appendChildView(e.createChildView(pi,{name:"panel-root"})),e.ref.assistant=e.appendChildView(e.createChildView(Ou,{...t})),e.ref.data=e.appendChildView(e.createChildView(Qd,{...t})),e.ref.measure=je("div"),e.ref.measure.style.height="100%",e.element.appendChild(e.ref.measure),e.ref.bounds=null,e.query("GET_STYLES").filter(l=>!Be(l.value)).map(({name:l,value:u})=>{e.element.dataset[l]=u}),e.ref.widthPrevious=null,e.ref.widthUpdated=Oi(()=>{e.ref.updateHistory=[],e.dispatch("DID_RESIZE_ROOT")},250),e.ref.previousAspectRatio=null,e.ref.updateHistory=[];const s=window.matchMedia("(pointer: fine) and (hover: hover)").matches,i="PointerEvent"in window;e.query("GET_ALLOW_REORDER")&&i&&!s&&(e.element.addEventListener("touchmove",Zt,{passive:!1}),e.element.addEventListener("gesturestart",Zt));const a=e.query("GET_CREDITS");if(a.length===2){const l=document.createElement("a");l.className="filepond--credits",l.href=a[0],l.tabIndex=-1,l.target="_blank",l.rel="noopener noreferrer nofollow",l.textContent=a[1],e.element.appendChild(l),e.ref.credits=l}},Mu=({root:e,props:t,actions:n})=>{if(Gu({root:e,props:t,actions:n}),n.filter(b=>/^DID_SET_STYLE_/.test(b.type)).filter(b=>!Be(b.data.value)).map(({type:b,data:O})=>{const w=Di(b.substring(8).toLowerCase(),"_");e.element.dataset[w]=O.value,e.invalidateLayout()}),e.rect.element.hidden)return;e.rect.element.width!==e.ref.widthPrevious&&(e.ref.widthPrevious=e.rect.element.width,e.ref.widthUpdated());let r=e.ref.bounds;r||(r=e.ref.bounds=Pu(e),e.element.removeChild(e.ref.measure),e.ref.measure=null);const{hopper:s,label:i,list:a,panel:o}=e.ref;s&&s.updateHopperState();const l=e.query("GET_PANEL_ASPECT_RATIO"),u=e.query("GET_ALLOW_MULTIPLE"),c=e.query("GET_TOTAL_ITEMS"),f=u?e.query("GET_MAX_FILES")||xu:1,E=c===f,h=n.find(b=>b.type==="DID_ADD_ITEM");if(E&&h){const b=h.data.interactionMethod;i.opacity=0,u?i.translateY=-40:b===xe.API?i.translateX=40:b===xe.BROWSE?i.translateY=40:i.translateY=30}else E||(i.opacity=1,i.translateX=0,i.translateY=0);const p=Cu(e),g=Nu(e),R=i.rect.element.height,_=!u||E?0:R,m=E?a.rect.element.marginTop:0,I=c===0?0:a.rect.element.marginBottom,T=_+m+g.visual+I,S=_+m+g.bounds+I;if(a.translateY=Math.max(0,_-a.rect.element.marginTop)-p.top,l){const b=e.rect.element.width,O=b*l;l!==e.ref.previousAspectRatio&&(e.ref.previousAspectRatio=l,e.ref.updateHistory=[]);const w=e.ref.updateHistory;w.push(b);const v=2;if(w.length>v*2){const M=w.length,N=M-10;let C=0;for(let x=M;x>=N;x--)if(w[x]===w[x-2]&&C++,C>=v)return}o.scalable=!1,o.height=O;const G=O-_-(I-p.bottom)-(E?m:0);g.visual>G?a.overflow=G:a.overflow=null,e.height=O}else if(r.fixedHeight){o.scalable=!1;const b=r.fixedHeight-_-(I-p.bottom)-(E?m:0);g.visual>b?a.overflow=b:a.overflow=null}else if(r.cappedHeight){const b=T>=r.cappedHeight,O=Math.min(r.cappedHeight,T);o.scalable=!0,o.height=b?O:O-p.top-p.bottom;const w=O-_-(I-p.bottom)-(E?m:0);T>r.cappedHeight&&g.visual>w?a.overflow=w:a.overflow=null,e.height=Math.min(r.cappedHeight,S-p.top-p.bottom)}else{const b=c>0?p.top+p.bottom:0;o.scalable=!0,o.height=Math.max(R,T-b),e.height=Math.max(R,S-b)}e.ref.credits&&o.heightCurrent&&(e.ref.credits.style.transform=`translateY(${o.heightCurrent}px)`)},Cu=e=>{const t=e.ref.list.childViews[0].childViews[0];return t?{top:t.rect.element.marginTop,bottom:t.rect.element.marginBottom}:{top:0,bottom:0}},Nu=e=>{let t=0,n=0;const r=e.ref.list,s=r.childViews[0],i=s.childViews.filter(m=>m.rect.element.height),a=e.query("GET_ACTIVE_ITEMS").map(m=>i.find(I=>I.id===m.id)).filter(m=>m);if(a.length===0)return{visual:t,bounds:n};const o=s.rect.element.width,l=Zn(s,a,r.dragCoordinates),u=a[0].rect.element,c=u.marginTop+u.marginBottom,f=u.marginLeft+u.marginRight,E=u.width+f,h=u.height+c,p=typeof l<"u"&&l>=0?1:0,g=a.find(m=>m.markedForRemoval&&m.opacity<.45)?-1:0,R=a.length+p+g,_=Qn(o,E);return _===1?a.forEach(m=>{const I=m.rect.element.height+c;n+=I,t+=I*m.opacity}):(n=Math.ceil(R/_)*h,t=n),{visual:t,bounds:n}},Pu=e=>{const t=e.ref.measureHeight||null;return{cappedHeight:parseInt(e.style.maxHeight,10)||null,fixedHeight:t===0?null:t}},nr=(e,t)=>{const n=e.query("GET_ALLOW_REPLACE"),r=e.query("GET_ALLOW_MULTIPLE"),s=e.query("GET_TOTAL_ITEMS");let i=e.query("GET_MAX_FILES");const a=t.length;return!r&&a>1?(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:te("warning",0,"Max files")}),!0):(i=r?i:1,!r&&n?!1:dt(i)&&s+a>i?(e.dispatch("DID_THROW_MAX_FILES",{source:t,error:te("warning",0,"Max files")}),!0):!1)},Lu=(e,t,n)=>{const r=e.childViews[0];return Zn(r,t,{left:n.scopeLeft-r.rect.element.left,top:n.scopeTop-(e.rect.outer.top+e.rect.element.marginTop+e.rect.element.scrollTop)})},Jr=e=>{const t=e.query("GET_ALLOW_DROP"),n=e.query("GET_DISABLED"),r=t&&!n;if(r&&!e.ref.hopper){const s=_u(e.element,i=>{const a=e.query("GET_BEFORE_DROP_FILE")||(()=>!0);return e.query("GET_DROP_VALIDATION")?i.every(l=>tt("ALLOW_HOPPER_ITEM",l,{query:e.query}).every(u=>u===!0)&&a(l)):!0},{filterItems:i=>{const a=e.query("GET_IGNORED_FILES");return i.filter(o=>Je(o)?!a.includes(o.name.toLowerCase()):!0)},catchesDropsOnPage:e.query("GET_DROP_ON_PAGE"),requiresDropOnElement:e.query("GET_DROP_ON_ELEMENT")});s.onload=(i,a)=>{const l=e.ref.list.childViews[0].childViews.filter(c=>c.rect.element.height),u=e.query("GET_ACTIVE_ITEMS").map(c=>l.find(f=>f.id===c.id)).filter(c=>c);Me("ADD_ITEMS",i,{dispatch:e.dispatch}).then(c=>{if(nr(e,c))return!1;e.dispatch("ADD_ITEMS",{items:c,index:Lu(e.ref.list,u,a),interactionMethod:xe.DROP})}),e.dispatch("DID_DROP",{position:a}),e.dispatch("DID_END_DRAG",{position:a})},s.ondragstart=i=>{e.dispatch("DID_START_DRAG",{position:i})},s.ondrag=Oi(i=>{e.dispatch("DID_DRAG",{position:i})}),s.ondragend=i=>{e.dispatch("DID_END_DRAG",{position:i})},e.ref.hopper=s,e.ref.drip=e.appendChildView(e.createChildView(Vd))}else!r&&e.ref.hopper&&(e.ref.hopper.destroy(),e.ref.hopper=null,e.removeChildView(e.ref.drip))},es=(e,t)=>{const n=e.query("GET_ALLOW_BROWSE"),r=e.query("GET_DISABLED"),s=n&&!r;s&&!e.ref.browser?e.ref.browser=e.appendChildView(e.createChildView(Md,{...t,onload:i=>{Me("ADD_ITEMS",i,{dispatch:e.dispatch}).then(a=>{if(nr(e,a))return!1;e.dispatch("ADD_ITEMS",{items:a,index:-1,interactionMethod:xe.BROWSE})})}}),0):!s&&e.ref.browser&&(e.removeChildView(e.ref.browser),e.ref.browser=null)},ts=e=>{const t=e.query("GET_ALLOW_PASTE"),n=e.query("GET_DISABLED"),r=t&&!n;r&&!e.ref.paster?(e.ref.paster=wu(),e.ref.paster.onload=s=>{Me("ADD_ITEMS",s,{dispatch:e.dispatch}).then(i=>{if(nr(e,i))return!1;e.dispatch("ADD_ITEMS",{items:i,index:-1,interactionMethod:xe.PASTE})})}):!r&&e.ref.paster&&(e.ref.paster.destroy(),e.ref.paster=null)},Gu=he({DID_SET_ALLOW_BROWSE:({root:e,props:t})=>{es(e,t)},DID_SET_ALLOW_DROP:({root:e})=>{Jr(e)},DID_SET_ALLOW_PASTE:({root:e})=>{ts(e)},DID_SET_DISABLED:({root:e,props:t})=>{Jr(e),ts(e),es(e,t),e.query("GET_DISABLED")?e.element.dataset.disabled="disabled":e.element.removeAttribute("data-disabled")}}),Fu=ie({name:"root",read:({root:e})=>{e.ref.measure&&(e.ref.measureHeight=e.ref.measure.offsetHeight)},create:bu,write:Mu,destroy:({root:e})=>{e.ref.paster&&e.ref.paster.destroy(),e.ref.hopper&&e.ref.hopper.destroy(),e.element.removeEventListener("touchmove",Zt),e.element.removeEventListener("gesturestart",Zt)},mixins:{styles:["height"]}}),Uu=(e={})=>{let t=null;const n=Xt(),r=el(Bl(n),[sc,Hl(n)],[xc,Vl(n)]);r.dispatch("SET_OPTIONS",{options:e});const s=()=>{document.hidden||r.dispatch("KICK")};document.addEventListener("visibilitychange",s);let i=null,a=!1,o=!1,l=null,u=null;const c=()=>{a||(a=!0),clearTimeout(i),i=setTimeout(()=>{a=!1,l=null,u=null,o&&(o=!1,r.dispatch("DID_STOP_RESIZE"))},500)};window.addEventListener("resize",c);const f=Fu(r,{id:Wn()});let E=!1,h=!1;const p={_read:()=>{a&&(u=window.innerWidth,l||(l=u),!o&&u!==l&&(r.dispatch("DID_START_RESIZE"),o=!0)),h&&E&&(E=f.element.offsetParent===null),!E&&(f._read(),h=f.rect.element.hidden)},_write:y=>{const D=r.processActionQueue().filter(P=>!/^SET_/.test(P.type));E&&!D.length||(m(D),E=f._write(y,D,o),Wl(r.query("GET_ITEMS")),E&&r.processDispatchQueue())}},g=y=>D=>{const P={type:y};if(!D)return P;if(D.hasOwnProperty("error")&&(P.error=D.error?{...D.error}:null),D.status&&(P.status={...D.status}),D.file&&(P.output=D.file),D.source)P.file=D.source;else if(D.item||D.id){const F=D.item?D.item:r.query("GET_ITEM",D.id);P.file=F?Re(F):null}return D.items&&(P.items=D.items.map(Re)),/progress/.test(y)&&(P.progress=D.progress),D.hasOwnProperty("origin")&&D.hasOwnProperty("target")&&(P.origin=D.origin,P.target=D.target),P},R={DID_DESTROY:g("destroy"),DID_INIT:g("init"),DID_THROW_MAX_FILES:g("warning"),DID_INIT_ITEM:g("initfile"),DID_START_ITEM_LOAD:g("addfilestart"),DID_UPDATE_ITEM_LOAD_PROGRESS:g("addfileprogress"),DID_LOAD_ITEM:g("addfile"),DID_THROW_ITEM_INVALID:[g("error"),g("addfile")],DID_THROW_ITEM_LOAD_ERROR:[g("error"),g("addfile")],DID_THROW_ITEM_REMOVE_ERROR:[g("error"),g("removefile")],DID_PREPARE_OUTPUT:g("preparefile"),DID_START_ITEM_PROCESSING:g("processfilestart"),DID_UPDATE_ITEM_PROCESS_PROGRESS:g("processfileprogress"),DID_ABORT_ITEM_PROCESSING:g("processfileabort"),DID_COMPLETE_ITEM_PROCESSING:g("processfile"),DID_COMPLETE_ITEM_PROCESSING_ALL:g("processfiles"),DID_REVERT_ITEM_PROCESSING:g("processfilerevert"),DID_THROW_ITEM_PROCESSING_ERROR:[g("error"),g("processfile")],DID_REMOVE_ITEM:g("removefile"),DID_UPDATE_ITEMS:g("updatefiles"),DID_ACTIVATE_ITEM:g("activatefile"),DID_REORDER_ITEMS:g("reorderfiles")},_=y=>{const D={pond:U,...y};delete D.type,f.element.dispatchEvent(new CustomEvent(`FilePond:${y.type}`,{detail:D,bubbles:!0,cancelable:!0,composed:!0}));const P=[];y.hasOwnProperty("error")&&P.push(y.error),y.hasOwnProperty("file")&&P.push(y.file);const F=["type","error","file"];Object.keys(y).filter(B=>!F.includes(B)).forEach(B=>P.push(y[B])),U.fire(y.type,...P);const W=r.query(`GET_ON${y.type.toUpperCase()}`);W&&W(...P)},m=y=>{y.length&&y.filter(D=>R[D.type]).forEach(D=>{const P=R[D.type];(Array.isArray(P)?P:[P]).forEach(F=>{D.type==="DID_INIT_ITEM"?_(F(D.data)):setTimeout(()=>{_(F(D.data))},0)})})},I=y=>r.dispatch("SET_OPTIONS",{options:y}),T=y=>r.query("GET_ACTIVE_ITEM",y),S=y=>new Promise((D,P)=>{r.dispatch("REQUEST_ITEM_PREPARE",{query:y,success:F=>{D(F)},failure:F=>{P(F)}})}),b=(y,D={})=>new Promise((P,F)=>{v([{source:y,options:D}],{index:D.index}).then(W=>P(W&&W[0])).catch(F)}),O=y=>y.file&&y.id,w=(y,D)=>(typeof y=="object"&&!O(y)&&!D&&(D=y,y=void 0),r.dispatch("REMOVE_ITEM",{...D,query:y}),r.query("GET_ACTIVE_ITEM",y)===null),v=(...y)=>new Promise((D,P)=>{const F=[],W={};if(Jt(y[0]))F.push.apply(F,y[0]),Object.assign(W,y[1]||{});else{const B=y[y.length-1];typeof B=="object"&&!(B instanceof Blob)&&Object.assign(W,y.pop()),F.push(...y)}r.dispatch("ADD_ITEMS",{items:F,index:W.index,interactionMethod:xe.API,success:D,failure:P})}),G=()=>r.query("GET_ACTIVE_ITEMS"),M=y=>new Promise((D,P)=>{r.dispatch("REQUEST_ITEM_PROCESSING",{query:y,success:F=>{D(F)},failure:F=>{P(F)}})}),N=(...y)=>{const D=Array.isArray(y[0])?y[0]:y,P=D.length?D:G();return Promise.all(P.map(S))},C=(...y)=>{const D=Array.isArray(y[0])?y[0]:y;if(!D.length){const P=G().filter(F=>!(F.status===V.IDLE&&F.origin===ce.LOCAL)&&F.status!==V.PROCESSING&&F.status!==V.PROCESSING_COMPLETE&&F.status!==V.PROCESSING_REVERT_ERROR);return Promise.all(P.map(M))}return Promise.all(D.map(M))},x=(...y)=>{const D=Array.isArray(y[0])?y[0]:y;let P;typeof D[D.length-1]=="object"?P=D.pop():Array.isArray(y[0])&&(P=y[1]);const F=G();return D.length?D.map(B=>qe(B)?F[B]?F[B].id:null:B).filter(B=>B).map(B=>w(B,P)):Promise.all(F.map(B=>w(B,P)))},U={...nn(),...p,...jl(r,n),setOptions:I,addFile:b,addFiles:v,getFile:T,processFile:M,prepareFile:S,removeFile:w,moveFile:(y,D)=>r.dispatch("MOVE_ITEM",{query:y,index:D}),getFiles:G,processFiles:C,removeFiles:x,prepareFiles:N,sort:y=>r.dispatch("SORT",{compare:y}),browse:()=>{var y=f.element.querySelector("input[type=file]");y&&y.click()},destroy:()=>{U.fire("destroy",f.element),r.dispatch("ABORT_ALL"),f._destroy(),window.removeEventListener("resize",c),document.removeEventListener("visibilitychange",s),r.dispatch("DID_DESTROY")},insertBefore:y=>Sr(f.element,y),insertAfter:y=>vr(f.element,y),appendTo:y=>y.appendChild(f.element),replaceElement:y=>{Sr(f.element,y),y.parentNode.removeChild(y),t=y},restoreElement:()=>{t&&(vr(t,f.element),f.element.parentNode.removeChild(f.element),t=null)},isAttachedTo:y=>f.element===y||t===y,element:{get:()=>f.element},status:{get:()=>r.query("GET_STATUS")}};return r.dispatch("DID_INIT"),$e(U)},xi=(e={})=>{const t={};return J(Xt(),(r,s)=>{t[r]=s[0]}),Uu({...t,...e})},Bu=e=>e.charAt(0).toLowerCase()+e.slice(1),ju=e=>Di(e.replace(/^data-/,"")),bi=(e,t)=>{J(t,(n,r)=>{J(e,(s,i)=>{const a=new RegExp(n);if(!a.test(s)||(delete e[s],r===!1))return;if(Ee(r)){e[r]=i;return}const l=r.group;de(r)&&!e[l]&&(e[l]={}),e[l][Bu(s.replace(a,""))]=i}),r.mapping&&bi(e[r.group],r.mapping)})},Vu=(e,t={})=>{const n=[];J(e.attributes,s=>{n.push(e.attributes[s])});const r=n.filter(s=>s.name).reduce((s,i)=>{const a=oe(e,i.name);return s[ju(i.name)]=a===i.name?!0:a,s},{});return bi(r,t),r},Hu=(e,t={})=>{const n={"^class$":"className","^multiple$":"allowMultiple","^capture$":"captureMethod","^webkitdirectory$":"allowDirectoriesOnly","^server":{group:"server",mapping:{"^process":{group:"process"},"^revert":{group:"revert"},"^fetch":{group:"fetch"},"^restore":{group:"restore"},"^load":{group:"load"}}},"^type$":!1,"^files$":!1};tt("SET_ATTRIBUTE_TO_OPTION_MAP",n);const r={...t},s=Vu(e.nodeName==="FIELDSET"?e.querySelector("input[type=file]"):e,n);Object.keys(s).forEach(a=>{de(s[a])?(de(r[a])||(r[a]={}),Object.assign(r[a],s[a])):r[a]=s[a]}),r.files=(t.files||[]).concat(Array.from(e.querySelectorAll("input:not([type=file])")).map(a=>({source:a.value,options:{type:a.dataset.type}})));const i=xi(r);return e.files&&Array.from(e.files).forEach(a=>{i.addFile(a)}),i.replaceElement(e),i},ku=(...e)=>Jo(e[0])?Hu(...e):xi(...e),$u=["fire","_read","_write"],ns=e=>{const t={};return Ks(e,t,$u),t},Wu=(e,t)=>e.replace(/(?:{([a-zA-Z]+)})/g,(n,r)=>t[r]),zu=e=>{const t=new Blob(["(",e.toString(),")()"],{type:"application/javascript"}),n=URL.createObjectURL(t),r=new Worker(n);return{transfer:(s,i)=>{},post:(s,i,a)=>{const o=Wn();r.onmessage=l=>{l.data.id===o&&i(l.data.message)},r.postMessage({id:o,message:s},a)},terminate:()=>{r.terminate(),URL.revokeObjectURL(n)}}},Yu=e=>new Promise((t,n)=>{const r=new Image;r.onload=()=>{t(r)},r.onerror=s=>{n(s)},r.src=e}),Mi=(e,t)=>{const n=e.slice(0,e.size,e.type);return n.lastModifiedDate=e.lastModifiedDate,n.name=t,n},qu=e=>Mi(e,e.name),rs=[],Xu=e=>{if(rs.includes(e))return;rs.push(e);const t=e({addFilter:Yl,utils:{Type:A,forin:J,isString:Ee,isFile:Je,toNaturalFileSize:di,replaceInString:Wu,getExtensionFromFilename:rn,getFilenameWithoutExtension:oi,guesstimateMimeType:Ri,getFileFromBlob:ct,getFilenameFromURL:Dt,createRoute:he,createWorker:zu,createView:ie,createItemAPI:Re,loadImage:Yu,copyFile:qu,renameFile:Mi,createBlob:si,applyFilterChain:Me,text:ne,getNumericAspectRatioFromString:ti},views:{fileActionButton:ci}});ql(t.options)},Qu=()=>Object.prototype.toString.call(window.operamini)==="[object OperaMini]",Zu=()=>"Promise"in window,Ku=()=>"slice"in Blob.prototype,Ju=()=>"URL"in window&&"createObjectURL"in window.URL,ef=()=>"visibilityState"in document,tf=()=>"performance"in window,nf=()=>"supports"in(window.CSS||{}),rf=()=>/MSIE|Trident/.test(window.navigator.userAgent),Ln=(()=>{const e=zs()&&!Qu()&&ef()&&Zu()&&Ku()&&Ju()&&tf()&&(nf()||rf());return()=>e})(),ke={apps:[]},sf="filepond",nt=()=>{};let ss={},$t=nt,gn=nt,is=nt,as=nt,Gn=nt,os=nt,ls=nt;if(Ln()){vl(()=>{ke.apps.forEach(n=>n._read())},n=>{ke.apps.forEach(r=>r._write(n))});const e=()=>{document.dispatchEvent(new CustomEvent("FilePond:loaded",{detail:{supported:Ln,create:$t,destroy:gn,parse:is,find:as,registerPlugin:Gn,setOptions:ls}})),document.removeEventListener("DOMContentLoaded",e)};document.readyState!=="loading"?setTimeout(()=>e(),0):document.addEventListener("DOMContentLoaded",e);const t=()=>J(Xt(),(n,r)=>{ss[n]=r[1]});ss={},t(),$t=(...n)=>{const r=ku(...n);return r.on("destroy",gn),ke.apps.push(r),ns(r)},gn=n=>{const r=ke.apps.findIndex(s=>s.isAttachedTo(n));return r>=0?(ke.apps.splice(r,1)[0].restoreElement(),!0):!1},is=n=>Array.from(n.querySelectorAll(`.${sf}`)).filter(i=>!ke.apps.find(a=>a.isAttachedTo(i))).map(i=>$t(i)),as=n=>{const r=ke.apps.find(s=>s.isAttachedTo(n));return r?ns(r):null},Gn=(...n)=>{n.forEach(Xu),t()},os=()=>{const n={};return J(Xt(),(r,s)=>{n[r]=s[0]}),n},ls=n=>(de(n)&&(ke.apps.forEach(r=>{r.setOptions(n)}),Xl(n)),os())}/*!
 * react-filepond v7.1.3
 * A handy FilePond adapter component for React
 * 
 * Copyright (c) 2024 PQINA
 * https://pqina.nl/filepond
 * 
 * Licensed under the MIT license.
 */const af=Ln(),of=["setOptions","on","off","onOnce","appendTo","insertAfter","insertBefore","isAttachedTo","replaceElement","restoreElement","destroy"];class lf extends L.Component{constructor(t){super(t),this.allowFilesSync=!0}componentDidMount(){if(this._input=this._element.querySelector('input[type="file"]'),this._inputClone=this._input.cloneNode(),!af)return;const t=Object.assign({},this.props);if(t.onupdatefiles){const n=t.onupdatefiles;t.onupdatefiles=r=>{this.allowFilesSync=!1,n(r)}}this._pond=$t(this._input,t),Object.keys(this._pond).filter(n=>!of.includes(n)).forEach(n=>{this[n]=this._pond[n]})}componentWillUnmount(){if(!this._pond)return;const t=document.createElement("div");t.append(this._pond.element),t.id="foo",this._pond.destroy(),this._pond=void 0,this._element.append(this._inputClone)}shouldComponentUpdate(){return this.allowFilesSync?!0:(this.allowFilesSync=!0,!1)}componentDidUpdate(){if(!this._pond)return;const t=Object.assign({},this.props);delete t.onupdatefiles,this._pond.setOptions(t)}render(){const{id:t,name:n,className:r,allowMultiple:s,required:i,captureMethod:a,acceptedFileTypes:o}=this.props;return z.createElement("div",{className:"filepond--wrapper",ref:l=>this._element=l},z.createElement("input",{type:"file",name:n,id:t,accept:o,multiple:s,required:i,className:r,capture:a}))}}/*!
 * FilePondPluginImagePreview 4.6.12
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const cf=e=>/^image/.test(e.type),cs=(e,t)=>vt(e.x*t,e.y*t),ds=(e,t)=>vt(e.x+t.x,e.y+t.y),df=e=>{const t=Math.sqrt(e.x*e.x+e.y*e.y);return t===0?{x:0,y:0}:vt(e.x/t,e.y/t)},jt=(e,t,n)=>{const r=Math.cos(t),s=Math.sin(t),i=vt(e.x-n.x,e.y-n.y);return vt(n.x+r*i.x-s*i.y,n.y+s*i.x+r*i.y)},vt=(e=0,t=0)=>({x:e,y:t}),we=(e,t,n=1,r)=>{if(typeof e=="string")return parseFloat(e)*n;if(typeof e=="number")return e*(r?t[r]:Math.min(t.width,t.height))},uf=(e,t,n)=>{const r=e.borderStyle||e.lineStyle||"solid",s=e.backgroundColor||e.fontColor||"transparent",i=e.borderColor||e.lineColor||"transparent",a=we(e.borderWidth||e.lineWidth,t,n),o=e.lineCap||"round",l=e.lineJoin||"round",u=typeof r=="string"?"":r.map(f=>we(f,t,n)).join(","),c=e.opacity||1;return{"stroke-linecap":o,"stroke-linejoin":l,"stroke-width":a||0,"stroke-dasharray":u,stroke:i,fill:s,opacity:c}},Oe=e=>e!=null,ff=(e,t,n=1)=>{let r=we(e.x,t,n,"width")||we(e.left,t,n,"width"),s=we(e.y,t,n,"height")||we(e.top,t,n,"height"),i=we(e.width,t,n,"width"),a=we(e.height,t,n,"height"),o=we(e.right,t,n,"width"),l=we(e.bottom,t,n,"height");return Oe(s)||(Oe(a)&&Oe(l)?s=t.height-a-l:s=l),Oe(r)||(Oe(i)&&Oe(o)?r=t.width-i-o:r=o),Oe(i)||(Oe(r)&&Oe(o)?i=t.width-r-o:i=0),Oe(a)||(Oe(s)&&Oe(l)?a=t.height-s-l:a=0),{x:r||0,y:s||0,width:i||0,height:a||0}},pf=e=>e.map((t,n)=>`${n===0?"M":"L"} ${t.x} ${t.y}`).join(" "),Ge=(e,t)=>Object.keys(t).forEach(n=>e.setAttribute(n,t[n])),mf="http://www.w3.org/2000/svg",ot=(e,t)=>{const n=document.createElementNS(mf,e);return t&&Ge(n,t),n},Ef=e=>Ge(e,{...e.rect,...e.styles}),hf=e=>{const t=e.rect.x+e.rect.width*.5,n=e.rect.y+e.rect.height*.5,r=e.rect.width*.5,s=e.rect.height*.5;return Ge(e,{cx:t,cy:n,rx:r,ry:s,...e.styles})},gf={contain:"xMidYMid meet",cover:"xMidYMid slice"},If=(e,t)=>{Ge(e,{...e.rect,...e.styles,preserveAspectRatio:gf[t.fit]||"none"})},_f={left:"start",center:"middle",right:"end"},Tf=(e,t,n,r)=>{const s=we(t.fontSize,n,r),i=t.fontFamily||"sans-serif",a=t.fontWeight||"normal",o=_f[t.textAlign]||"start";Ge(e,{...e.rect,...e.styles,"stroke-width":0,"font-weight":a,"font-size":s,"font-family":i,"text-anchor":o}),e.text!==t.text&&(e.text=t.text,e.textContent=t.text.length?t.text:" ")},Rf=(e,t,n,r)=>{Ge(e,{...e.rect,...e.styles,fill:"none"});const s=e.childNodes[0],i=e.childNodes[1],a=e.childNodes[2],o=e.rect,l={x:e.rect.x+e.rect.width,y:e.rect.y+e.rect.height};if(Ge(s,{x1:o.x,y1:o.y,x2:l.x,y2:l.y}),!t.lineDecoration)return;i.style.display="none",a.style.display="none";const u=df({x:l.x-o.x,y:l.y-o.y}),c=we(.05,n,r);if(t.lineDecoration.indexOf("arrow-begin")!==-1){const f=cs(u,c),E=ds(o,f),h=jt(o,2,E),p=jt(o,-2,E);Ge(i,{style:"display:block;",d:`M${h.x},${h.y} L${o.x},${o.y} L${p.x},${p.y}`})}if(t.lineDecoration.indexOf("arrow-end")!==-1){const f=cs(u,-c),E=ds(l,f),h=jt(l,2,E),p=jt(l,-2,E);Ge(a,{style:"display:block;",d:`M${h.x},${h.y} L${l.x},${l.y} L${p.x},${p.y}`})}},wf=(e,t,n,r)=>{Ge(e,{...e.styles,fill:"none",d:pf(t.points.map(s=>({x:we(s.x,n,r,"width"),y:we(s.y,n,r,"height")})))})},Vt=e=>t=>ot(e,{id:t.id}),yf=e=>{const t=ot("image",{id:e.id,"stroke-linecap":"round","stroke-linejoin":"round",opacity:"0"});return t.onload=()=>{t.setAttribute("opacity",e.opacity||1)},t.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",e.src),t},Sf=e=>{const t=ot("g",{id:e.id,"stroke-linecap":"round","stroke-linejoin":"round"}),n=ot("line");t.appendChild(n);const r=ot("path");t.appendChild(r);const s=ot("path");return t.appendChild(s),t},vf={image:yf,rect:Vt("rect"),ellipse:Vt("ellipse"),text:Vt("text"),path:Vt("path"),line:Sf},Af={rect:Ef,ellipse:hf,image:If,text:Tf,path:wf,line:Rf},Df=(e,t)=>vf[e](t),Of=(e,t,n,r,s)=>{t!=="path"&&(e.rect=ff(n,r,s)),e.styles=uf(n,r,s),Af[t](e,n,r,s)},xf=["x","y","left","top","right","bottom","width","height"],bf=e=>typeof e=="string"&&/%/.test(e)?parseFloat(e)/100:e,Mf=e=>{const[t,n]=e,r=n.points?{}:xf.reduce((s,i)=>(s[i]=bf(n[i]),s),{});return[t,{zIndex:0,...n,...r}]},Cf=(e,t)=>e[1].zIndex>t[1].zIndex?1:e[1].zIndex<t[1].zIndex?-1:0,Nf=e=>e.utils.createView({name:"image-preview-markup",tag:"svg",ignoreRect:!0,mixins:{apis:["width","height","crop","markup","resize","dirty"]},write:({root:t,props:n})=>{if(!n.dirty)return;const{crop:r,resize:s,markup:i}=n,a=n.width,o=n.height;let l=r.width,u=r.height;if(s){const{size:h}=s;let p=h&&h.width,g=h&&h.height;const R=s.mode,_=s.upscale;p&&!g&&(g=p),g&&!p&&(p=g);const m=l<p&&u<g;if(!m||m&&_){let I=p/l,T=g/u;if(R==="force")l=p,u=g;else{let S;R==="cover"?S=Math.max(I,T):R==="contain"&&(S=Math.min(I,T)),l=l*S,u=u*S}}}const c={width:a,height:o};t.element.setAttribute("width",c.width),t.element.setAttribute("height",c.height);const f=Math.min(a/l,o/u);t.element.innerHTML="";const E=t.query("GET_IMAGE_PREVIEW_MARKUP_FILTER");i.filter(E).map(Mf).sort(Cf).forEach(h=>{const[p,g]=h,R=Df(p,g);Of(R,p,g,c,f),t.element.appendChild(R)})}}),yt=(e,t)=>({x:e,y:t}),Pf=(e,t)=>e.x*t.x+e.y*t.y,us=(e,t)=>yt(e.x-t.x,e.y-t.y),Lf=(e,t)=>Pf(us(e,t),us(e,t)),fs=(e,t)=>Math.sqrt(Lf(e,t)),ps=(e,t)=>{const n=e,r=1.5707963267948966,s=t,i=1.5707963267948966-t,a=Math.sin(r),o=Math.sin(s),l=Math.sin(i),u=Math.cos(i),c=n/a,f=c*o,E=c*l;return yt(u*f,u*E)},Gf=(e,t)=>{const n=e.width,r=e.height,s=ps(n,t),i=ps(r,t),a=yt(e.x+Math.abs(s.x),e.y-Math.abs(s.y)),o=yt(e.x+e.width+Math.abs(i.y),e.y+Math.abs(i.x)),l=yt(e.x-Math.abs(i.y),e.y+e.height-Math.abs(i.x));return{width:fs(a,o),height:fs(a,l)}},Ff=(e,t,n=1)=>{const r=e.height/e.width;let s=1,i=t,a=1,o=r;o>i&&(o=i,a=o/r);const l=Math.max(s/a,i/o),u=e.width/(n*l*a),c=u*t;return{width:u,height:c}},Ci=(e,t,n,r)=>{const s=r.x>.5?1-r.x:r.x,i=r.y>.5?1-r.y:r.y,a=s*2*e.width,o=i*2*e.height,l=Gf(t,n);return Math.max(l.width/a,l.height/o)},Ni=(e,t)=>{let n=e.width,r=n*t;r>e.height&&(r=e.height,n=r/t);const s=(e.width-n)*.5,i=(e.height-r)*.5;return{x:s,y:i,width:n,height:r}},Uf=(e,t={})=>{let{zoom:n,rotation:r,center:s,aspectRatio:i}=t;i||(i=e.height/e.width);const a=Ff(e,i,n),o={width:a.width,height:a.height},l=typeof t.scaleToFit>"u"||t.scaleToFit,u=Ci(e,Ni(o,i),r,l?s:{x:.5,y:.5}),c=n*u;return{widthFloat:a.width/c,heightFloat:a.height/c,width:Math.round(a.width/c),height:Math.round(a.height/c)}},Le={type:"spring",stiffness:.5,damping:.45,mass:10},Bf=e=>e.utils.createView({name:"image-bitmap",ignoreRect:!0,mixins:{styles:["scaleX","scaleY"]},create:({root:t,props:n})=>{t.appendChild(n.image)}}),jf=e=>e.utils.createView({name:"image-canvas-wrapper",tag:"div",ignoreRect:!0,mixins:{apis:["crop","width","height"],styles:["originX","originY","translateX","translateY","scaleX","scaleY","rotateZ"],animations:{originX:Le,originY:Le,scaleX:Le,scaleY:Le,translateX:Le,translateY:Le,rotateZ:Le}},create:({root:t,props:n})=>{n.width=n.image.width,n.height=n.image.height,t.ref.bitmap=t.appendChildView(t.createChildView(Bf(e),{image:n.image}))},write:({root:t,props:n})=>{const{flip:r}=n.crop,{bitmap:s}=t.ref;s.scaleX=r.horizontal?-1:1,s.scaleY=r.vertical?-1:1}}),Vf=e=>e.utils.createView({name:"image-clip",tag:"div",ignoreRect:!0,mixins:{apis:["crop","markup","resize","width","height","dirty","background"],styles:["width","height","opacity"],animations:{opacity:{type:"tween",duration:250}}},didWriteView:function({root:t,props:n}){n.background&&(t.element.style.backgroundColor=n.background)},create:({root:t,props:n})=>{t.ref.image=t.appendChildView(t.createChildView(jf(e),Object.assign({},n))),t.ref.createMarkup=()=>{t.ref.markup||(t.ref.markup=t.appendChildView(t.createChildView(Nf(e),Object.assign({},n))))},t.ref.destroyMarkup=()=>{t.ref.markup&&(t.removeChildView(t.ref.markup),t.ref.markup=null)};const r=t.query("GET_IMAGE_PREVIEW_TRANSPARENCY_INDICATOR");r!==null&&(r==="grid"?t.element.dataset.transparencyIndicator=r:t.element.dataset.transparencyIndicator="color")},write:({root:t,props:n,shouldOptimize:r})=>{const{crop:s,markup:i,resize:a,dirty:o,width:l,height:u}=n;t.ref.image.crop=s;const c={width:l,height:u,center:{x:l*.5,y:u*.5}},f={width:t.ref.image.width,height:t.ref.image.height},E={x:s.center.x*f.width,y:s.center.y*f.height},h={x:c.center.x-f.width*s.center.x,y:c.center.y-f.height*s.center.y},p=Math.PI*2+s.rotation%(Math.PI*2),g=s.aspectRatio||f.height/f.width,R=typeof s.scaleToFit>"u"||s.scaleToFit,_=Ci(f,Ni(c,g),p,R?s.center:{x:.5,y:.5}),m=s.zoom*_;i&&i.length?(t.ref.createMarkup(),t.ref.markup.width=l,t.ref.markup.height=u,t.ref.markup.resize=a,t.ref.markup.dirty=o,t.ref.markup.markup=i,t.ref.markup.crop=Uf(f,s)):t.ref.markup&&t.ref.destroyMarkup();const I=t.ref.image;if(r){I.originX=null,I.originY=null,I.translateX=null,I.translateY=null,I.rotateZ=null,I.scaleX=null,I.scaleY=null;return}I.originX=E.x,I.originY=E.y,I.translateX=h.x,I.translateY=h.y,I.rotateZ=p,I.scaleX=m,I.scaleY=m}}),Hf=e=>e.utils.createView({name:"image-preview",tag:"div",ignoreRect:!0,mixins:{apis:["image","crop","markup","resize","dirty","background"],styles:["translateY","scaleX","scaleY","opacity"],animations:{scaleX:Le,scaleY:Le,translateY:Le,opacity:{type:"tween",duration:400}}},create:({root:t,props:n})=>{t.ref.clip=t.appendChildView(t.createChildView(Vf(e),{id:n.id,image:n.image,crop:n.crop,markup:n.markup,resize:n.resize,dirty:n.dirty,background:n.background}))},write:({root:t,props:n,shouldOptimize:r})=>{const{clip:s}=t.ref,{image:i,crop:a,markup:o,resize:l,dirty:u}=n;if(s.crop=a,s.markup=o,s.resize=l,s.dirty=u,s.opacity=r?0:1,r||t.rect.element.hidden)return;const c=i.height/i.width;let f=a.aspectRatio||c;const E=t.rect.inner.width,h=t.rect.inner.height;let p=t.query("GET_IMAGE_PREVIEW_HEIGHT");const g=t.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),R=t.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),_=t.query("GET_PANEL_ASPECT_RATIO"),m=t.query("GET_ALLOW_MULTIPLE");_&&!m&&(p=E*_,f=_);let I=p!==null?p:Math.max(g,Math.min(E*f,R)),T=I/f;T>E&&(T=E,I=T*f),I>h&&(I=h,T=h/f),s.width=T,s.height=I}});let kf=`<svg width="500" height="200" viewBox="0 0 500 200" preserveAspectRatio="none">
    <defs>
        <radialGradient id="gradient-__UID__" cx=".5" cy="1.25" r="1.15">
            <stop offset='50%' stop-color='#000000'/>
            <stop offset='56%' stop-color='#0a0a0a'/>
            <stop offset='63%' stop-color='#262626'/>
            <stop offset='69%' stop-color='#4f4f4f'/>
            <stop offset='75%' stop-color='#808080'/>
            <stop offset='81%' stop-color='#b1b1b1'/>
            <stop offset='88%' stop-color='#dadada'/>
            <stop offset='94%' stop-color='#f6f6f6'/>
            <stop offset='100%' stop-color='#ffffff'/>
        </radialGradient>
        <mask id="mask-__UID__">
            <rect x="0" y="0" width="500" height="200" fill="url(#gradient-__UID__)"></rect>
        </mask>
    </defs>
    <rect x="0" width="500" height="200" fill="currentColor" mask="url(#mask-__UID__)"></rect>
</svg>`,ms=0;const $f=e=>e.utils.createView({name:"image-preview-overlay",tag:"div",ignoreRect:!0,create:({root:t,props:n})=>{let r=kf;if(document.querySelector("base")){const s=new URL(window.location.href.replace(window.location.hash,"")).href;r=r.replace(/url\(\#/g,"url("+s+"#")}ms++,t.element.classList.add(`filepond--image-preview-overlay-${n.status}`),t.element.innerHTML=r.replace(/__UID__/g,ms)},mixins:{styles:["opacity"],animations:{opacity:{type:"spring",mass:25}}}}),Wf=function(){self.onmessage=e=>{createImageBitmap(e.data.message.file).then(t=>{self.postMessage({id:e.data.id,message:t},[t])})}},zf=function(){self.onmessage=e=>{const t=e.data.message.imageData,n=e.data.message.colorMatrix,r=t.data,s=r.length,i=n[0],a=n[1],o=n[2],l=n[3],u=n[4],c=n[5],f=n[6],E=n[7],h=n[8],p=n[9],g=n[10],R=n[11],_=n[12],m=n[13],I=n[14],T=n[15],S=n[16],b=n[17],O=n[18],w=n[19];let v=0,G=0,M=0,N=0,C=0;for(;v<s;v+=4)G=r[v]/255,M=r[v+1]/255,N=r[v+2]/255,C=r[v+3]/255,r[v]=Math.max(0,Math.min((G*i+M*a+N*o+C*l+u)*255,255)),r[v+1]=Math.max(0,Math.min((G*c+M*f+N*E+C*h+p)*255,255)),r[v+2]=Math.max(0,Math.min((G*g+M*R+N*_+C*m+I)*255,255)),r[v+3]=Math.max(0,Math.min((G*T+M*S+N*b+C*O+w)*255,255));self.postMessage({id:e.data.id,message:t},[t.data.buffer])}},Yf=(e,t)=>{let n=new Image;n.onload=()=>{const r=n.naturalWidth,s=n.naturalHeight;n=null,t(r,s)},n.src=e},qf={1:()=>[1,0,0,1,0,0],2:e=>[-1,0,0,1,e,0],3:(e,t)=>[-1,0,0,-1,e,t],4:(e,t)=>[1,0,0,-1,0,t],5:()=>[0,1,1,0,0,0],6:(e,t)=>[0,1,-1,0,t,0],7:(e,t)=>[0,-1,-1,0,t,e],8:e=>[0,-1,1,0,0,e]},Xf=(e,t,n,r)=>{r!==-1&&e.transform.apply(e,qf[r](t,n))},Qf=(e,t,n,r)=>{t=Math.round(t),n=Math.round(n);const s=document.createElement("canvas");s.width=t,s.height=n;const i=s.getContext("2d");return r>=5&&r<=8&&([t,n]=[n,t]),Xf(i,t,n,r),i.drawImage(e,0,0,t,n),s},Pi=e=>/^image/.test(e.type)&&!/svg/.test(e.type),Zf=10,Kf=10,Jf=e=>{const t=Math.min(Zf/e.width,Kf/e.height),n=document.createElement("canvas"),r=n.getContext("2d"),s=n.width=Math.ceil(e.width*t),i=n.height=Math.ceil(e.height*t);r.drawImage(e,0,0,s,i);let a=null;try{a=r.getImageData(0,0,s,i).data}catch{return null}const o=a.length;let l=0,u=0,c=0,f=0;for(;f<o;f+=4)l+=a[f]*a[f],u+=a[f+1]*a[f+1],c+=a[f+2]*a[f+2];return l=In(l,o),u=In(u,o),c=In(c,o),{r:l,g:u,b:c}},In=(e,t)=>Math.floor(Math.sqrt(e/(t/4))),ep=(e,t)=>(t=t||document.createElement("canvas"),t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0),t),tp=e=>{let t;try{t=new ImageData(e.width,e.height)}catch{t=document.createElement("canvas").getContext("2d").createImageData(e.width,e.height)}return t.data.set(new Uint8ClampedArray(e.data)),t},np=e=>new Promise((t,n)=>{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{t(r)},r.onerror=s=>{n(s)},r.src=e}),rp=e=>{const t=$f(e),n=Hf(e),{createWorker:r}=e.utils,s=(m,I,T)=>new Promise(S=>{m.ref.imageData||(m.ref.imageData=T.getContext("2d").getImageData(0,0,T.width,T.height));const b=tp(m.ref.imageData);if(!I||I.length!==20)return T.getContext("2d").putImageData(b,0,0),S();const O=r(zf);O.post({imageData:b,colorMatrix:I},w=>{T.getContext("2d").putImageData(w,0,0),O.terminate(),S()},[b.data.buffer])}),i=(m,I)=>{m.removeChildView(I),I.image.width=1,I.image.height=1,I._destroy()},a=({root:m})=>{const I=m.ref.images.shift();return I.opacity=0,I.translateY=-15,m.ref.imageViewBin.push(I),I},o=({root:m,props:I,image:T})=>{const S=I.id,b=m.query("GET_ITEM",{id:S});if(!b)return;const O=b.getMetadata("crop")||{center:{x:.5,y:.5},flip:{horizontal:!1,vertical:!1},zoom:1,rotation:0,aspectRatio:null},w=m.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR");let v,G,M=!1;m.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(v=b.getMetadata("markup")||[],G=b.getMetadata("resize"),M=!0);const N=m.appendChildView(m.createChildView(n,{id:S,image:T,crop:O,resize:G,markup:v,dirty:M,background:w,opacity:0,scaleX:1.15,scaleY:1.15,translateY:15}),m.childViews.length);m.ref.images.push(N),N.opacity=1,N.scaleX=1,N.scaleY=1,N.translateY=0,setTimeout(()=>{m.dispatch("DID_IMAGE_PREVIEW_SHOW",{id:S})},250)},l=({root:m,props:I})=>{const T=m.query("GET_ITEM",{id:I.id});if(!T)return;const S=m.ref.images[m.ref.images.length-1];S.crop=T.getMetadata("crop"),S.background=m.query("GET_IMAGE_TRANSFORM_CANVAS_BACKGROUND_COLOR"),m.query("GET_IMAGE_PREVIEW_MARKUP_SHOW")&&(S.dirty=!0,S.resize=T.getMetadata("resize"),S.markup=T.getMetadata("markup"))},u=({root:m,props:I,action:T})=>{if(!/crop|filter|markup|resize/.test(T.change.key)||!m.ref.images.length)return;const S=m.query("GET_ITEM",{id:I.id});if(S){if(/filter/.test(T.change.key)){const b=m.ref.images[m.ref.images.length-1];s(m,T.change.value,b.image);return}if(/crop|markup|resize/.test(T.change.key)){const b=S.getMetadata("crop"),O=m.ref.images[m.ref.images.length-1];if(b&&b.aspectRatio&&O.crop&&O.crop.aspectRatio&&Math.abs(b.aspectRatio-O.crop.aspectRatio)>1e-5){const w=a({root:m});o({root:m,props:I,image:ep(w.image)})}else l({root:m,props:I})}}},c=m=>{const T=window.navigator.userAgent.match(/Firefox\/([0-9]+)\./),S=T?parseInt(T[1]):null;return S!==null&&S<=58?!1:"createImageBitmap"in window&&Pi(m)},f=({root:m,props:I})=>{const{id:T}=I,S=m.query("GET_ITEM",T);if(!S)return;const b=URL.createObjectURL(S.file);Yf(b,(O,w)=>{m.dispatch("DID_IMAGE_PREVIEW_CALCULATE_SIZE",{id:T,width:O,height:w})})},E=({root:m,props:I})=>{const{id:T}=I,S=m.query("GET_ITEM",T);if(!S)return;const b=URL.createObjectURL(S.file),O=()=>{np(b).then(w)},w=v=>{URL.revokeObjectURL(b);const M=(S.getMetadata("exif")||{}).orientation||-1;let{width:N,height:C}=v;if(!N||!C)return;M>=5&&M<=8&&([N,C]=[C,N]);const x=Math.max(1,window.devicePixelRatio*.75),y=m.query("GET_IMAGE_PREVIEW_ZOOM_FACTOR")*x,D=C/N,P=m.rect.element.width,F=m.rect.element.height;let W=P,B=W*D;D>1?(W=Math.min(N,P*y),B=W*D):(B=Math.min(C,F*y),W=B/D);const ve=Qf(v,W,B,M),ge=()=>{const Ue=m.query("GET_IMAGE_PREVIEW_CALCULATE_AVERAGE_IMAGE_COLOR")?Jf(data):null;S.setMetadata("color",Ue,!0),"close"in v&&v.close(),m.ref.overlayShadow.opacity=1,o({root:m,props:I,image:ve})},le=S.getMetadata("filter");le?s(m,le,ve).then(ge):ge()};if(c(S.file)){const v=r(Wf);v.post({file:S.file},G=>{if(v.terminate(),!G){O();return}w(G)})}else O()},h=({root:m})=>{const I=m.ref.images[m.ref.images.length-1];I.translateY=0,I.scaleX=1,I.scaleY=1,I.opacity=1},p=({root:m})=>{m.ref.overlayShadow.opacity=1,m.ref.overlayError.opacity=0,m.ref.overlaySuccess.opacity=0},g=({root:m})=>{m.ref.overlayShadow.opacity=.25,m.ref.overlayError.opacity=1},R=({root:m})=>{m.ref.overlayShadow.opacity=.25,m.ref.overlaySuccess.opacity=1},_=({root:m})=>{m.ref.images=[],m.ref.imageData=null,m.ref.imageViewBin=[],m.ref.overlayShadow=m.appendChildView(m.createChildView(t,{opacity:0,status:"idle"})),m.ref.overlaySuccess=m.appendChildView(m.createChildView(t,{opacity:0,status:"success"})),m.ref.overlayError=m.appendChildView(m.createChildView(t,{opacity:0,status:"failure"}))};return e.utils.createView({name:"image-preview-wrapper",create:_,styles:["height"],apis:["height"],destroy:({root:m})=>{m.ref.images.forEach(I=>{I.image.width=1,I.image.height=1})},didWriteView:({root:m})=>{m.ref.images.forEach(I=>{I.dirty=!1})},write:e.utils.createRoute({DID_IMAGE_PREVIEW_DRAW:h,DID_IMAGE_PREVIEW_CONTAINER_CREATE:f,DID_FINISH_CALCULATE_PREVIEWSIZE:E,DID_UPDATE_ITEM_METADATA:u,DID_THROW_ITEM_LOAD_ERROR:g,DID_THROW_ITEM_PROCESSING_ERROR:g,DID_THROW_ITEM_INVALID:g,DID_COMPLETE_ITEM_PROCESSING:R,DID_START_ITEM_PROCESSING:p,DID_REVERT_ITEM_PROCESSING:p},({root:m})=>{const I=m.ref.imageViewBin.filter(T=>T.opacity===0);m.ref.imageViewBin=m.ref.imageViewBin.filter(T=>T.opacity>0),I.forEach(T=>i(m,T)),I.length=0})})},Li=e=>{const{addFilter:t,utils:n}=e,{Type:r,createRoute:s,isFile:i}=n,a=rp(e);return t("CREATE_VIEW",o=>{const{is:l,view:u,query:c}=o;if(!l("file")||!c("GET_ALLOW_IMAGE_PREVIEW"))return;const f=({root:R,props:_})=>{const{id:m}=_,I=c("GET_ITEM",m);if(!I||!i(I.file)||I.archived)return;const T=I.file;if(!cf(T)||!c("GET_IMAGE_PREVIEW_FILTER_ITEM")(I))return;const S="createImageBitmap"in(window||{}),b=c("GET_IMAGE_PREVIEW_MAX_FILE_SIZE");if(!S&&b&&T.size>b)return;R.ref.imagePreview=u.appendChildView(u.createChildView(a,{id:m}));const O=R.query("GET_IMAGE_PREVIEW_HEIGHT");O&&R.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:I.id,height:O});const w=!S&&T.size>c("GET_IMAGE_PREVIEW_MAX_INSTANT_PREVIEW_FILE_SIZE");R.dispatch("DID_IMAGE_PREVIEW_CONTAINER_CREATE",{id:m},w)},E=(R,_)=>{if(!R.ref.imagePreview)return;let{id:m}=_;const I=R.query("GET_ITEM",{id:m});if(!I)return;const T=R.query("GET_PANEL_ASPECT_RATIO"),S=R.query("GET_ITEM_PANEL_ASPECT_RATIO"),b=R.query("GET_IMAGE_PREVIEW_HEIGHT");if(T||S||b)return;let{imageWidth:O,imageHeight:w}=R.ref;if(!O||!w)return;const v=R.query("GET_IMAGE_PREVIEW_MIN_HEIGHT"),G=R.query("GET_IMAGE_PREVIEW_MAX_HEIGHT"),N=(I.getMetadata("exif")||{}).orientation||-1;if(N>=5&&N<=8&&([O,w]=[w,O]),!Pi(I.file)||R.query("GET_IMAGE_PREVIEW_UPSCALE")){const P=2048/O;O*=P,w*=P}const C=w/O,x=(I.getMetadata("crop")||{}).aspectRatio||C;let U=Math.max(v,Math.min(w,G));const y=R.rect.element.width,D=Math.min(y*x,U);R.dispatch("DID_UPDATE_PANEL_HEIGHT",{id:I.id,height:D})},h=({root:R})=>{R.ref.shouldRescale=!0},p=({root:R,action:_})=>{_.change.key==="crop"&&(R.ref.shouldRescale=!0)},g=({root:R,action:_})=>{R.ref.imageWidth=_.width,R.ref.imageHeight=_.height,R.ref.shouldRescale=!0,R.ref.shouldDrawPreview=!0,R.dispatch("KICK")};u.registerWriter(s({DID_RESIZE_ROOT:h,DID_STOP_RESIZE:h,DID_LOAD_ITEM:f,DID_IMAGE_PREVIEW_CALCULATE_SIZE:g,DID_UPDATE_ITEM_METADATA:p},({root:R,props:_})=>{R.ref.imagePreview&&(R.rect.element.hidden||(R.ref.shouldRescale&&(E(R,_),R.ref.shouldRescale=!1),R.ref.shouldDrawPreview&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{R.dispatch("DID_FINISH_CALCULATE_PREVIEWSIZE",{id:_.id})})}),R.ref.shouldDrawPreview=!1)))}))}),{options:{allowImagePreview:[!0,r.BOOLEAN],imagePreviewFilterItem:[()=>!0,r.FUNCTION],imagePreviewHeight:[null,r.INT],imagePreviewMinHeight:[44,r.INT],imagePreviewMaxHeight:[256,r.INT],imagePreviewMaxFileSize:[null,r.INT],imagePreviewZoomFactor:[2,r.INT],imagePreviewUpscale:[!1,r.BOOLEAN],imagePreviewMaxInstantPreviewFileSize:[1e6,r.INT],imagePreviewTransparencyIndicator:[null,r.STRING],imagePreviewCalculateAverageImageColor:[!1,r.BOOLEAN],imagePreviewMarkupShow:[!0,r.BOOLEAN],imagePreviewMarkupFilter:[()=>!0,r.FUNCTION]}}},sp=typeof window<"u"&&typeof window.document<"u";sp&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Li}));/*!
 * FilePondPluginFileValidateType 1.2.9
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Gi=({addFilter:e,utils:t})=>{const{Type:n,isString:r,replaceInString:s,guesstimateMimeType:i,getExtensionFromFilename:a,getFilenameFromURL:o}=t,l=(h,p)=>{const g=(/^[^/]+/.exec(h)||[]).pop(),R=p.slice(0,-2);return g===R},u=(h,p)=>h.some(g=>/\*$/.test(g)?l(p,g):g===p),c=h=>{let p="";if(r(h)){const g=o(h),R=a(g);R&&(p=i(R))}else p=h.type;return p},f=(h,p,g)=>{if(p.length===0)return!0;const R=c(h);return g?new Promise((_,m)=>{g(h,R).then(I=>{u(p,I)?_():m()}).catch(m)}):u(p,R)},E=h=>p=>h[p]===null?!1:h[p]||p;return e("SET_ATTRIBUTE_TO_OPTION_MAP",h=>Object.assign(h,{accept:"acceptedFileTypes"})),e("ALLOW_HOPPER_ITEM",(h,{query:p})=>p("GET_ALLOW_FILE_TYPE_VALIDATION")?f(h,p("GET_ACCEPTED_FILE_TYPES")):!0),e("LOAD_FILE",(h,{query:p})=>new Promise((g,R)=>{if(!p("GET_ALLOW_FILE_TYPE_VALIDATION")){g(h);return}const _=p("GET_ACCEPTED_FILE_TYPES"),m=p("GET_FILE_VALIDATE_TYPE_DETECT_TYPE"),I=f(h,_,m),T=()=>{const S=_.map(E(p("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES_MAP"))).filter(O=>O!==!1),b=S.filter((O,w)=>S.indexOf(O)===w);R({status:{main:p("GET_LABEL_FILE_TYPE_NOT_ALLOWED"),sub:s(p("GET_FILE_VALIDATE_TYPE_LABEL_EXPECTED_TYPES"),{allTypes:b.join(", "),allButLastType:b.slice(0,-1).join(", "),lastType:b[b.length-1]})}})};if(typeof I=="boolean")return I?g(h):T();I.then(()=>{g(h)}).catch(T)})),{options:{allowFileTypeValidation:[!0,n.BOOLEAN],acceptedFileTypes:[[],n.ARRAY],labelFileTypeNotAllowed:["File is of invalid type",n.STRING],fileValidateTypeLabelExpectedTypes:["Expects {allButLastType} or {lastType}",n.STRING],fileValidateTypeLabelExpectedTypesMap:[{},n.OBJECT],fileValidateTypeDetectType:[null,n.FUNCTION]}}},ip=typeof window<"u"&&typeof window.document<"u";ip&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Gi}));/*!
 * FilePondPluginImageExifOrientation 1.0.11
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const ap=e=>/^image\/jpeg/.test(e.type),ze={JPEG:65496,APP1:65505,EXIF:1165519206,TIFF:18761,Orientation:274,Unknown:65280},Ye=(e,t,n=!1)=>e.getUint16(t,n),Es=(e,t,n=!1)=>e.getUint32(t,n),op=e=>new Promise((t,n)=>{const r=new FileReader;r.onload=function(s){const i=new DataView(s.target.result);if(Ye(i,0)!==ze.JPEG){t(-1);return}const a=i.byteLength;let o=2;for(;o<a;){const l=Ye(i,o);if(o+=2,l===ze.APP1){if(Es(i,o+=2)!==ze.EXIF)break;const u=Ye(i,o+=6)===ze.TIFF;o+=Es(i,o+4,u);const c=Ye(i,o,u);o+=2;for(let f=0;f<c;f++)if(Ye(i,o+f*12,u)===ze.Orientation){t(Ye(i,o+f*12+8,u));return}}else{if((l&ze.Unknown)!==ze.Unknown)break;o+=Ye(i,o)}}t(-1)},r.readAsArrayBuffer(e.slice(0,64*1024))}),lp=typeof window<"u"&&typeof window.document<"u",cp=()=>lp,dp="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4QA6RXhpZgAATU0AKgAAAAgAAwESAAMAAAABAAYAAAEoAAMAAAABAAIAAAITAAMAAAABAAEAAAAAAAD/2wBDAP//////////////////////////////////////////////////////////////////////////////////////wAALCAABAAIBASIA/8QAJgABAAAAAAAAAAAAAAAAAAAAAxABAAAAAAAAAAAAAAAAAAAAAP/aAAgBAQAAPwBH/9k=";let Fi;const Wt=cp()?new Image:{};Wt.onload=()=>Fi=Wt.naturalWidth>Wt.naturalHeight;Wt.src=dp;const up=()=>Fi,Ui=({addFilter:e,utils:t})=>{const{Type:n,isFile:r}=t;return e("DID_LOAD_ITEM",(s,{query:i})=>new Promise((a,o)=>{const l=s.file;if(!r(l)||!ap(l)||!i("GET_ALLOW_IMAGE_EXIF_ORIENTATION")||!up())return a(s);op(l).then(u=>{s.setMetadata("exif",{orientation:u}),a(s)})})),{options:{allowImageExifOrientation:[!0,n.BOOLEAN]}}},fp=typeof window<"u"&&typeof window.document<"u";fp&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Ui}));/*!
 * FilePondPluginFileValidateSize 2.2.8
 * Licensed under MIT, https://opensource.org/licenses/MIT/
 * Please visit https://pqina.nl/filepond/ for details.
 */const Bi=({addFilter:e,utils:t})=>{const{Type:n,replaceInString:r,toNaturalFileSize:s}=t;return e("ALLOW_HOPPER_ITEM",(i,{query:a})=>{if(!a("GET_ALLOW_FILE_SIZE_VALIDATION"))return!0;const o=a("GET_MAX_FILE_SIZE");if(o!==null&&i.size>o)return!1;const l=a("GET_MIN_FILE_SIZE");return!(l!==null&&i.size<l)}),e("LOAD_FILE",(i,{query:a})=>new Promise((o,l)=>{if(!a("GET_ALLOW_FILE_SIZE_VALIDATION"))return o(i);const u=a("GET_FILE_VALIDATE_SIZE_FILTER");if(u&&!u(i))return o(i);const c=a("GET_MAX_FILE_SIZE");if(c!==null&&i.size>c){l({status:{main:a("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:r(a("GET_LABEL_MAX_FILE_SIZE"),{filesize:s(c,".",a("GET_FILE_SIZE_BASE"),a("GET_FILE_SIZE_LABELS",a))})}});return}const f=a("GET_MIN_FILE_SIZE");if(f!==null&&i.size<f){l({status:{main:a("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:r(a("GET_LABEL_MIN_FILE_SIZE"),{filesize:s(f,".",a("GET_FILE_SIZE_BASE"),a("GET_FILE_SIZE_LABELS",a))})}});return}const E=a("GET_MAX_TOTAL_FILE_SIZE");if(E!==null&&a("GET_ACTIVE_ITEMS").reduce((p,g)=>p+g.fileSize,0)>E){l({status:{main:a("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:r(a("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:s(E,".",a("GET_FILE_SIZE_BASE"),a("GET_FILE_SIZE_LABELS",a))})}});return}o(i)})),{options:{allowFileSizeValidation:[!0,n.BOOLEAN],maxFileSize:[null,n.INT],minFileSize:[null,n.INT],maxTotalFileSize:[null,n.INT],fileValidateSizeFilter:[null,n.FUNCTION],labelMinFileSizeExceeded:["File is too small",n.STRING],labelMinFileSize:["Minimum file size is {filesize}",n.STRING],labelMaxFileSizeExceeded:["File is too large",n.STRING],labelMaxFileSize:["Maximum file size is {filesize}",n.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",n.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",n.STRING]}}},pp=typeof window<"u"&&typeof window.document<"u";pp&&document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:Bi}));Gn(Li,Gi,Ui,Bi);function mp({selectedCollection:e,onFileUploaded:t,onError:n}){const r=Un(),[s,i]=z.useState([]),a=z.useRef(null);return d.jsx("div",{className:"mb-6",children:d.jsx(lf,{ref:a,files:s,onupdatefiles:i,allowMultiple:!0,maxFiles:10,server:{process:(o,l,u,c,f,E,h,p,g)=>{const R=new FormData;R.append("file",l),R.append("collection_name",e!=="all"?e:"default");const _=new XMLHttpRequest;return _.open("POST",r("novus.media.upload")),_.upload.onprogress=m=>{E(m.lengthComputable,m.loaded,m.total)},_.onload=function(){if(_.status>=200&&_.status<300)try{const m=JSON.parse(_.responseText);if(m.success&&m.media)t(m.media),c(_.responseText);else{const I="Upload failed: "+(m.message||"Unknown error");f(I),n==null||n(I)}}catch{const I="Invalid server response";f(I),n==null||n(I)}else{const m="Server error: "+_.status;f(m),n==null||n(m)}},_.onerror=function(){const m="Network error";f(m),n==null||n(m)},_.send(R),{abort:()=>{_.abort(),h()}}}},name:"file",credits:!1,acceptedFileTypes:["image/*"],fileValidateTypeDetectType:(o,l)=>new Promise(u=>{l&&l.includes("image/")?u(l):u("image/jpeg")}),labelIdle:'Drag & Drop your images or <span class="filepond--label-action">Browse</span>',labelFileTypeNotAllowed:"Only images are allowed",fileValidateTypeLabelExpectedTypes:"Only images are allowed",maxFileSize:"10MB",instantUpload:!0,chunkUploads:!1,className:"filepond-root",allowRevert:!1,onprocessfile:(o,l)=>{!o&&a.current&&a.current.removeFile(l.id)},beforeAddFile:o=>o.fileType.includes("image/")})})}function Ep({selectedCollection:e,onFileUploaded:t,onError:n,isOpen:r,onClose:s}){const[i,a]=z.useState([]),o=u=>{a(c=>c.map(f=>f.file.name===u.name||f.file.name.startsWith(u.name)||u.name.startsWith(f.file.name.replace(/\.[^/.]+$/,""))?{...f,status:"success",progress:100}:f)),t(u)},l=u=>{a(c=>c.filter(f=>f.id!==u))};return d.jsx("div",{className:ue("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm transition-opacity",r?"opacity-100":"opacity-0 pointer-events-none"),children:d.jsxs("div",{className:"fixed inset-x-0 top-0 z-50 sm:inset-x-auto sm:left-1/2 sm:top-1/2 sm:-translate-x-1/2 sm:-translate-y-1/2 sm:max-w-2xl w-full sm:h-auto max-h-[90vh] overflow-y-auto bg-background p-6 shadow-lg rounded-lg border",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4",children:[d.jsx("h2",{className:"text-xl font-semibold",children:"Upload Images"}),d.jsxs(Q,{variant:"ghost",size:"icon",onClick:s,children:[d.jsx(Kt,{className:"w-5 h-5"}),d.jsx("span",{className:"sr-only",children:"Close"})]})]}),d.jsx(mp,{selectedCollection:e,onFileUploaded:o,onError:n}),i.length>0&&d.jsxs("div",{className:"mt-6",children:[d.jsx("h3",{className:"font-medium mb-3",children:"Upload Progress"}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:i.map(u=>d.jsx(Ko,{file:u.file,progress:u.progress,status:u.status,error:u.error,onCancel:()=>l(u.id),preview:u.preview},u.id))})]}),d.jsxs("div",{className:"mt-6 flex justify-end gap-2",children:[d.jsx(Q,{variant:"outline",onClick:s,children:"Cancel"}),d.jsx(Q,{onClick:s,disabled:i.some(u=>u.status==="uploading"),children:"Done"})]})]})})}function Mp({media:e,collections:t,filters:n={},flash:r}){const s=Un(),{toast:i}=Fa(),[a,o]=z.useState("grid"),[l,u]=z.useState("md"),[c,f]=z.useState(!1),[E,h]=z.useState(!1),[p,g]=z.useState(null),[R,_]=z.useState(!1),[m,I]=z.useState(n.mime_type||"all"),[T,S]=z.useState(n.collection||"all"),[b,O]=z.useState(n.search||""),[w,v]=z.useState([]),[G,M]=z.useState([]),[N,C]=z.useState(!1),[x,U]=z.useState(null),{data:y,setData:D,patch:P,delete:F,processing:W,reset:B}=wa({name:"",alt_text:"",title:"",collection_name:"default",custom_properties:{}});z.useEffect(()=>{p?D({name:p.name,alt_text:p.alt_text||"",title:p.title||"",collection_name:p.collection_name,custom_properties:p.custom_properties||{}}):B()},[p]);const ve=$=>{U(null),M(_e=>[$,..._e]),S("all"),I("all"),O(""),i({title:"Upload Complete",description:`${$.name} has been uploaded successfully`,action:d.jsxs(Et,{altText:"Upload more",onClick:()=>h(!0),children:[d.jsx(Fn,{className:"mr-2 h-4 w-4"}),"Upload More"]})})},ge=$=>{U($),i({variant:"destructive",title:"Upload Failed",description:$,action:d.jsxs(Et,{altText:"Try again",onClick:()=>h(!0),children:[d.jsx(dr,{className:"mr-2 h-4 w-4"}),"Try Again"]})})},le=$=>{$.preventDefault(),st.get(s("novus.media.index"),{search:b,collection:T!=="all"?T:void 0,mime_type:m!=="all"?m:void 0},{preserveState:!0})},Ue=$=>{S($),st.get(s("novus.media.index"),{search:b,collection:$!=="all"?$:void 0,mime_type:m!=="all"?m:void 0},{preserveState:!0})},k=$=>{I($),st.get(s("novus.media.index"),{search:b,collection:T!=="all"?T:void 0,mime_type:$!=="all"?$:void 0},{preserveState:!0})},Z=$=>{v(_e=>_e.includes($)?_e.filter(ft=>ft!==$):[..._e,$])},fe=$=>{g($),f(!0)},ye=()=>{p&&P(s("novus.media.update",p.id),{data:y,onSuccess:()=>{i({title:"Changes Saved",description:"Your changes have been saved successfully"})},onError:$=>{i({variant:"destructive",title:"Update Failed",description:Object.values($).join(", "),action:d.jsxs(Et,{altText:"Try again",onClick:ye,children:[d.jsx(dr,{className:"mr-2 h-4 w-4"}),"Try Again"]})})}})},re=()=>{_(!0)},Ie=()=>{p&&F(s("novus.media.destroy",p.id),{onSuccess:()=>{_(!1),f(!1),g(null),M($=>$.filter(_e=>_e.id!==p.id)),i({title:"Media Deleted",description:`${p.name} has been deleted`})},onError:()=>{i({variant:"destructive",title:"Delete Failed",description:"Failed to delete the media item",action:d.jsxs(Et,{altText:"Try again",onClick:Ie,children:[d.jsx(zt,{className:"mr-2 h-4 w-4"}),"Try Again"]})})}})},ut=()=>{w.length!==0&&(C(!0),st.post(s("novus.media.bulk-destroy"),{ids:w},{onSuccess:()=>{v([]),C(!1),M($=>$.filter(_e=>!w.includes(_e.id))),i({title:"Bulk Delete Complete",description:`${w.length} items have been deleted`})},onError:()=>{C(!1),i({variant:"destructive",title:"Bulk Delete Failed",description:"Failed to delete the selected items",action:d.jsxs(Et,{altText:"Try again",onClick:ut,children:[d.jsx(zt,{className:"mr-2 h-4 w-4"}),"Try Again"]})})}}))},Ot=G.map($=>$.id),H={...e,data:[...G.filter($=>T!=="all"&&$.collection_name!==T||m!=="all"&&m==="image"&&!$.mime_type.startsWith("image/")||b&&!$.name.toLowerCase().includes(b.toLowerCase())?!1:!e.data.some(_e=>_e.id===$.id)),...e.data]};return d.jsxs(Ua,{title:"Media Library",children:[d.jsx(ya,{title:"Image Library"}),d.jsxs("div",{className:"container py-20 max-w-7xl",children:[d.jsx(to,{selectedItems:w,isUploading:E,setSelectedItems:v,handleBulkDelete:ut,onUploadClick:()=>h(!0),isBulkDeleting:N}),d.jsx(no,{success:r==null?void 0:r.success,error:(r==null?void 0:r.error)||x,autoClose:!0}),d.jsx(so,{searchQuery:b,setSearchQuery:O,selectedCollection:T,handleCollectionChange:Ue,selectedMimeType:m,handleMimeTypeChange:k,handleSearch:le,collections:t}),d.jsx(io,{viewMode:a,setViewMode:o,gridSize:l,setGridSize:u,totalItems:H.data.length}),d.jsx(uo,{media:H,viewMode:a,gridSize:l,selectedItems:w,toggleItemSelection:Z,handleMediaClick:fe,searchQuery:b,setSearchQuery:O,selectedCollection:T,setSelectedCollection:S,selectedMimeType:m,setSelectedMimeType:I,onUploadClick:()=>h(!0),recentlyUploadedIds:Ot}),d.jsx(ko,{isOpen:c,onOpenChange:f,selectedMedia:p,collections:t,onUpdate:ye,onDelete:re,formData:y,setData:D,processing:W}),d.jsx($o,{isOpen:R,onOpenChange:_,onConfirm:Ie,media:p,processing:W}),d.jsx(Ep,{selectedCollection:T,onFileUploaded:ve,onError:ge,isOpen:E,onClose:()=>h(!1)})]})]})}export{Mp as default};
