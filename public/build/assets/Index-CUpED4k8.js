import{j as e}from"./ui-vqqFfSzO.js";import{k as le,G,a as g,aI as P,aJ as re,c as ne,S as ie,P as H,n as ce,j as de,aK as oe,o as D,aL as me,X as xe}from"./vendor-BFGeaHkk.js";import{D as he,h as ue,i as pe,j as F,k as je,m as ge,A as fe,C as Ne,a as ve,b as Se,c as be,d as ye}from"./card-CoM3tDin.js";import{B as h,c as M}from"./button-BjyeRwdB.js";import{T as we,a as Ce,b as U,c as u,d as De,e as p}from"./table-C9QjicNN.js";import{C as L}from"./checkbox-o13_neWM.js";import{u as I}from"./app-JU9k0MG1.js";import{E as ke}from"./EmptyState-w3UCVyw-.js";import{P as Ae}from"./PaginationWrapper-DSqg5NLW.js";import{I as _}from"./input-BktS8ObH.js";import{S as J,a as Q,b as q,c as K,d as f}from"./select-ChQGh1Eh.js";import{L as v}from"./label-yJjOls6w.js";import{D as Te,a as Ee,d as Fe,b as Me,e as Pe,c as _e}from"./dialog-DzDZ6qM5.js";import{S as R}from"./switch-KbbSyYSO.js";import{A as Ie,a as ze,b as Be,c as Ve,d as He,e as Ue,f as Le,g as Re}from"./alert-dialog-BYAAv6KF.js";import{B as Oe}from"./badge-DRtbR8hh.js";import{f as O}from"./format-SmSpYad1.js";const Ge=({searchQuery:t,setSearchQuery:r,statusFilter:a,handleStatusFilterChange:d,handleSearch:m,selectedSubscribers:n,handleBulkAction:i,total:l})=>e.jsx("div",{className:"px-6 pb-6 border-b",children:e.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-center",children:[e.jsxs("form",{onSubmit:m,className:"flex flex-grow gap-2 items-center max-w-md",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx(le,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(_,{placeholder:"Search subscribers...",className:"pl-8 h-9",value:t,onChange:x=>r(x.target.value)})]}),e.jsx(h,{type:"submit",size:"sm",variant:"default",className:"h-9",children:"Search"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(J,{value:a,onValueChange:d,children:[e.jsx(Q,{className:"w-[160px] h-9",children:e.jsx(q,{placeholder:"Status"})}),e.jsxs(K,{children:[e.jsx(f,{value:"all",children:"All Statuses"}),e.jsx(f,{value:"active",children:"Active"}),e.jsx(f,{value:"inactive",children:"Inactive"}),e.jsx(f,{value:"unsubscribed",children:"Unsubscribed"})]})]}),n.length>0&&e.jsxs(he,{children:[e.jsx(ue,{asChild:!0,children:e.jsxs(h,{variant:"outline",size:"sm",className:"gap-1 h-9",children:[e.jsx("span",{children:"Bulk Actions"}),e.jsx("span",{className:"ml-1 rounded-full bg-primary w-5 h-5 text-[11px] text-primary-foreground flex items-center justify-center",children:n.length})]})}),e.jsxs(pe,{align:"end",className:"w-[200px]",children:[e.jsx(F,{onClick:()=>i("activate"),children:"Set Active"}),e.jsx(F,{onClick:()=>i("deactivate"),children:"Set Inactive"}),e.jsx(je,{}),e.jsx(F,{onClick:()=>i("delete"),className:"text-destructive",children:"Delete Selected"})]})]})]})]})}),Je=({isOpen:t,onOpenChange:r,subscriber:a,onSuccess:d})=>{var C,b;const m=I(),n=!!a,{data:i,setData:l,post:x,patch:k,processing:j,errors:o,reset:w}=G({email:"",name:"",status:"active",preferences:{marketing:!0,newsletter:!0,productUpdates:!1}});g.useEffect(()=>{t&&a?l({email:a.email,name:a.name||"",status:a.status,preferences:a.preferences||{marketing:!1,newsletter:!1,productUpdates:!1}}):t&&w()},[t,a]);const A=c=>{c.preventDefault();const N=()=>{r(!1),d&&d()};n&&a?k(m("novus.subscribers.update",a.id),{onSuccess:N}):x(m("novus.subscribers.store"),{onSuccess:N})},S=(c,N)=>{l("preferences",{...i.preferences,[c]:N})};return e.jsx(Te,{open:t,onOpenChange:r,children:e.jsxs(Ee,{className:"sm:max-w-md",children:[e.jsxs(Fe,{children:[e.jsx(Me,{children:n?"Edit Subscriber":"Add New Subscriber"}),e.jsx(Pe,{children:n?"Update subscriber details and preferences":"Add a new subscriber to your mailing list"})]}),e.jsxs("form",{onSubmit:A,children:[e.jsxs("div",{className:"grid gap-4 py-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{htmlFor:"email",children:["Email"," ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(P,{className:"absolute left-3 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(_,{id:"email",type:"email",placeholder:"subscriber@example.com",value:i.email,onChange:c=>l("email",c.target.value),className:M("pl-9",o.email&&"border-destructive")})]}),o.email&&e.jsx("p",{className:"text-xs text-destructive",children:o.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"name",children:"Name"}),e.jsx(_,{id:"name",placeholder:"John Doe",value:i.name,onChange:c=>l("name",c.target.value),className:M(o.name&&"border-destructive")}),o.name&&e.jsx("p",{className:"text-xs text-destructive",children:o.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"status",children:"Status"}),e.jsxs(J,{value:i.status,onValueChange:c=>l("status",c),children:[e.jsx(Q,{id:"status",className:M(o.status&&"border-destructive"),children:e.jsx(q,{placeholder:"Select status"})}),e.jsxs(K,{children:[e.jsx(f,{value:"active",children:"Active"}),e.jsx(f,{value:"inactive",children:"Inactive"}),e.jsx(f,{value:"unsubscribed",children:"Unsubscribed"})]})]}),o.status&&e.jsx("p",{className:"text-xs text-destructive",children:o.status})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Email Preferences"}),e.jsxs("div",{className:"rounded-md border divide-y",children:[e.jsxs("div",{className:"flex justify-between items-center px-3 py-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex justify-center items-center w-7 h-7 rounded-full bg-primary/10",children:e.jsx(re,{className:"h-3.5 w-3.5 text-primary"})}),e.jsx(v,{htmlFor:"marketing",className:"text-sm font-normal cursor-pointer",children:"Marketing emails"})]}),e.jsx(R,{id:"marketing",checked:((C=i.preferences)==null?void 0:C.marketing)||!1,onCheckedChange:c=>S("marketing",c)})]}),e.jsxs("div",{className:"flex justify-between items-center px-3 py-2",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex justify-center items-center w-7 h-7 rounded-full bg-primary/10",children:e.jsx(P,{className:"h-3.5 w-3.5 text-primary"})}),e.jsx(v,{htmlFor:"newsletter",className:"text-sm font-normal cursor-pointer",children:"Newsletter"})]}),e.jsx(R,{id:"newsletter",checked:((b=i.preferences)==null?void 0:b.newsletter)||!1,onCheckedChange:c=>S("newsletter",c)})]})]})]})]}),e.jsxs(_e,{className:"mt-4",children:[e.jsx(h,{type:"button",variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(h,{type:"submit",disabled:j,children:j?n?"Saving...":"Adding...":n?"Save Changes":"Add Subscriber"})]})]})]})})},Qe=({isOpen:t,onOpenChange:r,subscriber:a,onSuccess:d})=>{const m=I(),{delete:n,processing:i}=G(),l=()=>{a&&n(m("novus.subscribers.destroy",a.id),{onSuccess:()=>{r(!1),d&&d()}})};return e.jsx(Ie,{open:t,onOpenChange:r,children:e.jsxs(ze,{children:[e.jsxs(Be,{children:[e.jsx(Ve,{children:"Delete Subscriber"}),e.jsxs(He,{children:["Are you sure you want to delete the subscriber"," ",e.jsx("span",{className:"font-medium",children:a==null?void 0:a.email}),"? This action cannot be undone."]})]}),e.jsxs(Ue,{children:[e.jsx(Le,{children:"Cancel"}),e.jsx(Re,{onClick:l,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",disabled:i,children:i?"Deleting...":"Delete"})]})]})})},qe=({status:t})=>{const r=()=>{switch(t){case"active":return"default";case"inactive":return"secondary";case"unsubscribed":return"destructive";default:return"default"}};return e.jsx(Oe,{variant:r(),className:"capitalize",children:t})},ms=({subscribers:t,filters:r,flash:a})=>{var z,B;const d=I(),{toast:m}=ge(),[n,i]=g.useState(r.search||""),[l,x]=g.useState([]),[k,j]=g.useState(!1),[o,w]=g.useState(!1),[A,S]=g.useState(null),[C,b]=g.useState(null);ne.useEffect(()=>{a!=null&&a.success&&m({title:"Success",description:a.success,variant:"default"}),a!=null&&a.error&&m({title:"Error",description:a.error,variant:"destructive"})},[a]);const c=s=>{s.preventDefault(),T({search:n})},N=s=>{T({status:s})},T=s=>{D.get(d("novus.subscribers.index"),{...r,...s},{preserveState:!0})},W=()=>{l.length===t.data.length?x([]):x(t.data.map(s=>s.id))},X=s=>{l.includes(s)?x(l.filter(E=>E!==s)):x([...l,s])},$=s=>{l.length!==0&&D.post(d("novus.subscribers.bulk.action"),{action:s,subscriber_ids:l},{onSuccess:()=>{x([]),D.reload({only:["subscribers"]})},preserveScroll:!0})},Y=s=>{D.get(d("novus.subscribers.index",{page:s}),{search:n||void 0,status:r.status!=="all"?r.status:void 0},{preserveState:!0})},Z=s=>{S(s),j(!0)},ee=s=>{b(s),w(!0)},se=s=>s.email_verified_at?e.jsxs("div",{className:"flex items-center text-green-600",children:[e.jsx(me,{className:"mr-1 w-4 h-4"}),e.jsx("span",{className:"text-xs",children:O(new Date(s.email_verified_at),"MMM d, yyyy")})]}):e.jsxs("div",{className:"flex items-center text-amber-600",children:[e.jsx(xe,{className:"mr-1 w-4 h-4"}),e.jsx("span",{className:"text-xs",children:"Not verified"})]}),ae=s=>{if(!s.preferences)return e.jsx("span",{className:"text-sm text-muted-foreground",children:"None"});const E=s.preferences,V=Object.entries(E).filter(([y,te])=>te).map(([y])=>y);return V.length===0?e.jsx("span",{className:"text-sm text-muted-foreground",children:"None"}):e.jsx("div",{className:"flex flex-wrap gap-1",children:V.map(y=>e.jsx("span",{className:"px-1.5 py-0.5 bg-secondary text-secondary-foreground text-xs rounded-md capitalize",children:y},y))})};return e.jsxs(e.Fragment,{children:[e.jsx(ie,{title:"Subscribers"}),e.jsx(fe,{children:e.jsxs("div",{className:"container py-20 max-w-7xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Subscribers"}),e.jsx("p",{className:"mt-1 text-muted-foreground",children:"Manage your email subscribers and their preferences"})]}),e.jsxs(h,{onClick:()=>j(!0),children:[e.jsx(H,{className:"mr-2 w-4 h-4"}),"New Subscriber"]})]}),e.jsxs(Ne,{className:"rounded-md shadow-xs",children:[e.jsxs(ve,{className:"pb-3",children:[e.jsx(Se,{children:"All Subscribers"}),e.jsxs(be,{children:[((z=t.meta)==null?void 0:z.total)||0," total subscribers"]})]}),e.jsx(Ge,{searchQuery:n,setSearchQuery:i,statusFilter:r.status,handleStatusFilterChange:N,handleSearch:c,selectedSubscribers:l,handleBulkAction:$,total:((B=t.meta)==null?void 0:B.total)||0}),e.jsx(ye,{className:"p-0",children:t.data.length>0?e.jsxs("div",{children:[e.jsxs(we,{children:[e.jsx(Ce,{children:e.jsxs(U,{className:"hover:bg-muted/50",children:[e.jsx(u,{className:"px-4 w-12",children:e.jsx(L,{checked:l.length>0&&l.length===t.data.length,onCheckedChange:W,"aria-label":"Select all"})}),e.jsx(u,{className:"px-4",children:"Email"}),e.jsx(u,{className:"px-4",children:"Name"}),e.jsx(u,{className:"hidden px-4 md:table-cell",children:"Verified"}),e.jsx(u,{className:"px-4",children:"Status"}),e.jsx(u,{className:"hidden px-4 lg:table-cell",children:"Preferences"}),e.jsx(u,{className:"hidden px-4 md:table-cell",children:"Subscribed"}),e.jsx(u,{className:"px-4 text-right",children:"Actions"})]})}),e.jsx(De,{children:t.data.map(s=>e.jsxs(U,{className:"hover:bg-muted/50",children:[e.jsx(p,{className:"px-4 py-3",children:e.jsx(L,{checked:l.includes(s.id),onCheckedChange:()=>X(s.id),"aria-label":`Select ${s.email}`})}),e.jsx(p,{className:"px-4 py-3 font-medium",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"mr-2 w-4 h-4 text-muted-foreground"}),s.email]})}),e.jsx(p,{className:"px-4 py-3",children:s.name||e.jsx("span",{className:"italic text-muted-foreground",children:"Not provided"})}),e.jsx(p,{className:"hidden px-4 py-3 md:table-cell",children:se(s)}),e.jsx(p,{className:"px-4 py-3",children:e.jsx(qe,{status:s.status})}),e.jsx(p,{className:"hidden px-4 py-3 lg:table-cell",children:ae(s)}),e.jsx(p,{className:"hidden px-4 py-3 text-sm md:table-cell text-muted-foreground",children:O(new Date(s.subscribed_at),"MMM d, yyyy")}),e.jsx(p,{className:"px-4 py-3 text-right",children:e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsxs(h,{variant:"ghost",size:"icon",className:"w-8 h-8",onClick:()=>Z(s),children:[e.jsx(ce,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only",children:"Edit"})]}),e.jsxs(h,{variant:"ghost",size:"icon",className:"w-8 h-8 text-destructive",onClick:()=>ee(s),children:[e.jsx(de,{className:"w-4 h-4"}),e.jsx("span",{className:"sr-only",children:"Delete"})]})]})})]},s.id))})]}),t.meta.last_page>1&&e.jsxs("div",{className:"flex justify-between items-center px-6 py-4 border-t",children:[e.jsxs("div",{className:"mr-auto text-sm whitespace-nowrap text-muted-foreground",children:["Showing"," ",e.jsx("span",{className:"font-medium",children:t.meta.from})," ","to"," ",e.jsx("span",{className:"font-medium",children:t.meta.to})," ","of"," ",e.jsx("span",{className:"font-medium",children:t.meta.total})," ","subscribers"]}),e.jsx(Ae,{currentPage:t.meta.current_page,lastPage:t.meta.last_page,links:t.meta.links,onPageChange:Y})]})]}):e.jsx(ke,{icon:e.jsx(oe,{className:"w-10 h-10"}),title:"No subscribers found",description:n||r.status!=="all"?"No subscribers match your search criteria. Try different keywords or filters.":"Get started by adding your first subscriber to your mailing list.",action:n||r.status!=="all"?e.jsx(h,{variant:"outline",onClick:()=>{i(""),T({search:"",status:"all"})},children:"Clear Filters"}):e.jsxs(h,{onClick:()=>j(!0),children:[e.jsx(H,{className:"mr-2 w-4 h-4"}),"Add Subscriber"]}),className:"py-16"})})]})]})}),e.jsx(Je,{isOpen:k,onOpenChange:j,subscriber:A,onSuccess:()=>{S(null)}}),e.jsx(Qe,{isOpen:o,onOpenChange:w,subscriber:C,onSuccess:()=>{b(null)}})]})};export{ms as default};
